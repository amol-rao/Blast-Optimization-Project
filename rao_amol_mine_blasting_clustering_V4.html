<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>rao_amol_mine_blastingV4 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","compute_units":26.0,"number_of_ips":15,"local_disks":1,"reserved_compute_units":3.64,"memory_mb":62464,"num_cores":8,"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"Spark 2.2 RC1 (Experimental, Scala 2.11)","packageLabel":"spark-image-a6234552b950aaef67e5aaef6815883e5bd9fc537f52bf1705894e1a5364be8d","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-f6e9552fae99c2dd7d4cb60afb006f23c6a44c9a9ca6951d91b9d920f2f93e66","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-86c0873023816ae29d99f81118dc825d6380a9968a9f7a3d0a055f5c3a8964a0","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"Spark 2.2 RC1 (Experimental, Scala 2.10)","packageLabel":"spark-image-d87399ba349d7ac22c7a245147ab9da5052d9a92f9f130f3072b0a6f862c5d9f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-86c0873023816ae29d99f81118dc825d6380a9968a9f7a3d0a055f5c3a8964a0","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-f6e9552fae99c2dd7d4cb60afb006f23c6a44c9a9ca6951d91b9d920f2f93e66","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"autoTerminateClustersByDefault":false,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.44","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"perClusterAutoTerminationEnabled":false,"enableCssTransitions":true,"defaultAutoTerminationInactivityMin":180,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-86c0873023816ae29d99f81118dc825d6380a9968a9f7a3d0a055f5c3a8964a0","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"minAutoTerminationInactivityMin":10,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"16bec05fa08fe1dd3350ef898eaf4457d7c34e6a","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"maxAutoTerminationInactivityMin":10000,"enableDatabaseDropdownInTableUI":false,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"enableEBSVolumesUIByTier":false,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2109564766429405,"name":"rao_amol_mine_blastingV4","language":"python","commands":[{"version":"CommandV1","origId":2109564766429407,"guid":"f6b1ad9f-6d26-4244-88fd-652bfd89ef60","subtype":"command","commandType":"auto","position":0.0,"command":"%md # Investigating Mine Blasting Data Using Clustering Techniques\n<strong>Project Plan v1.0</strong><br/>\nDate: May 1, 2017<br/>\nVersion: V4<br/>\nAuthor: Amol Rao<br/>\nStudent Number: 994610453<br/>\nCourse: MIE1512","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754587,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"4560aa43-d011-41ef-9b29-ba45ef96c87f"},{"version":"CommandV1","origId":2109564766429408,"guid":"de295f28-a948-4837-af6c-830a72f75158","subtype":"command","commandType":"auto","position":2.0,"command":"%md ## Contents \nThe contents of this notebook are as follows:\n\n### 1. Introduction\n\n### 2. Project Plan & Task Breakdown\n\n### 3. Data Understanding\n\n### 4. Data Preparation\n\n### 5. Modeling \n\n### 6. Alternative Iterations\n\n### 7. Conclusions & Recommendations\n\n### 8. Bibliography","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754596,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"5b8d0857-99e7-48b7-be15-bd020d0bcf08"},{"version":"CommandV1","origId":2109564766429409,"guid":"3c6940af-74e8-41f6-8e18-8da0d039eafe","subtype":"command","commandType":"auto","position":3.0,"command":"%md \n## 1.0) Introduction\n\n### 1.1) Motivation of the Problem\n\nThe motivation for this investigation is to better understand the factors driving the relationship between blast outcomes and rock mass parameters for an open pit gold mine located in North Eastern Ontario. \n\nThe blasting of rock at mines serves two primary purposes: a) to enable access to the mineral deposit containing the ore and b) fragment the ore to a suitable size for digging and processing. \n\nBoth objectives require optimization of the blasting process to minimize cost and maximize speed at which fragmented rock can be moved on for processing through improved digability. The efficiency of the blasting operation depends on a few key parameters, including; rock characteristics, properties and quantities of explosives, blast geometry, blast size, priming method and initiation sequence. \n\nAs part of this analysis, <strong> the geotechnical and blasting parameters </strong> will be explored to better understand groupings within the data. It is hoped the analysis can be used to eventually optimize blasting to reduce movement and make the fragmentation process more efficient. \n\n### 1.1) Analysis Method (Selected from Bibliography)\n\nData clustering refers to the unsupervised classification of features into patterns that then form meaningful groups. Data within 1 cluster are more similar than data in another cluster. As described by Jain et. al [8] there are four main components to a clustering task: \n\n* Pattern representation - Comprised of selection of the features and extraction for the dataset. This step also involves identifying number of classes in the representation.\n\n* Definition of pattern proximity - This is the distance function defined on the pairs of patterns. For example Euclidean distance is a common measure.\n\n* Clustering or grouping - There are many types of clustering techniques.  \n\n* Data abstraction - Once clustering has been done, a person with knowledge of the domain needs to identify what is represented and ensure the clusters are simple and compact for scalability. \n\n* Assessment of output - Perform some type of validity analysis on the cluster. \n\nHudaverdi [1] uses a hierarchical clustering technique to group 88 blast data into two groups of similarity. Blast design parameters such as burden, spacing, bench height and stemming as well as geotechnical data are used to to obtain two seperate clusters of data. Following this, each cluster is fed into a regression model to predict ground vibration, as indicated by a measure of the Peak Particle Velocity (PPV). A hierarchical technique is used to cluster all blasts into one of two groups. After standardization of the data, the Pearson coefficient of similarity is used to group data. \n\n### 1.3) Application to This Dataset\nDue to the constraint of using the MlLib toolkit - the clustering algorithm that will be explored in this analysis is the K-Means method. K-means is one of the most commonly used clustering algorithms that clusters the data points into a predefined number of clusters. The number of clusters is optimized by reducing the error on the within set sum of squared error. \n\nThe items to be clustered are <strong> individual blasts </strong> based on the features to be described later on this notebook. The blast data  was recorded with instrumentation and manually and provided by Professor Kamran Esmaeili for this investigation.  \n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754649,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"4228a223-4049-4886-8626-8fbe0a4ceb30"},{"version":"CommandV1","origId":2109564766429410,"guid":"2151c23d-0265-4aa7-a2f6-b4c329a39b58","subtype":"command","commandType":"auto","position":4.0,"command":"%md <a id=\"plan\"></a>\n## 2.0) Project Plan & Task Breakdown\n\n<br/>\n### 2.1) Project Plan\n\nBased on the CRISP-DM method, these are the proposed tasks for the project:\n\n* <strong>Week 1 - Data Understanding</strong>\n  * Data Review \n  * Data verification (with mining professors)\n  * Exploratory analysis\n  * Review + identify potential analytics techniques\n \n* <strong>Week 2 - Data Preparation</strong>\n  * Data Cleaning\n  * Feature extraction and selection\n  * Integrate and format data for model\n  * Finalize modeling techniques to be used\n  \n* <strong>Week 3 - Modeling</strong>\n  * Implement selected modeling technique\n  * Build model\n  * Assess model by computing error\n  \n* <strong>Week 4 - Evaluation of Alternatives</strong>\n  * Evaluate alternative approaches to clustering\n  * Review process and next steps\n  \n\n<br/>\n### 2.2) Task Breakdown\nIt is anticipated that 10 hours will be allocated each week to perform the tasks required for completion of the project.\n<br/>\n#### 2.2.1) Data Understanding (Week 1)\nThe data understanding task involves the following steps: \n\n\n* Data Review  (1 hour)\n  * Review all tables to develop understanding of data \n\n* Data verification (3 hours)\n  * Meet with Mining Professors to better understand data\n  * Eliminate data not required or redundant \n  * Clarify required analyses \n\n* Exploratory analysis\n  * Completed by J.Ponn for select tables\n\n* Project planning (3 hours)\n  * Setup notebook\n  * Identify breakdown of tasks for each iteration\n  * Allocate time estimates for tasks\n\n* Revisions (1 hour)\n  * Group discussions about project plans\n  * Revisions based on feedback and discussion decisions\n\n* Misc (2 hours)\n  * Buffer for unexpected problems, or changes based on group discussion for this iteration\n  \n#### 2.2.2) Data Preparation (Week 2)\nThe data preparation task involves the following steps: \n\n\n* Data Cleaning (3 hours)\n  * Identify tables that need to be cleaned : the important tables are smry_pen_rate, smry_geotech, smry_movement, smry_bmm\n  * Normalize the text, remove duplicate or error entries\n* Feature extraction and pattern representation (3 hours)\n  * Identify features to be used for input to the model.\n  * Pattern representation consists of defining the number of classes and features to be used in the clustering algorithm.\n\n* Finalize modeling techniques to be used (2 hours)\n  * Model to be considered is the <strong> K-Means</strong>.  \n  * The spark.mllib implementation includes a parallelized variant of the k-means++ method called kmeans||.   \n* Misc. (2 hour)\n  * Group discussion, professor feedback, corrections to notebook \n\n#### 2.2.3) Modeling (Week 3)\nThe data modeling task involves the following steps: \n\n* Integrate and format data for model (2 hours)\n  * Identify the steps needed to input the data into the model. \n  * Modify features to be used to ensure they can be passed to the model.\n* Build model (5 hours)\n  * Run the model, identify clusters\n* Assess model (2 hours)\n  * Perform validity analysis on the clusters produced\n  * Ensure that clusters are tightly bound\n  * Compute Within Set of Squared Error (WSSSE)\n     \n\n#### 2.2.3) Evaluation of Alternatives (Week 4)\nThe evaluation task involves the following steps: \n\n* Evaluate results (6 hours)\n  * Run several iterations on the k-means model, with varying K. Use 'Elbow Method' to identify optimal K.\n  * Perform other iterations of clustering algorithm.\n* Review process and next steps (4 hours)\n  * Make changes to the model as necessary. \n  * Draft conclusions and recommendations for next steps\n* Misc.\n  * Group discussion, professor feedback, corrections to notebook.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754702,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"e19bfff1-0797-4d69-bfe0-7770aec80723"},{"version":"CommandV1","origId":2109564766429411,"guid":"4b86e9d2-0c0f-4246-abb3-6b9db55031b4","subtype":"command","commandType":"auto","position":5.0,"command":"%md <a id=\"understanding\"></a>\n## 3.0) Data Understanding","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754753,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"ad80fae2-5d8b-4fa9-9cf5-442e3aa62e29"},{"version":"CommandV1","origId":2109564766429412,"guid":"dcf41d20-f2bb-4ca2-93a3-621499a54b9e","subtype":"command","commandType":"auto","position":5.25,"command":"%md \n### 3.1) Data Loading","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754805,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"799dff43-8b0d-42b4-a741-6712e8de4497"},{"version":"CommandV1","origId":2109564766429413,"guid":"f523e48f-56e9-4811-b199-af62f7f14ff9","subtype":"command","commandType":"auto","position":5.328125,"command":"%md\nUpload data into databricks, set implicits and define functions to be used to ensure data will be in the type required for processing. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758754875,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b67a0381-9987-4ab3-8a84-22f774fd84f7"},{"version":"CommandV1","origId":2109564766429414,"guid":"958bcaa5-e961-4c38-ae3f-aa96603a6c03","subtype":"command","commandType":"auto","position":5.40625,"command":"# Import necessary libraries\nimport pandas as pd # For csv I/O and data formatting\nimport re # To search through strings\nimport numpy as np","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758764281,"submitTime":1493758754927,"finishTime":1493758764355,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84db3ae2-d6b0-4ab9-b73f-ad97569cdf11"},{"version":"CommandV1","origId":2109564766429415,"guid":"05239169-bcc3-46e8-ad38-4d3ef94ca5a1","subtype":"command","commandType":"auto","position":6.5,"command":"%scala\nimport java.sql.Timestamp\nimport org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\n// val sqlContext= new org.apache.spark.sql.SQLContext(sc)\n//      import sqlContext.implicits._\n\n\n// patching the String class with new functions that have a defualt value if conversion to another type fails.\nimplicit class StringConversion(val s: String) {\ndef toTypeOrElse[T](convert: String=>T, defaultVal: T) = try {\n    convert(s)\n  } catch {\n    case _: Throwable => defaultVal\n  }\n  \n  def toIntOrElse(defaultVal: Int = 0) = toTypeOrElse[Int](_.toInt, defaultVal)\n  def toDoubleOrElse(defaultVal: Double = 0D) = toTypeOrElse[Double](_.toDouble, defaultVal)\n  def toDateOrElse(defaultVal: java.sql.Timestamp = java.sql.Timestamp.valueOf(\"1970-01-01 00:00:00\")) = toTypeOrElse[java.sql.Timestamp](java.sql.Timestamp.valueOf(_), defaultVal)\n}\n\n//Fix the date format in this dataset\ndef fixDateFormat(orig: String): String = {\n    val splited_date = orig.split(\" \")\n    val fixed_date_parts = splited_date(0).split(\"-\").map(part => if (part.size == 1) \"0\" + part else part)\n    val fixed_date = List(fixed_date_parts(0), fixed_date_parts(1), fixed_date_parts(2)).mkString(\"-\")\n    val fixed_time = splited_date(1).split(\":\").map(part => if (part.size == 1) \"0\" + part else part).mkString(\":\")\n    fixed_date + \" \" + fixed_time + \":00\"\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import java.sql.Timestamp\nimport org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\ndefined class StringConversion\nfixDateFormat: (orig: String)String\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-1-15c7999adf2b&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">7</span>\n<span class=\"ansiyellow\">    (/, val, sqlContext=, new, org.apache.spark.sql.SQLContext(sc))</span>\n<span class=\"ansigrey\">     ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1493758764361,"submitTime":1493758754973,"finishTime":1493758764642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62ca07e0-019e-4ad2-89c3-5fcd7f304f3e"},{"version":"CommandV1","origId":2109564766429605,"guid":"eeb46305-de10-47ea-af9a-3e4eb4373658","subtype":"command","commandType":"auto","position":6.8125,"command":"%scala\nval bmmRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFQnhJY0pfclBLUmM\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n\nval geotechRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFTjN5WmQ3MmsyTEE\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n\nval load_timeRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFdS0yU29YdkhiWjQ\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n\nval movementRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFMUhEMjJoNk1JZTg\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n\nval truckRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFSkRhc2ZrZDM2aUk\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n\nval pen_rate_summRDD = sc.parallelize( IOUtils.toString( new URL(\"https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFS3J3WFJPV21ucW8\"), Charset.forName(\"utf8\")).split(\"\\n\"))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">bmmRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[64] at parallelize at &lt;console&gt;:45\ngeotechRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[65] at parallelize at &lt;console&gt;:47\nload_timeRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[66] at parallelize at &lt;console&gt;:49\nmovementRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[67] at parallelize at &lt;console&gt;:51\ntruckRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[68] at parallelize at &lt;console&gt;:53\npen_rate_summRDD: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[69] at parallelize at &lt;console&gt;:55\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.io.FileNotFoundException: https://drive.google.com/uc?export=download&id=0BzQSUz4yGQIFMVI2N2xsQU9vN0E","error":"<div class=\"ansiout\">\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1872)\n\tat sun.net.www.protocol.http.HttpURLConnection.access$200(HttpURLConnection.java:91)\n\tat sun.net.www.protocol.http.HttpURLConnection$9.run(HttpURLConnection.java:1466)\n\tat sun.net.www.protocol.http.HttpURLConnection$9.run(HttpURLConnection.java:1464)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.security.AccessController.doPrivilegedWithCombiner(AccessController.java:782)\n\tat sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1463)\n\tat sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)\n\tat java.net.URL.openStream(URL.java:1045)\n\tat org.apache.commons.io.IOUtils.toString(IOUtils.java:894)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:39)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:46)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:48)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:50)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw$$iw.&lt;init&gt;(&lt;console&gt;:52)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$read$$iw.&lt;init&gt;(&lt;console&gt;:54)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$eval$.$print$lzycompute(&lt;console&gt;:7)\n\tat linec858adf7facb427f8ca9f520938bbd1341.$eval$.$print(&lt;console&gt;:6)</div>","workflows":[],"startTime":1493758765029,"submitTime":1493758755071,"finishTime":1493758769590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01482270-3cc0-43e8-89a0-e066a8d3fd2c"},{"version":"CommandV1","origId":2109564766429417,"guid":"8c889444-5dac-4f6d-a226-ce2c169d1bc7","subtype":"command","commandType":"auto","position":6.875,"command":"%scala\ncase class geotech(             \n    Level: Int,\n    Blast_Number: String,                                     \n    gd_1: String,\n    gd_2: String,\n    rqd: Double,\n    fracs: Double,\n    is_50: Double,\n    Q: Double\n  )\n\ndef getgeotechCleaned(row:Array[String]):geotech = {\n  return geotech(\n    row(0).toIntOrElse(),\n    row(1),\n    row(2),\n    row(3),\n    row(4).toDoubleOrElse(),\n    row(5).toDoubleOrElse(),\n    row(6).toDoubleOrElse(),\n    row(7).toDoubleOrElse()\n  )\n}\n\nval geotech_data = geotechRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = geotech_data.filter(s => s(0) != \"Level\").map(s => getgeotechCleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_geotech\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class geotech\ngetgeotechCleaned: (row: Array[String])geotech\ngeotech_data: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[70] at map at &lt;console&gt;:76\ndata: org.apache.spark.sql.DataFrame = [Level: int, Blast_Number: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:57: error: not found: value geotechRDD\n              val geotech_data = geotechRDD.map(r =&gt; getgeotechCleaned(r)).toDF()\n                                 ^\n&lt;console&gt;:46: error: value toIntOrElse is not a member of String\n                  row(0).toIntOrElse(),\n                         ^\n</div>","error":null,"workflows":[],"startTime":1493758769593,"submitTime":1493758755117,"finishTime":1493758770047,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"52ec7288-2028-4c19-804e-5ceb24da68df"},{"version":"CommandV1","origId":2109564766429418,"guid":"3f6d4264-a23c-433a-8872-1281dae43a64","subtype":"command","commandType":"auto","position":6.921875,"command":"%sql -- View the Geotech Summary Table\nSELECT *\nFROM smry_geotech\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[[148,"1","E","",98.66666667,4.0,9.833333333,14.66666667],[148,"2","F","",97.33333333,4.333333333,8.666666667,15.66666667],[148,"3","E","",98.66666667,4.0,9.833333333,14.66666667],[148,"5","F","",97.33333333,4.333333333,8.666666667,15.66666667],[148,"6","H","",99.0,2.666666667,12.5,17.66666667],[148,"7","F","E",98.0,4.166666667,9.25,15.16666667],[148,"10","F","",97.33333333,4.333333333,8.666666667,15.66666667],[148,"11","F","",97.33333333,4.333333333,8.666666667,15.66666667],[148,"12","F","",97.33333333,4.333333333,8.666666667,15.66666667],[148,"13","","",0.0,0.0,0.0,0.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Level","type":"\"integer\"","metadata":"{}"},{"name":"Blast_Number","type":"\"string\"","metadata":"{}"},{"name":"gd_1","type":"\"string\"","metadata":"{}"},{"name":"gd_2","type":"\"string\"","metadata":"{}"},{"name":"rqd","type":"\"double\"","metadata":"{}"},{"name":"fracs","type":"\"double\"","metadata":"{}"},{"name":"is_50","type":"\"double\"","metadata":"{}"},{"name":"Q","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758770052,"submitTime":1493758755164,"finishTime":1493758770245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d29f4a08-82e2-4faf-a0e9-c1d490111497"},{"version":"CommandV1","origId":2109564766429419,"guid":"22ad5554-d454-4bff-8a42-cb10f9584341","subtype":"command","commandType":"auto","position":6.9921875,"command":"%scala\ncase class load_time(               \n    BLAST_LOC: String,\n    LVL: Int,\n    BLAST_NO: Int,\n    HS_AVG: Double,\n    HS_QT_90: Double,\n    HS_QT_10: Double,\n    HS_MED: Double,\n    HS_NUM_TRUCKS: Double,\n    RS_AVG: Double,\n    RS_QT_90: Double,\n    RS_QT_10: Double,\n    RS_MED: Double,\n    RS_NUM_TRUCKS: Double\n  )\n  \ndef getload_timeCleaned(row:Array[String]):load_time = {\nreturn load_time(\n    row(0),\n    row(1).toIntOrElse(),\n    row(2).toIntOrElse(),\n    row(3).toDoubleOrElse(),\n    row(4).toDoubleOrElse(),\n    row(5).toDoubleOrElse(),\n    row(6).toDoubleOrElse(),\n    row(7).toDoubleOrElse(),\n    row(8).toDoubleOrElse(),\n    row(9).toDoubleOrElse(),\n    row(10).toDoubleOrElse(),\n    row(11).toDoubleOrElse(),\n    row(12).toDoubleOrElse()\n  )\n}\n\n\nval loading_time = load_timeRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = loading_time.filter(s => s(0) != \"BLAST_LOC\").map(s => getload_timeCleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_loading_time\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class load_time\ngetload_timeCleaned: (row: Array[String])load_time\nloading_time: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[76] at map at &lt;console&gt;:87\ndata: org.apache.spark.sql.DataFrame = [BLAST_LOC: string, LVL: int ... 11 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1493758770250,"submitTime":1493758755209,"finishTime":1493758770720,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa738458-6576-4ad9-9ecf-0cc879552949"},{"version":"CommandV1","origId":2109564766429420,"guid":"423522cc-964a-4a9b-9880-988a0d229bda","subtype":"command","commandType":"auto","position":6.994140625,"command":"%sql -- View the Loading Time Summary Table\nSELECT *\nFROM smry_loading_time\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-1",148,1,4.542111958,6.099999991,3.716666666,4.550000005,131.0,2.098749999,4.116666665,1.330000007,1.833333332,80.0],["148-2",148,2,5.730089605,7.76666667,4.183333326,5.349999993,930.0,2.163288288,2.908333338,1.655000004,2.050000003,74.0],["148-3",148,3,4.720035121,6.100000001,3.633333334,4.516666664,6264.0,3.124111432,5.116666668,1.666666669,2.849999996,347.0],["148-5",148,5,4.488414637,5.016666666,4.183333337,4.683333338,82.0,2.419391635,3.216666664,1.666666669,2.349999994,1052.0],["148-6",148,6,4.810908488,6.333333337,3.633333334,4.666666668,4524.0,2.353057199,3.669999999,1.016666663,2.266666662,169.0],["148-7",148,7,5.076554726,6.116666661,3.933333331,5.266666672,268.0,2.325377851,3.01666667,1.666666669,2.316666663,1213.0],["148-10",148,10,4.628379447,6.48333333,3.416666659,4.400000002,3795.0,2.681944446,3.300000007,2.18333333,2.666666672,24.0],["148-11",148,11,4.575604777,5.949999997,3.516666661,4.416666672,6614.0,2.336764706,3.138333333,1.666666669,2.333333323,3468.0],["148-14",148,14,4.136959596,4.833333342,3.500000001,4.133333336,1650.0,2.374920635,3.333333337,1.666666669,2.16666667,420.0],["148-16",148,16,4.657163834,6.200000003,3.583333333,4.499999994,3178.0,2.261270984,3.016666661,1.833333332,2.283333333,139.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"LVL","type":"\"integer\"","metadata":"{}"},{"name":"BLAST_NO","type":"\"integer\"","metadata":"{}"},{"name":"HS_AVG","type":"\"double\"","metadata":"{}"},{"name":"HS_QT_90","type":"\"double\"","metadata":"{}"},{"name":"HS_QT_10","type":"\"double\"","metadata":"{}"},{"name":"HS_MED","type":"\"double\"","metadata":"{}"},{"name":"HS_NUM_TRUCKS","type":"\"double\"","metadata":"{}"},{"name":"RS_AVG","type":"\"double\"","metadata":"{}"},{"name":"RS_QT_90","type":"\"double\"","metadata":"{}"},{"name":"RS_QT_10","type":"\"double\"","metadata":"{}"},{"name":"RS_MED","type":"\"double\"","metadata":"{}"},{"name":"RS_NUM_TRUCKS","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758770725,"submitTime":1493758755255,"finishTime":1493758770879,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ada75910-4df4-43ba-8488-c976a7c8ff86"},{"version":"CommandV1","origId":2109564766429421,"guid":"89ae9757-1589-4d59-bb8e-48412ae420fa","subtype":"command","commandType":"auto","position":6.99609375,"command":"%scala\ncase class movement(                 \n   BLAST_LOC: String,\n   LOC: String,\n   BENCH_HT: Int,\n   HOLE_DIAM:Int,\n   BURDEN: Int,\n   SPACING: Int,\n   HOLE_CONFIG: String,\n   CONFINEMENT: String,\n   PATTERN: String,\n   STEMMING: Double,\n   POWDER_FAC: Double,\n   IR_TIME: Int,\n   IH_TIME: Int,\n   INITIATION_TYPE: String,\n   EXPLOSIVE_TYPE: String,\n   ROCK_TYPE: String,\n   BMM: Int,\n   COLLAR_NORTH: Double,\n   COLLAR_EAST: Double,\n   COLLAR_RL: Double,\n   PRE_BMM_RL: Double,\n   INST_DEPTH: Double,\n   AFTER_EAST: Double,\n   AFTER_NORTH: Double,\n   SURFACE_RL: Double,\n   POST_BMM_RL: Double,\n   THREED_DIST: Double,\n   H_DIST: Double,\n   V_DIST: Double,\n   DIRECTION: Double,\n   INCLINATION: Double,\n   HEAVE: Double\n  )\n  \ndef getmovementCleaned(row:Array[String]):movement = {\nreturn movement(\n    row(0),\n    row(1),\n    row(2).toIntOrElse(),\n    row(3).toIntOrElse(),\n    row(4).toIntOrElse(),\n    row(5).toIntOrElse(),\n    row(6),\n    row(7),\n    row(8),\n    row(9).toDoubleOrElse(),\n    row(10).toDoubleOrElse(),\n    row(11).toIntOrElse(),\n    row(12).toIntOrElse(),\n    row(13),\n    row(14),\n    row(15),\n    row(16).toIntOrElse(),\n    row(17).toDoubleOrElse(),\n    row(18).toDoubleOrElse(),\n    row(19).toDoubleOrElse(),\n    row(20).toDoubleOrElse(),\n    row(21).toDoubleOrElse(),\n    row(22).toDoubleOrElse(),\n    row(23).toDoubleOrElse(),\n    row(24).toDoubleOrElse(),\n    row(25).toDoubleOrElse(),\n    row(26).toDoubleOrElse(),\n    row(27).toDoubleOrElse(),\n    row(28).toDoubleOrElse(),\n    row(29).toDoubleOrElse(),\n    row(30).toDoubleOrElse(),\n    row(31).toDoubleOrElse()\n  )\n}\n\nval smry_movement = movementRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = smry_movement.filter(s => s(0) != \"BLAST_LOC\").map(s => getmovementCleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_movement\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class movement\ngetmovementCleaned: (row: Array[String])movement\nsmry_movement: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[82] at map at &lt;console&gt;:124\ndata: org.apache.spark.sql.DataFrame = [BLAST_LOC: string, LOC: string ... 30 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:111: error: not found: value movementRDD\n       val smry_movement = movementRDD.map(line =&gt; line.split(&quot;,&quot;).map(elem =&gt; elem.trim))\n                           ^\n</div>","error":null,"workflows":[],"startTime":1493758770885,"submitTime":1493758755301,"finishTime":1493758771510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0bd6e5df-43cc-417c-9d77-d4badd6bd48d"},{"version":"CommandV1","origId":2109564766429422,"guid":"9c9f92b3-31bd-48cb-ad41-c6faea25b092","subtype":"command","commandType":"auto","position":6.99658203125,"command":"%sql -- View the Summary Movement Table\nSELECT *\nFROM smry_movement\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-005","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",1,5540760.865,591152.33,160.733,154.263,6.47,591153.937,5540760.179,161.881,154.5605481,1.772450246,1.747296483,0.297548105,113.1167825,9.66422506,1.148],["148-005","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",2,5540765.527,591169.722,160.031,153.931,6.1,591171.086,5540761.355,164.381,155.2254637,4.576212003,4.389314297,1.294463713,161.8952826,16.43144782,4.35],["148-005","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",4,5540770.83,591196.458,160.052,153.752,6.3,591195.754,5540766.993,163.951,151.7010445,4.407335177,3.901049218,-2.050955474,190.3968034,-27.7329059,3.899],["148-005","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",5,5540784.853,591195.13,160.048,154.248,5.8,591192.799,5540781.446,164.247,150.2215818,5.766563411,4.128100047,-4.026418207,214.379139,-44.2855938,4.199],["148-006","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",1,5540947.906,590874.106,160.555,153.455,7.1,590876.368,5540947.583,166.855,155.3064974,2.94092089,2.284944857,1.851497417,98.12655618,39.01794996,6.3],["148-006","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",2,5540971.119,590874.512,160.611,153.411,7.2,590877.436,5540969.047,164.263,154.5892073,3.772417331,3.583707577,1.178207334,125.3220855,18.1991954,3.652],["148-006","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",3,5540975.96,590838.756,160.027,154.227,5.8,590842.006,5540972.447,163.382,156.9187574,5.490831158,4.785777784,2.691757382,137.227,29.35554697,3.355],["148-006","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",5,5540927.566,590826.855,160.074,154.874,5.2,590828.453,5540930.262,161.42,154.7981625,3.134927644,3.134010211,-0.075837539,30.65649306,-1.386186646,1.346],["148-007","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",1,5540840.869,591201.885,160.245,154.575,5.67,591200.837,5540838.346,163.359,156.024133,3.092542554,2.732001647,1.449132999,202.5569487,27.94277744,3.114],["148-007","RL 148",12,216,6,7,"Staggered","Choked","Production",4.5,0.22,42,100,"V","Fortis Extra-1.05","Mafic flows",2,5540828.901,591191.694,159.971,154.081,5.89,591190.808,5540827.05,165.764,148.6936392,5.764967814,2.052120123,-5.387360847,205.5785823,-69.14747208,5.793]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"LOC","type":"\"string\"","metadata":"{}"},{"name":"BENCH_HT","type":"\"integer\"","metadata":"{}"},{"name":"HOLE_DIAM","type":"\"integer\"","metadata":"{}"},{"name":"BURDEN","type":"\"integer\"","metadata":"{}"},{"name":"SPACING","type":"\"integer\"","metadata":"{}"},{"name":"HOLE_CONFIG","type":"\"string\"","metadata":"{}"},{"name":"CONFINEMENT","type":"\"string\"","metadata":"{}"},{"name":"PATTERN","type":"\"string\"","metadata":"{}"},{"name":"STEMMING","type":"\"double\"","metadata":"{}"},{"name":"POWDER_FAC","type":"\"double\"","metadata":"{}"},{"name":"IR_TIME","type":"\"integer\"","metadata":"{}"},{"name":"IH_TIME","type":"\"integer\"","metadata":"{}"},{"name":"INITIATION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"EXPLOSIVE_TYPE","type":"\"string\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"string\"","metadata":"{}"},{"name":"BMM","type":"\"integer\"","metadata":"{}"},{"name":"COLLAR_NORTH","type":"\"double\"","metadata":"{}"},{"name":"COLLAR_EAST","type":"\"double\"","metadata":"{}"},{"name":"COLLAR_RL","type":"\"double\"","metadata":"{}"},{"name":"PRE_BMM_RL","type":"\"double\"","metadata":"{}"},{"name":"INST_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"AFTER_EAST","type":"\"double\"","metadata":"{}"},{"name":"AFTER_NORTH","type":"\"double\"","metadata":"{}"},{"name":"SURFACE_RL","type":"\"double\"","metadata":"{}"},{"name":"POST_BMM_RL","type":"\"double\"","metadata":"{}"},{"name":"THREED_DIST","type":"\"double\"","metadata":"{}"},{"name":"H_DIST","type":"\"double\"","metadata":"{}"},{"name":"V_DIST","type":"\"double\"","metadata":"{}"},{"name":"DIRECTION","type":"\"double\"","metadata":"{}"},{"name":"INCLINATION","type":"\"double\"","metadata":"{}"},{"name":"HEAVE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758771514,"submitTime":1493758755346,"finishTime":1493758771744,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa9c96f4-1679-4fe8-a142-23559400a67f"},{"version":"CommandV1","origId":2109564766429423,"guid":"3f49de46-e8f4-4682-a2c3-70af82632401","subtype":"command","commandType":"auto","position":6.9970703125,"command":"%scala\ncase class bmm(                 \n   BLAST_LOC: String,\n   GEO_DOM1: String,\n   GEO_DOM2: String,\n   RQD: Double,\n   FRACS_FREQ: Double,\n   IS_50: Double,\n   Q: Double,\n   LEVEL: String,\n   PEN_RATE: Double,\n   BLAST_DATE: String,\n   ROCK_TYPE: String,\n   MATERIAL: String,\n   HG_MG: Int,\n   LG: Int,\n   NAG: Int,\n   TOTAL_TONS: Int,\n   BLAST_TYPE: String ,  \n   DH_DELAY: Int,\n   HS_DELAY: Int,\n   RS_DELAY: Int,\n   HOLE_DIA:Int, \n   BENCH_HEIGHT: Int,\n   BURDEN: Int,\n   SPACING: Int,\n   STEMMING: Double,\n   SUB_DRILL: Double ,\n   EXPLOSIVE: String,\n   BLAST_PATTERN: String,\n   TOTAL_EXPLOSIVE: Double,\n   HOLE_DEPTH: Double,\n   FIRING_DIRECTION: String,\n   POWDER_FACTOR: Double,\n   INITIATION_TYPE: String,\n   CONFINEMENT: String,\n   BMM_NUM: Int,\n   THREED_DIST: Double,\n   H_DIST: Double,\n   V_DIST: Double,\n   DIRECTION: Double,\n   INCLINATION: Double,\n   HEAVE: Double \n  ) \n   \n  \ndef getbmmcleaned(row:Array[String]):bmm = {\nreturn new bmm(\n    row(0),\n    row(1),\n    row(2),\n    row(3).toDoubleOrElse(),\n    row(4).toDoubleOrElse(),\n    row(5).toDoubleOrElse(),\n    row(6).toDoubleOrElse(),\n    row(7),\n    row(8).toDoubleOrElse(),\n    row(9),\n    row(10),\n    row(11),\n    row(12).toIntOrElse(),\n    row(13).toIntOrElse(),\n    row(14).toIntOrElse(),\n    row(15).toIntOrElse(),\n    row(16) ,\n    row(17).toIntOrElse(),\n    row(18).toIntOrElse(),\n    row(19).toIntOrElse(),\n    row(20).toIntOrElse(),\n    row(21).toIntOrElse(),\n    row(22).toIntOrElse(),\n    row(23).toIntOrElse(),\n    row(24).toDoubleOrElse(),\n    row(25).toDoubleOrElse(),\n    row(26),\n    row(27),\n    row(28).toDoubleOrElse(),\n    row(29).toDoubleOrElse(),\n    row(30),\n    row(31).toDoubleOrElse(),\n    row(32),\n    row(33),\n    row(34).toIntOrElse(),\n    row(35).toDoubleOrElse(),\n    row(36).toDoubleOrElse(),\n    row(37).toDoubleOrElse(),\n    row(38).toDoubleOrElse(),\n    row(39).toDoubleOrElse(),\n    row(40).toDoubleOrElse() \n  )\n}\n\nval smry_bmm = bmmRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = smry_bmm.filter(s => s(0) != \"BLAST_LOC\").map(s => getbmmcleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_bmm\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class bmm\ngetbmmcleaned: (row: Array[String])bmm\nsmry_bmm: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[88] at map at &lt;console&gt;:143\ndata: org.apache.spark.sql.DataFrame = [BLAST_LOC: string, GEO_DOM1: string ... 39 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:128: error: not found: value bmmRDD\n       val smry_bmm = bmmRDD.map(line =&gt; line.split(&quot;,&quot;).map(elem =&gt; elem.trim))\n                      ^\n</div>","error":null,"workflows":[],"startTime":1493758771752,"submitTime":1493758755392,"finishTime":1493758772357,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8a97982-baa2-45a1-914b-77e338ffdeb6"},{"version":"CommandV1","origId":2109564766429424,"guid":"7b8f605a-9894-4255-9e41-b9efa288c663","subtype":"command","commandType":"auto","position":6.99755859375,"command":"%sql -- View the Summary BMM Table\nSELECT *\nFROM smry_bmm\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",4,5.356508844,3.383941489,4.15224361,137.2274458,50.82110229,2.91],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",2,4.32437884,3.559450099,2.455721349,43.96416691,34.60241245,4.969],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",1,5.450931245,2.459278349,4.864627575,52.26805117,63.1814408,4.477],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","KP","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",3,3.770576537,3.582944739,1.174629483,38.55241937,18.15116816,3.609],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","PF","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",2,3.367295405,3.261074209,0.839090785,61.54097887,14.42948811,3.514],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",5,3.471212651,3.083808846,1.593562131,128.7207427,27.32771714,3.378],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","KP","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",3,10.6697479,8.512415932,6.432907214,74.42905077,37.07866057,3.502],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",9,5.262258131,5.243138373,0.448174779,30.23283923,4.885672245,3.794],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",6,3.910291883,3.832769234,0.774766165,120.5125372,11.42792727,2.084],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","KP","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",2,2.831665688,2.417720001,1.474096525,48.15194443,31.37088044,3.368]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM1","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM2","type":"\"string\"","metadata":"{}"},{"name":"RQD","type":"\"double\"","metadata":"{}"},{"name":"FRACS_FREQ","type":"\"double\"","metadata":"{}"},{"name":"IS_50","type":"\"double\"","metadata":"{}"},{"name":"Q","type":"\"double\"","metadata":"{}"},{"name":"LEVEL","type":"\"string\"","metadata":"{}"},{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"},{"name":"BLAST_DATE","type":"\"string\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"string\"","metadata":"{}"},{"name":"MATERIAL","type":"\"string\"","metadata":"{}"},{"name":"HG_MG","type":"\"integer\"","metadata":"{}"},{"name":"LG","type":"\"integer\"","metadata":"{}"},{"name":"NAG","type":"\"integer\"","metadata":"{}"},{"name":"TOTAL_TONS","type":"\"integer\"","metadata":"{}"},{"name":"BLAST_TYPE","type":"\"string\"","metadata":"{}"},{"name":"DH_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"RS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HOLE_DIA","type":"\"integer\"","metadata":"{}"},{"name":"BENCH_HEIGHT","type":"\"integer\"","metadata":"{}"},{"name":"BURDEN","type":"\"integer\"","metadata":"{}"},{"name":"SPACING","type":"\"integer\"","metadata":"{}"},{"name":"STEMMING","type":"\"double\"","metadata":"{}"},{"name":"SUB_DRILL","type":"\"double\"","metadata":"{}"},{"name":"EXPLOSIVE","type":"\"string\"","metadata":"{}"},{"name":"BLAST_PATTERN","type":"\"string\"","metadata":"{}"},{"name":"TOTAL_EXPLOSIVE","type":"\"double\"","metadata":"{}"},{"name":"HOLE_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"FIRING_DIRECTION","type":"\"string\"","metadata":"{}"},{"name":"POWDER_FACTOR","type":"\"double\"","metadata":"{}"},{"name":"INITIATION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"CONFINEMENT","type":"\"string\"","metadata":"{}"},{"name":"BMM_NUM","type":"\"integer\"","metadata":"{}"},{"name":"THREED_DIST","type":"\"double\"","metadata":"{}"},{"name":"H_DIST","type":"\"double\"","metadata":"{}"},{"name":"V_DIST","type":"\"double\"","metadata":"{}"},{"name":"DIRECTION","type":"\"double\"","metadata":"{}"},{"name":"INCLINATION","type":"\"double\"","metadata":"{}"},{"name":"HEAVE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: Table or view not found: bmm; line 2 pos 5","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: Table or view not found: bmm; line 2 pos 5\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:465)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:484)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:459)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:699)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758772361,"submitTime":1493758755437,"finishTime":1493758772657,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"574d7901-effb-4b89-bd6c-ffcea0c118c4"},{"version":"CommandV1","origId":2109564766429425,"guid":"69966e4f-804c-4dc5-8d74-a85286fac106","subtype":"command","commandType":"auto","position":6.998046875,"command":"%scala\ncase class truck(               \n    BLAST_LOC: String,\n    LVL: Int,\n    BLAST_NO: Int,\n    HS_AVG: Double,\n    HS_QT_90: Double,\n    HS_QT_10: Double,\n    HS_MED: Double,\n    HS_NUM_TRUCKS: Int,\n    RS_AVG: Double,\n    RS_QT_90: Double,\n    RS_QT_10: Double,\n    RS_MED: Double,\n    RS_NUM_TRUCKS: Int\n  )\n  \ndef gettruckCleaned(row:Array[String]):truck = {\nreturn truck(\n    row(0),\n    row(1).toIntOrElse(),\n    row(2).toIntOrElse(),\n    row(3).toDoubleOrElse(),\n    row(4).toDoubleOrElse(),\n    row(5).toDoubleOrElse(),\n    row(6).toDoubleOrElse(),\n    row(7).toIntOrElse(),\n    row(8).toDoubleOrElse(),\n    row(9).toDoubleOrElse(),\n    row(10).toDoubleOrElse(),\n    row(11).toDoubleOrElse(),\n    row(12).toIntOrElse()\n  )\n}\n\nval smry_truck_quantity = truckRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = smry_truck_quantity.filter(s => s(0) != \"BLAST_LOC\").map(s => gettruckCleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_truck_quantity\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class truck\ngettruckCleaned: (row: Array[String])truck\nsmry_truck_quantity: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[94] at map at &lt;console&gt;:86\ndata: org.apache.spark.sql.DataFrame = [BLAST_LOC: string, LVL: int ... 11 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1493758772666,"submitTime":1493758755483,"finishTime":1493758773180,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5502e087-f361-4172-8032-6e3989b20e8d"},{"version":"CommandV1","origId":2109564766429426,"guid":"10f3d084-167f-4fd5-8148-07c8af7c3f2d","subtype":"command","commandType":"auto","position":6.998291015625,"command":"%sql -- View the Summary Truck Quantity Table\nSELECT *\nFROM smry_truck_quantity\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-1",148,1,297.1251908,317.2,286.0,294.3,131,296.93875,329.2,238.5,309.9,80],["148-2",148,2,291.1365591,306.0,269.5,293.1,930,298.4689189,320.8,275.4,302.3,74],["148-3",148,3,298.4473659,320.9,274.9,302.8,6264,299.5270893,324.5,269.64,306.0,347],["148-5",148,5,295.8621951,320.8,224.96,301.1,82,303.7442015,332.9,271.5,306.0,1052],["148-6",148,6,296.3179266,320.6,269.9,302.4,4524,302.9266272,332.1,260.5,306.0,169],["148-7",148,7,305.7261194,317.4,285.4,308.0,268,307.8597692,335.0,282.98,307.3,1213],["148-10",148,10,303.8335968,328.76,280.6,306.0,3795,321.2666667,348.97,306.03,320.9,24],["148-11",148,11,299.3719232,319.7,277.4,303.9,6614,302.9398212,328.73,275.97,305.5,3468],["148-14",148,14,303.088,323.9,280.0,305.5,1650,307.8290476,329.9,285.6,308.85,420],["148-16",148,16,297.4853367,322.0,267.3,304.1,3178,307.6035971,331.9,283.5,307.6,139]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"LVL","type":"\"integer\"","metadata":"{}"},{"name":"BLAST_NO","type":"\"integer\"","metadata":"{}"},{"name":"HS_AVG","type":"\"double\"","metadata":"{}"},{"name":"HS_QT_90","type":"\"double\"","metadata":"{}"},{"name":"HS_QT_10","type":"\"double\"","metadata":"{}"},{"name":"HS_MED","type":"\"double\"","metadata":"{}"},{"name":"HS_NUM_TRUCKS","type":"\"integer\"","metadata":"{}"},{"name":"RS_AVG","type":"\"double\"","metadata":"{}"},{"name":"RS_QT_90","type":"\"double\"","metadata":"{}"},{"name":"RS_QT_10","type":"\"double\"","metadata":"{}"},{"name":"RS_MED","type":"\"double\"","metadata":"{}"},{"name":"RS_NUM_TRUCKS","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: Table or view not found: smry_truck_quantity; line 2 pos 5","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: Table or view not found: smry_truck_quantity; line 2 pos 5\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:465)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:484)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:459)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:699)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758773183,"submitTime":1493758755527,"finishTime":1493758773312,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b79a482-7c09-45ea-b553-538a6e934f06"},{"version":"CommandV1","origId":2109564766429427,"guid":"75dd8d81-a8e4-41ca-9462-52af677c1791","subtype":"command","commandType":"auto","position":6.99853515625,"command":"%scala\ncase class penetration_rate_summ(                    \n    BLAST_LOC: String,\n    LVL: String,\n    BLAST_NO: String,\n    X: String,                            \n    Y: String,                                  \n    Z: String,                                   \n    PEN_RATE: Double,\n    ROCK_TYPE: String\n  )\n  \ndef getpenetration_rate_summCleaned(row:Array[String]):penetration_rate_summ = {\nreturn penetration_rate_summ(\n    row(0),\n    row(1),\n    row(2),\n    row(3),\n    row(4),\n    row(5),\n    row(6).toDoubleOrElse(),\n    row(7)\n  )\n}\n\nval pen_rates_summ = pen_rate_summRDD.map(line => line.split(\",\").map(elem => elem.trim))\nval data = pen_rates_summ.filter(s => s(0) != \"BLAST_LOC\").map(s => getpenetration_rate_summCleaned(s)).toDF()\ndata.createOrReplaceTempView(\"smry_pen_rate\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class penetration_rate_summ\ngetpenetration_rate_summCleaned: (row: Array[String])penetration_rate_summ\npen_rates_summ: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[100] at map at &lt;console&gt;:76\ndata: org.apache.spark.sql.DataFrame = [BLAST_LOC: string, LVL: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1493758773316,"submitTime":1493758755571,"finishTime":1493758773732,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be5f00ba-446e-46ab-9426-b1c5457d746c"},{"version":"CommandV1","origId":2109564766429428,"guid":"f5084087-03d6-4072-8c2f-b3187847f0dd","subtype":"command","commandType":"auto","position":6.998779296875,"command":"%sql -- View the Summary Penetration Rate Table\nSELECT *\nFROM smry_pen_rate\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["160-010","160","10","18270","20010","6174",0.50192,"PF"],["160-010","160","10","18270","20020","6174",0.42188,"PF"],["160-010","160","10","18270","20025","6174",0.44778,"PF"],["160-010","160","10","18280","19985","6162",0.51434,"PF"],["160-010","160","10","18280","19985","6174",0.37498,"PF"],["160-010","160","10","18280","20000","6162",0.47596,"PF"],["160-010","160","10","18280","20005","6162",0.53324,"PF"],["160-010","160","10","18280","20010","6162",0.41722,"PF"],["160-010","160","10","18280","20010","6174",0.26134,"PF"],["160-010","160","10","18280","20015","6174",0.54634,"PF"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"LVL","type":"\"string\"","metadata":"{}"},{"name":"BLAST_NO","type":"\"string\"","metadata":"{}"},{"name":"X","type":"\"string\"","metadata":"{}"},{"name":"Y","type":"\"string\"","metadata":"{}"},{"name":"Z","type":"\"string\"","metadata":"{}"},{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758773736,"submitTime":1493758755614,"finishTime":1493758773891,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ff7ff2c-d6bd-41b5-97f9-f5de2260c46d"},{"version":"CommandV1","origId":2109564766429429,"guid":"68b7aa86-d9f7-4bca-9268-5e8291ace7cb","subtype":"command","commandType":"auto","position":6.9990234375,"command":"%md \n### 3.2) Data Exploration ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758755658,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"009419a4-fa9c-465a-9761-5f6caaa06c81"},{"version":"CommandV1","origId":2109564766429430,"guid":"dbc02f8d-be81-4a70-93e5-a36f379bf0d9","subtype":"command","commandType":"auto","position":6.999114990234375,"command":"%md\nAfter loading of the data, conduct data exploration to see what is in the tables.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758755708,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"613c6868-e385-49e9-921e-63fa681f92df"},{"version":"CommandV1","origId":2109564766429431,"guid":"bae06544-19ee-4396-bcbd-f93508ce4cee","subtype":"command","commandType":"auto","position":6.99920654296875,"command":"%md\n### Review of Data within the SMRY_GEOTECH Table","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758755764,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1384dda5-aac9-4205-913c-6deeeeefaa96"},{"version":"CommandV1","origId":2109564766429432,"guid":"92839fcb-85d3-435e-9c19-0209ac361d24","subtype":"command","commandType":"auto","position":6.999298095703125,"command":"%sql\n-- How many unique blast levels are there?\nSELECT COUNT(LEVEL)\nFROM smry_geotech","commandVersion":0,"state":"finished","results":{"type":"table","data":[[811]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(LEVEL)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758773895,"submitTime":1493758755834,"finishTime":1493758774713,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba440873-2d8b-4001-9f45-07e2919984a0"},{"version":"CommandV1","origId":2109564766429433,"guid":"ac0b3bc7-99c5-4960-a70c-cba1c8874c66","subtype":"command","commandType":"auto","position":6.9993896484375,"command":"%sql\n-- Counts of distinct levels in smry_geotech\nSELECT DISTINCT (LEVEL), COUNT(LEVEL) as counts\nFROM smry_geotech\nGROUP BY LEVEL \nORDER BY counts","commandVersion":0,"state":"finished","results":{"type":"table","data":[[166,1],[260,1],[178,1],[238,2],[262,3],[190,6],[264,8],[250,10],[268,24],[148,34],[160,38],[172,43],[184,54],[196,77],[256,85],[232,95],[220,99],[208,103],[244,127]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"LEVEL","type":"\"integer\"","metadata":"{}"},{"name":"counts","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: ParseException: \nextraneous input ''count'' expecting {<EOF>, ',', 'FROM', 'WHERE', 'GROUP', 'ORDER', 'HAVING', 'LIMIT', 'LATERAL', 'WINDOW', 'UNION', 'EXCEPT', 'INTERSECT', 'SORT', 'CLUSTER', 'DISTRIBUTE'}(line 1, pos 41)\n\n== SQL ==\nSELECT DISTINCT (LEVEL), COUNT(LEVEL) as 'count'\n-----------------------------------------^^^\nFROM smry_geotech\nGROUP BY LEVEL \nORDER BY 'count'\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nextraneous input ''count'' expecting {<EOF>, ',', 'FROM', 'WHERE', 'GROUP', 'ORDER', 'HAVING', 'LIMIT', 'LATERAL', 'WINDOW', 'UNION', 'EXCEPT', 'INTERSECT', 'SORT', 'CLUSTER', 'DISTRIBUTE'}(line 1, pos 41)\n\n== SQL ==\nSELECT DISTINCT (LEVEL), COUNT(LEVEL) as 'count'\n-----------------------------------------^^^\nFROM smry_geotech\nGROUP BY LEVEL \nORDER BY 'count'\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:583)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:682)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758774720,"submitTime":1493758755881,"finishTime":1493758776184,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"277","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Counts of Distinct Levels in smry_geotech","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"950e39f9-e6eb-4dd5-ab5a-86da8978b70b"},{"version":"CommandV1","origId":2109564766429434,"guid":"152b061d-c702-46fb-89ee-1b5596d988e3","subtype":"command","commandType":"auto","position":6.999481201171875,"command":"%md\nThe levels range from 148 to 208, and include a new row for each new blasting record. So for example, Level 244 has over 120 blast rows associated with it. See the summary table below. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758755931,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3a63bc6b-98fd-43b5-be6b-6cdc343ded6c"},{"version":"CommandV1","origId":2109564766429435,"guid":"cc9daf55-468d-4891-a114-14d8d9147635","subtype":"command","commandType":"auto","position":6.9995269775390625,"command":"%sql\n-- Distinct number of blast numbers in the smry_geotech table\nSELECT DISTINCT blast_number \nFROM smry_geotech\nGROUP BY blast_number\nORDER BY blast_number DESC","commandVersion":0,"state":"finished","results":{"type":"table","data":[["99"],["98"],["97"],["96"],["95"],["94"],["93"],["92"],["91"],["90"],["9"],["89"],["88"],["87"],["86"],["85"],["84"],["83"],["82"],["81"],["80"],["8"],["79"],["78"],["77"],["76"],["75"],["74"],["73"],["72"],["71"],["70"],["7"],["69"],["68"],["67"],["66"],["65"],["64"],["63"],["62"],["61"],["60"],["6"],["59"],["58"],["57"],["56"],["55"],["54"],["53"],["52"],["51"],["50"],["5"],["49"],["48"],["47"],["46"],["45"],["44"],["43"],["42"],["41"],["40"],["4"],["39"],["38"],["37"],["36"],["35"],["34"],["33"],["32"],["31"],["30"],["3"],["29"],["28"],["27"],["26"],["259"],["258"],["257"],["256"],["255"],["254"],["253"],["252"],["251"],["250"],["25"],["249"],["248"],["247"],["246"],["245"],["244"],["243"],["242"],["241"],["240"],["24"],["239"],["238"],["237"],["236"],["235"],["234"],["233"],["232"],["231"],["23"],["229"],["227"],["225"],["224"],["223"],["222"],["221"],["220"],["22"],["219"],["218"],["217"],["216"],["215"],["214"],["212"],["211"],["210"],["21"],["208"],["205"],["203"],["202"],["20"],["2"],["199"],["195"],["194"],["193"],["192"],["191"],["190"],["19"],["189"],["188"],["185"],["184"],["183"],["182"],["181"],["18"],["178"],["175"],["174"],["173"],["171"],["170"],["17"],["169"],["168"],["164"],["161a"],["161"],["160"],["16"],["159"],["158"],["157"],["154"],["153"],["152"],["151"],["150"],["15"],["149"],["148"],["147"],["146"],["145"],["144"],["143"],["142"],["141"],["140"],["14"],["139"],["138"],["137"],["136"],["135"],["134"],["133"],["132"],["131"],["130"],["13"],["129"],["128"],["127"],["126"],["125"],["124"],["123"],["122"],["121"],["120"],["12"],["119"],["118"],["117"],["116"],["115"],["114"],["113"],["112"],["111"],["110"],["11"],["109"],["108"],["107"],["106"],["105"],["104"],["103"],["102"],["101"],["100"],["10"],["1"],["027A"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"blast_number","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758776190,"submitTime":1493758755991,"finishTime":1493758777380,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"294","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06e6049b-8948-40d7-bfa8-56d3eadfce82"},{"version":"CommandV1","origId":2109564766429436,"guid":"c7d3f5bb-d4c3-4efe-92bd-a6111353fa72","subtype":"command","commandType":"auto","position":6.99957275390625,"command":"%sql\n-- Distribution of RQD values\nSELECT rqd\nFROM smry_geotech","commandVersion":0,"state":"finished","results":{"type":"table","data":[[98.66666667],[97.33333333],[98.66666667],[97.33333333],[99.0],[98.0],[97.33333333],[97.33333333],[97.33333333],[0.0],[98.0],[99.0],[98.66666667],[99.0],[99.0],[98.16666667],[99.0],[98.0],[0.0],[99.0],[97.33333333],[99.0],[98.16666667],[99.0],[98.66666667],[99.0],[97.0],[99.0],[98.66666667],[0.0],[98.66666667],[98.66666667],[0.0],[98.66666667],[99.66666667],[99.66666667],[97.0],[96.0],[96.0],[99.66666667],[99.66666667],[99.66666667],[96.0],[99.66666667],[96.0],[96.0],[96.0],[97.83333333],[96.0],[97.66666667],[97.83333333],[96.0],[99.33333333],[97.83333333],[99.33333333],[98.16666667],[99.66666667],[96.0],[99.33333333],[99.33333333],[99.33333333],[99.33333333],[95.0],[97.16666667],[95.0],[97.5],[99.33333333],[99.33333333],[96.41666667],[95.0],[96.83333333],[93.5],[99.83333333],[98.16666667],[100.0],[96.33333333],[98.16666667],[100.0],[100.0],[96.33333333],[98.0],[96.33333333],[100.0],[96.0],[100.0],[100.0],[100.0],[96.0],[100.0],[98.16666667],[100.0],[100.0],[100.0],[100.0],[100.0],[98.0],[100.0],[100.0],[98.0],[98.0],[100.0],[100.0],[96.0],[91.5],[100.0],[87.0],[90.33333333],[96.83333333],[95.58333333],[93.66666667],[93.66666667],[87.0],[98.5],[97.5],[97.5],[98.0],[98.25],[98.33333333],[97.33333333],[99.33333333],[97.33333333],[99.33333333],[97.33333333],[97.33333333],[99.33333333],[97.33333333],[93.33333333],[98.33333333],[99.33333333],[99.33333333],[99.33333333],[98.33333333],[99.33333333],[99.33333333],[95.83333333],[95.83333333],[96.33333333],[93.33333333],[93.33333333],[96.33333333],[93.33333333],[95.83333333],[98.33333333],[98.33333333],[98.33333333],[95.83333333],[99.33333333],[98.33333333],[98.33333333],[99.33333333],[93.33333333],[98.33333333],[93.33333333],[98.33333333],[93.33333333],[98.33333333],[98.33333333],[98.33333333],[98.33333333],[95.91666667],[93.5],[93.75],[93.5],[93.75],[94.0],[96.91666667],[93.5],[93.5],[99.83333333],[94.0],[99.83333333],[97.66666667],[98.66666667],[98.66666667],[98.66666667],[98.66666667],[98.16666667],[0.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.66666667],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[94.33333333],[98.66666667],[98.66666667],[94.33333333],[94.33333333],[94.33333333],[96.5],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.33333333],[98.66666667],[98.66666667],[98.33333333],[96.5],[98.66666667],[98.33333333],[98.66666667],[94.33333333],[90.5],[94.33333333],[94.33333333],[86.66666667],[94.33333333],[94.33333333],[90.5],[92.16666667],[92.16666667],[90.0],[90.0],[90.0],[89.33333333],[93.33333333],[87.66666667],[90.0],[93.33333333],[98.0],[87.66666667],[98.0],[98.0],[98.0],[98.0],[0.0],[98.0],[98.66666667],[98.66666667],[98.66666667],[96.33333333],[96.33333333],[98.66666667],[98.66666667],[97.5],[98.66666667],[96.33333333],[96.66666667],[98.0],[95.0],[96.5],[98.66666667],[96.83333333],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[96.33333333],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[98.0],[96.33333333],[96.33333333],[95.0],[95.0],[0.0],[95.0],[95.0],[96.33333333],[97.5],[96.33333333],[95.0],[95.0],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[98.0],[98.0],[96.5],[95.0],[95.0],[98.0],[98.0],[98.0],[76.5],[76.5],[98.0],[98.0],[85.5],[58.0],[98.0],[98.0],[78.0],[58.0],[95.0],[76.0],[58.0],[0.0],[58.0],[76.0],[80.75],[80.75],[85.5],[76.0],[88.5],[91.5],[85.5],[85.5],[91.5],[91.5],[85.5],[91.5],[91.5],[88.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[95.33333333],[95.33333333],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[91.16666667],[91.16666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.66666667],[97.0],[90.83333333],[84.66666667],[84.66666667],[84.66666667],[91.16666667],[97.66666667],[97.66666667],[97.66666667],[97.0],[97.0],[97.0],[97.0],[97.0],[84.66666667],[97.0],[84.66666667],[84.66666667],[84.66666667],[97.66666667],[97.66666667],[90.08333333],[84.66666667],[90.08333333],[93.58333333],[81.16666667],[77.66666667],[81.16666667],[64.66666667],[89.5],[84.66666667],[84.66666667],[77.66666667],[64.66666667],[90.66666667],[64.66666667],[89.5],[89.5],[89.5],[89.5],[90.08333333],[89.5],[90.08333333],[89.5],[92.08333333],[90.66666667],[92.08333333],[90.66666667],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[92.66666667],[98.5],[98.5],[98.5],[78.5],[98.5],[95.58333333],[95.58333333],[92.66666667],[92.66666667],[98.5],[86.75],[98.5],[95.0],[93.83333333],[95.0],[98.5],[95.0],[98.5],[78.5],[95.0],[98.5],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[98.5],[78.5],[95.0],[95.0],[95.0],[83.0],[71.0],[78.5],[86.75],[80.0],[78.5],[93.0],[78.5],[91.0],[93.0],[91.0],[71.0],[81.0],[91.0],[81.0],[91.0],[68.0],[91.0],[95.0],[71.0],[91.0],[71.0],[68.0],[71.0],[78.5],[71.75],[78.5],[65.0],[80.0],[65.0],[71.0],[71.0],[91.0],[65.0],[68.0],[91.0],[71.0],[68.0],[91.0],[91.0],[92.66666667],[71.0],[91.0],[71.0],[94.33333333],[94.33333333],[94.33333333],[82.66666667],[94.33333333],[71.0],[82.66666667],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[0.0],[0.0],[0.0],[86.08333333],[86.08333333],[0.0],[94.66666667],[94.66666667],[48.83333333],[94.66666667],[94.66666667],[94.66666667],[94.66666667],[94.66666667],[94.66666667],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[93.66666667],[97.0],[94.33333333],[94.66666667],[94.33333333],[93.66666667],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[93.66666667],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[94.33333333],[90.91666667],[94.33333333],[94.33333333],[52.0],[87.5],[93.66666667],[94.0],[93.66666667],[87.5],[97.0],[0.0],[87.5],[87.5],[91.08333333],[94.5],[87.5],[87.5],[87.5],[94.66666667],[94.66666667],[94.66666667],[94.66666667],[87.5],[89.0],[94.5],[94.66666667],[94.66666667],[94.66666667],[94.66666667],[52.0],[90.5],[87.5],[89.0],[92.58333333],[87.5],[90.5],[87.5],[90.5],[87.5],[52.0],[87.5],[94.66666667],[72.83333333],[52.0],[87.5],[93.66666667],[87.5],[87.5],[87.5],[52.0],[93.66666667],[90.5],[87.5],[87.5],[90.5],[89.0],[90.5],[90.5],[89.0],[90.5],[90.5],[90.5],[90.5],[90.5],[94.66666667],[90.5],[94.66666667],[94.66666667],[94.5],[92.58333333],[94.66666667],[90.5],[90.5],[90.5],[94.66666667],[90.5],[90.5],[90.5],[94.66666667],[94.66666667],[0.0],[0.0],[0.0],[0.0],[0.0],[83.75],[87.0],[90.25],[83.75],[90.25],[90.25],[0.0],[0.0],[0.0],[90.25],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[96.66666667],[93.41666667],[97.5],[92.83333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[80.0],[80.0],[96.33333333],[80.0],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[96.33333333],[80.0],[85.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[0.0],[80.0],[85.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[0.0],[90.0],[90.0],[90.0],[93.16666667],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[90.0],[96.33333333],[90.0],[90.0],[0.0],[96.33333333],[90.0],[0.0],[90.0],[85.0],[85.0],[85.0],[0.0],[0.0],[90.0],[85.0],[85.0],[85.0],[90.0],[85.0],[80.0],[80.0],[80.0],[80.0],[90.8],[80.0],[80.0],[80.0],[0.0],[80.0],[80.0],[0.0],[0.0],[0.0],[80.0],[0.0],[95.0],[95.0],[0.0],[0.0],[92.0],[0.0],[0.0],[95.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"rqd","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: grouping expressions sequence is empty, and 'smry_geotech.`rqd`' is not an aggregate function. Wrap '(count(1) AS `count(1)`)' in windowing function(s) or wrap 'smry_geotech.`rqd`' in first() (or first_value) if you don't care which value you get.;;\nDistinct\n+- Aggregate [rqd#57, count(1) AS count(1)#1653L]\n   +- SubqueryAlias smry_geotech\n      +- LogicalRDD [Level#53, Blast_Number#54, gd_1#55, gd_2#56, rqd#57, fracs#58, is_50#59, Q#60]\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: grouping expressions sequence is empty, and 'smry_geotech.`rqd`' is not an aggregate function. Wrap '(count(1) AS `count(1)`)' in windowing function(s) or wrap 'smry_geotech.`rqd`' in first() (or first_value) if you don't care which value you get.;;\nDistinct\n+- Aggregate [rqd#57, count(1) AS count(1)#1653L]\n   +- SubqueryAlias smry_geotech\n      +- LogicalRDD [Level#53, Blast_Number#54, gd_1#55, gd_2#56, rqd#57, fracs#58, is_50#59, Q#60]\n\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:40)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$class$$anonfun$$checkValidAggregateExpression$1(CheckAnalysis.scala:212)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$7.apply(CheckAnalysis.scala:247)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$7.apply(CheckAnalysis.scala:247)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:247)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:126)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$foreachUp$1.apply(TreeNode.scala:125)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$foreachUp$1.apply(TreeNode.scala:125)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:125)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:49)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:64)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:583)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:682)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758777389,"submitTime":1493758756039,"finishTime":1493758777587,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"619.181818","height":"448.181818","xColumns":[],"yColumns":["rqd"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"histogram":[{"key":"bins","value":"20"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Distribution of RQD values ","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e80b58af-2145-4ea8-b5bf-80d66a1ed225"},{"version":"CommandV1","origId":2109564766429437,"guid":"188087be-ef55-4eab-9a83-6c3d81471456","subtype":"command","commandType":"auto","position":6.999664306640625,"command":"%md\nThe largest bin of RQD values is between 90-95 (there are >300) and between 95-100 (almost 450). The values around 0 appear to be errors or blanks and should be removed. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756089,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"feba83d7-d0aa-4080-b86a-9a2557a72970"},{"version":"CommandV1","origId":2109564766429438,"guid":"983b44f4-e780-46c6-b9f4-16cfd7ab4256","subtype":"command","commandType":"auto","position":6.999687194824219,"command":"%sql\n-- How many distinct rqd values does the smry_geotech have? \nSELECT distinct(rqd)\nFROM smry_geotech\nGROUP BY rqd","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0],[76.5],[95.33333333],[91.08333333],[96.66666667],[98.33333333],[93.16666667],[91.5],[90.83333333],[97.5],[85.5],[98.25],[89.5],[89.33333333],[90.5],[92.08333333],[98.0],[96.91666667],[94.66666667],[96.0],[80.0],[64.66666667],[77.66666667],[93.75],[95.58333333],[86.75],[90.8],[90.66666667],[97.16666667],[94.0],[96.5],[97.33333333],[90.25],[92.58333333],[93.66666667],[98.66666667],[97.83333333],[98.5],[85.0],[92.16666667],[93.41666667],[78.0],[83.0],[86.66666667],[92.83333333],[71.0],[92.66666667],[93.0],[94.5],[58.0],[93.83333333],[96.83333333],[80.75],[94.33333333],[87.66666667],[98.16666667],[68.0],[71.75],[99.83333333],[99.66666667],[93.58333333],[81.0],[78.5],[81.16666667],[99.33333333],[87.0],[88.5],[96.41666667],[90.33333333],[87.5],[99.0],[82.66666667],[95.0],[100.0],[95.91666667],[93.5],[96.33333333],[97.66666667],[48.83333333],[92.0],[95.83333333],[84.66666667],[52.0],[97.0],[93.33333333],[89.0],[72.83333333],[86.08333333],[90.91666667],[65.0],[83.75],[76.0],[90.0],[90.08333333],[91.16666667],[91.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"rqd","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758777598,"submitTime":1493758756145,"finishTime":1493758778562,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53c1fcb4-fa10-4727-bcf4-0286a9496338"},{"version":"CommandV1","origId":2109564766429439,"guid":"2cfa43c4-2bdc-4e04-8a55-cdb0064cb813","subtype":"command","commandType":"auto","position":6.999698638916016,"command":"%md\nSince there are only 93 distinct rqd values, it appears that these values have been summarized and applied to many more blast locations.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756188,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d0437ca-4887-4a01-af36-a20540b523d8"},{"version":"CommandV1","origId":2109564766429440,"guid":"da7bd025-97cc-49ef-b8a7-e7554f202b3e","subtype":"command","commandType":"auto","position":6.9997100830078125,"command":"%sql\n-- Distribution of fracs\nSELECT fracs\nFROM smry_geotech","commandVersion":0,"state":"finished","results":{"type":"table","data":[[4.0],[4.333333333],[4.0],[4.333333333],[2.666666667],[4.166666667],[4.333333333],[4.333333333],[4.333333333],[0.0],[4.166666667],[2.666666667],[4.0],[2.666666667],[2.666666667],[3.5],[2.666666667],[4.166666667],[0.0],[2.666666667],[4.333333333],[2.666666667],[3.5],[2.666666667],[4.0],[2.666666667],[4.0],[2.666666667],[4.0],[0.0],[4.0],[4.0],[0.0],[4.0],[1.666666667],[1.666666667],[4.333333333],[4.0],[4.0],[1.666666667],[1.666666667],[1.666666667],[4.0],[1.666666667],[4.0],[4.0],[4.0],[2.833333333],[4.0],[3.0],[2.833333333],[4.0],[2.0],[2.833333333],[2.0],[3.166666667],[1.666666667],[4.0],[2.0],[2.0],[2.0],[2.0],[3.0],[2.5],[3.0],[2.666666667],[2.0],[2.0],[2.5],[3.0],[2.833333333],[3.5],[1.666666667],[2.666666667],[1.666666667],[3.666666667],[2.666666667],[1.666666667],[1.666666667],[3.666666667],[3.0],[3.666666667],[1.666666667],[4.0],[2.0],[1.666666667],[1.666666667],[4.0],[1.666666667],[2.833333333],[2.0],[1.666666667],[2.0],[2.0],[1.666666667],[3.0],[2.0],[2.0],[3.0],[2.833333333],[2.0],[2.0],[4.0],[4.0],[2.0],[4.0],[3.833333333],[2.833333333],[3.416666667],[3.666666667],[3.666666667],[4.0],[2.0],[3.166666667],[3.166666667],[2.583333333],[2.75],[2.833333333],[3.666666667],[2.0],[3.666666667],[2.0],[3.666666667],[3.666666667],[2.0],[3.666666667],[3.333333333],[4.333333333],[2.0],[2.0],[2.0],[2.833333333],[2.0],[2.0],[3.833333333],[3.833333333],[2.666666667],[3.333333333],[3.333333333],[2.666666667],[3.333333333],[3.833333333],[4.333333333],[4.333333333],[4.333333333],[3.833333333],[2.0],[4.333333333],[4.333333333],[2.0],[3.333333333],[4.333333333],[3.333333333],[4.333333333],[3.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.166666667],[3.5],[4.0],[4.0],[3.75],[4.0],[3.416666667],[4.0],[4.0],[2.833333333],[4.0],[2.833333333],[3.333333333],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[3.0],[0.0],[3.333333333],[3.0],[3.0],[3.0],[3.166666667],[3.333333333],[3.333333333],[2.333333333],[3.0],[3.333333333],[3.0],[3.0],[3.333333333],[3.333333333],[3.333333333],[5.666666667],[2.333333333],[2.333333333],[5.666666667],[5.666666667],[5.666666667],[4.0],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[5.666666667],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.0],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[2.833333333],[2.333333333],[2.333333333],[2.833333333],[4.0],[2.333333333],[2.833333333],[2.333333333],[5.666666667],[7.166666667],[5.666666667],[5.666666667],[8.666666667],[5.666666667],[5.666666667],[7.166666667],[6.333333333],[6.333333333],[7.0],[7.0],[7.0],[6.083333333],[4.083333333],[6.916666667],[7.0],[4.083333333],[3.0],[6.916666667],[3.0],[3.0],[3.0],[3.0],[0.0],[3.0],[2.666666667],[2.666666667],[2.666666667],[4.333333333],[4.333333333],[2.666666667],[2.666666667],[3.5],[2.666666667],[4.333333333],[3.777777778],[3.0],[4.333333333],[3.666666667],[2.666666667],[3.5],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[3.0],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[0.0],[4.333333333],[4.333333333],[4.333333333],[3.5],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[3.0],[3.0],[3.666666667],[4.333333333],[4.333333333],[3.0],[3.0],[3.0],[5.833333333],[5.833333333],[3.0],[3.0],[5.666666667],[7.333333333],[3.0],[3.0],[5.166666667],[7.333333333],[4.333333333],[7.0],[7.333333333],[0.0],[7.333333333],[7.0],[6.5],[6.5],[6.0],[7.0],[5.583333333],[5.166666667],[6.0],[6.0],[5.166666667],[5.166666667],[6.0],[5.166666667],[5.166666667],[5.583333333],[5.166666667],[5.166666667],[5.166666667],[5.166666667],[5.166666667],[5.166666667],[5.166666667],[5.166666667],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[3.333333333],[3.333333333],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[4.166666667],[4.166666667],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[4.333333333],[3.833333333],[3.333333333],[3.333333333],[3.333333333],[4.166666667],[5.0],[5.0],[5.0],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[4.333333333],[3.333333333],[4.333333333],[3.333333333],[3.333333333],[3.333333333],[5.0],[5.0],[5.583333333],[3.333333333],[5.583333333],[5.833333333],[7.833333333],[7.583333333],[7.833333333],[10.66666667],[6.666666667],[3.333333333],[3.333333333],[7.583333333],[10.66666667],[4.5],[10.66666667],[6.666666667],[6.666666667],[6.666666667],[6.666666667],[5.583333333],[6.666666667],[5.583333333],[6.666666667],[4.25],[4.5],[4.25],[4.5],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.333333333],[3.666666667],[3.666666667],[3.666666667],[5.5],[3.666666667],[4.0],[4.0],[4.333333333],[4.333333333],[3.666666667],[4.75],[3.666666667],[4.0],[4.166666667],[4.0],[3.666666667],[4.0],[3.666666667],[5.5],[4.0],[3.666666667],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[4.0],[3.666666667],[5.5],[4.0],[4.0],[4.0],[5.0],[6.0],[5.5],[4.75],[7.5],[5.5],[5.25],[5.5],[6.5],[5.25],[6.5],[6.0],[6.25],[6.5],[6.25],[6.5],[8.5],[6.5],[4.0],[6.0],[6.5],[6.0],[8.5],[6.0],[5.5],[8.25],[5.5],[11.0],[7.5],[11.0],[6.0],[6.0],[6.5],[11.0],[8.5],[6.5],[6.0],[8.5],[6.5],[6.5],[5.75],[6.0],[6.5],[6.0],[5.0],[5.0],[5.0],[5.5],[5.0],[6.0],[5.5],[5.0],[5.0],[5.0],[5.0],[0.0],[0.0],[0.0],[4.916666667],[4.916666667],[0.0],[6.333333333],[6.333333333],[4.666666667],[6.333333333],[6.333333333],[6.333333333],[6.333333333],[6.333333333],[6.333333333],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[3.0],[4.333333333],[3.0],[3.333333333],[6.333333333],[3.333333333],[4.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[4.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[4.416666667],[3.333333333],[3.333333333],[10.5],[5.5],[4.333333333],[3.833333333],[4.333333333],[5.5],[3.0],[0.0],[5.5],[5.5],[6.25],[5.166666667],[5.5],[5.5],[5.5],[7.0],[7.0],[7.0],[7.0],[5.5],[7.0],[5.166666667],[7.0],[7.0],[7.0],[7.0],[10.5],[8.5],[5.5],[7.0],[7.75],[5.5],[8.5],[5.5],[8.5],[5.5],[10.5],[5.5],[7.0],[7.416666667],[10.5],[5.5],[4.333333333],[5.5],[5.5],[5.5],[10.5],[4.333333333],[8.5],[5.5],[5.5],[8.5],[7.0],[8.5],[8.5],[7.0],[8.5],[8.5],[8.5],[8.5],[8.5],[7.0],[8.5],[7.0],[7.0],[5.166666667],[7.75],[7.0],[8.5],[8.5],[8.5],[7.0],[8.5],[8.5],[8.5],[7.0],[7.0],[0.0],[0.0],[0.0],[0.0],[0.0],[6.0],[6.875],[7.75],[6.0],[7.75],[7.75],[0.0],[0.0],[0.0],[7.75],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[2.666666667],[5.666666667],[3.0],[2.666666667],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[6.5],[6.5],[3.333333333],[6.5],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[3.333333333],[6.5],[7.25],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[0.0],[6.5],[6.75],[7.5],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.5],[0.0],[7.0],[7.0],[7.5],[5.666666667],[8.0],[8.0],[7.5],[8.0],[7.0],[8.0],[8.0],[8.0],[7.5],[7.0],[8.0],[3.333333333],[8.0],[8.0],[0.0],[3.333333333],[8.0],[0.0],[7.0],[10.5],[10.5],[10.5],[0.0],[0.0],[7.0],[10.5],[10.5],[10.5],[7.0],[10.5],[13.0],[13.0],[13.0],[13.0],[4.0],[13.0],[13.0],[13.0],[0.0],[13.0],[13.0],[0.0],[0.0],[0.0],[13.0],[0.0],[4.0],[4.0],[0.0],[0.0],[6.333333333],[0.0],[0.0],[4.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"fracs","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758778567,"submitTime":1493758756240,"finishTime":1493758778738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"623.181818","height":"416.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7c73f84-e8e2-4069-bcd4-4403721c27dc"},{"version":"CommandV1","origId":2109564766429441,"guid":"ded65d7d-9c71-4323-bb1d-96433da3a66e","subtype":"command","commandType":"auto","position":6.999732971191406,"command":"%md\nThe number of fracs appear to be distributed around 5, with a range from 0 - 14. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756285,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1115b79-c393-4de4-90a9-6241b6b5c58e"},{"version":"CommandV1","origId":2109564766429442,"guid":"c15c61f1-6b4c-4f86-bbfe-7a0fc5670c9a","subtype":"command","commandType":"auto","position":6.999750137329102,"command":"%sql\n-- Distribution of is_50 values\nSELECT is_50\nFROM smry_geotech","commandVersion":0,"state":"finished","results":{"type":"table","data":[[9.833333333],[8.666666667],[9.833333333],[8.666666667],[12.5],[9.25],[8.666666667],[8.666666667],[8.666666667],[0.0],[9.25],[12.5],[9.833333333],[12.5],[12.5],[10.58333333],[12.5],[9.25],[0.0],[12.5],[8.666666667],[12.5],[10.58333333],[12.5],[9.833333333],[12.5],[13.83333333],[12.5],[9.833333333],[0.0],[9.833333333],[9.833333333],[0.0],[9.833333333],[9.0],[9.0],[12.66666667],[9.666666667],[9.666666667],[9.0],[9.0],[9.0],[9.666666667],[9.0],[9.666666667],[9.666666667],[9.666666667],[9.333333333],[9.666666667],[8.666666667],[9.333333333],[9.666666667],[7.666666667],[9.333333333],[7.666666667],[10.16666667],[9.0],[9.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[0.0],[7.666666667],[0.0],[8.777777778],[7.666666667],[7.666666667],[8.208333333],[0.0],[10.5],[6.75],[10.33333333],[12.16666667],[11.66666667],[12.66666667],[12.16666667],[11.66666667],[11.66666667],[12.66666667],[8.166666667],[12.66666667],[11.66666667],[8.0],[8.333333333],[11.66666667],[11.66666667],[8.0],[11.66666667],[10.5],[8.333333333],[11.66666667],[8.333333333],[8.333333333],[11.66666667],[8.166666667],[8.333333333],[8.333333333],[8.166666667],[9.833333333],[8.333333333],[8.333333333],[8.0],[8.083333333],[8.333333333],[8.166666667],[9.583333333],[9.666666667],[11.0],[11.0],[11.0],[8.166666667],[8.5],[11.0],[11.0],[9.75],[13.20833333],[14.25],[14.66666667],[13.83333333],[14.66666667],[13.83333333],[14.66666667],[14.66666667],[13.83333333],[14.66666667],[8.0],[11.0],[13.83333333],[13.83333333],[13.83333333],[14.25],[13.83333333],[13.83333333],[9.5],[9.5],[10.91666667],[8.0],[8.0],[10.91666667],[8.0],[9.5],[11.0],[11.0],[11.0],[9.5],[13.83333333],[11.0],[11.0],[13.83333333],[8.0],[11.0],[8.0],[11.0],[8.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.25],[9.5],[11.0],[9.625],[8.0],[9.416666667],[11.0],[11.0],[10.83333333],[8.0],[10.83333333],[12.66666667],[12.33333333],[12.33333333],[12.33333333],[12.33333333],[12.5],[0.0],[10.83333333],[10.66666667],[10.66666667],[10.66666667],[10.75],[10.83333333],[10.83333333],[11.83333333],[10.66666667],[10.83333333],[10.66666667],[10.66666667],[10.83333333],[10.83333333],[10.83333333],[7.0],[11.83333333],[11.83333333],[7.0],[7.0],[7.0],[9.416666667],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[10.83333333],[10.83333333],[10.83333333],[10.83333333],[10.83333333],[10.83333333],[10.66666667],[10.83333333],[10.83333333],[10.83333333],[10.83333333],[11.33333333],[11.83333333],[11.83333333],[11.33333333],[9.416666667],[11.83333333],[11.33333333],[11.83333333],[7.0],[6.583333333],[7.0],[7.0],[6.166666667],[7.0],[7.0],[6.583333333],[6.25],[6.25],[5.5],[5.5],[5.5],[4.5],[6.25],[4.833333333],[5.5],[6.25],[9.0],[4.833333333],[9.0],[9.0],[9.0],[9.0],[0.0],[9.0],[11.0],[11.0],[11.0],[9.0],[9.0],[11.0],[11.0],[10.0],[11.0],[9.0],[9.666666667],[13.83333333],[9.0],[11.41666667],[11.0],[10.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[13.83333333],[9.0],[9.0],[9.0],[9.0],[0.0],[9.0],[9.0],[9.0],[10.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[13.83333333],[13.83333333],[11.41666667],[9.0],[9.0],[13.83333333],[13.83333333],[13.83333333],[7.083333333],[7.083333333],[13.83333333],[13.83333333],[9.25],[5.166666667],[13.83333333],[13.83333333],[9.5],[5.166666667],[9.0],[9.5],[5.166666667],[0.0],[5.166666667],[9.5],[9.25],[9.25],[9.0],[9.5],[7.916666667],[6.833333333],[9.0],[9.0],[6.833333333],[6.833333333],[9.0],[6.833333333],[6.833333333],[7.916666667],[6.833333333],[6.833333333],[6.833333333],[6.833333333],[6.833333333],[6.833333333],[6.833333333],[6.833333333],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[12.33333333],[12.33333333],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[12.66666667],[12.66666667],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[8.666666667],[11.33333333],[14.0],[14.0],[14.0],[12.66666667],[11.33333333],[11.33333333],[11.33333333],[8.666666667],[8.666666667],[8.666666667],[8.666666667],[8.666666667],[14.0],[8.666666667],[14.0],[14.0],[14.0],[11.33333333],[11.33333333],[9.333333333],[14.0],[9.333333333],[10.0],[7.916666667],[7.25],[7.916666667],[4.5],[8.666666667],[14.0],[14.0],[7.25],[4.5],[10.0],[4.5],[8.666666667],[8.666666667],[8.666666667],[8.666666667],[9.333333333],[8.666666667],[9.333333333],[8.666666667],[7.5],[10.0],[7.5],[10.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[11.0],[11.16666667],[11.16666667],[11.16666667],[13.25],[11.16666667],[11.08333333],[11.08333333],[11.0],[11.0],[11.16666667],[10.625],[11.16666667],[8.0],[9.5],[8.0],[11.16666667],[8.0],[11.16666667],[13.25],[8.0],[11.16666667],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[11.16666667],[13.25],[8.0],[8.0],[8.0],[8.5],[9.0],[13.25],[10.625],[6.833333333],[13.25],[9.75],[13.25],[11.5],[9.75],[11.5],[9.0],[10.25],[11.5],[10.25],[11.5],[7.333333333],[11.5],[8.0],[9.0],[11.5],[9.0],[7.333333333],[9.0],[13.25],[9.458333333],[13.25],[5.666666667],[6.833333333],[5.666666667],[9.0],[9.0],[11.5],[5.666666667],[7.333333333],[11.5],[9.0],[7.333333333],[11.5],[11.5],[10.16666667],[9.0],[11.5],[9.0],[8.833333333],[8.833333333],[8.833333333],[8.916666667],[8.833333333],[9.0],[8.916666667],[8.833333333],[8.833333333],[8.833333333],[8.833333333],[0.0],[0.0],[0.0],[12.875],[12.875],[0.0],[9.666666667],[9.666666667],[8.916666667],[9.666666667],[9.666666667],[9.666666667],[9.666666667],[9.666666667],[9.666666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[8.166666667],[12.5],[8.166666667],[7.666666667],[9.666666667],[7.666666667],[12.5],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[12.5],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[7.666666667],[8.895833333],[7.666666667],[7.666666667],[4.0],[10.125],[12.5],[10.08333333],[12.5],[10.125],[8.166666667],[0.0],[10.125],[10.125],[10.64583333],[9.416666667],[10.125],[10.125],[10.125],[11.16666667],[11.16666667],[11.16666667],[11.16666667],[10.125],[9.5625],[9.416666667],[11.16666667],[11.16666667],[11.16666667],[11.16666667],[4.0],[9.0],[10.125],[9.5625],[10.08333333],[10.125],[9.0],[10.125],[9.0],[10.125],[4.0],[10.125],[11.16666667],[8.25],[4.0],[10.125],[12.5],[10.125],[10.125],[10.125],[4.0],[12.5],[9.0],[10.125],[10.125],[9.0],[9.5625],[9.0],[9.0],[9.5625],[9.0],[9.0],[9.0],[9.0],[9.0],[11.16666667],[9.0],[11.16666667],[11.16666667],[9.416666667],[10.08333333],[11.16666667],[9.0],[9.0],[9.0],[11.16666667],[9.0],[9.0],[9.0],[11.16666667],[11.16666667],[0.0],[0.0],[0.0],[0.0],[0.0],[8.5625],[8.53125],[8.5],[8.5625],[8.5],[8.5],[0.0],[0.0],[0.0],[8.5],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[7.333333333],[11.33333333],[10.0],[7.333333333],[10.08333333],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.0],[7.0],[7.5],[7.0],[7.5],[7.5],[7.5],[7.5],[7.5],[7.0],[8.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[0.0],[7.0],[7.5],[8.5],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.5],[0.0],[8.0],[8.0],[8.5],[8.25],[9.0],[9.0],[8.5],[9.0],[8.0],[9.0],[9.0],[9.0],[8.5],[8.0],[9.0],[7.5],[9.0],[9.0],[0.0],[7.5],[9.0],[0.0],[8.0],[10.0],[10.0],[10.0],[0.0],[0.0],[8.0],[10.0],[10.0],[10.0],[8.0],[10.0],[11.0],[11.0],[11.0],[11.0],[6.666666667],[11.0],[11.0],[11.0],[0.0],[11.0],[11.0],[0.0],[0.0],[0.0],[11.0],[0.0],[8.5],[8.5],[0.0],[0.0],[15.33333333],[0.0],[0.0],[8.5]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"is_50","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758778748,"submitTime":1493758756346,"finishTime":1493758778865,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"543","height":"353","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Distribution of is_50 values","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e02d70b7-4a23-42e2-aa5a-bdedd9fe7910"},{"version":"CommandV1","origId":2109564766429443,"guid":"2541b559-d159-4b14-8466-1e9d1059c24d","subtype":"command","commandType":"auto","position":6.999752998352051,"command":"%md\nDistribution of is50 values is around 9, with a range from 4 - 16. The values around 0 appear to be erroneous and should be removed.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756407,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1bf7366e-1cc2-4854-ba9b-0f0629a70a11"},{"version":"CommandV1","origId":2109564766429444,"guid":"f4445e81-4fb1-4b83-ab7d-82ae2132476a","subtype":"command","commandType":"auto","position":6.999755144119263,"command":"%sql\n-- Distribution of q values\nSELECT q\nFROM smry_geotech","commandVersion":0,"state":"finished","results":{"type":"table","data":[[14.66666667],[15.66666667],[14.66666667],[15.66666667],[17.66666667],[15.16666667],[15.66666667],[15.66666667],[15.66666667],[0.0],[15.16666667],[17.66666667],[14.66666667],[17.66666667],[17.66666667],[16.66666667],[17.66666667],[15.16666667],[0.0],[17.66666667],[15.66666667],[17.66666667],[16.66666667],[17.66666667],[14.66666667],[17.66666667],[20.33333333],[17.66666667],[14.66666667],[0.0],[14.66666667],[14.66666667],[0.0],[14.66666667],[23.0],[23.0],[14.0],[10.33333333],[10.33333333],[23.0],[23.0],[23.0],[10.33333333],[23.0],[10.33333333],[10.33333333],[10.33333333],[16.66666667],[10.33333333],[15.66666667],[16.66666667],[10.33333333],[21.0],[16.66666667],[21.0],[17.5],[23.0],[10.33333333],[21.0],[21.0],[21.0],[21.0],[16.0],[18.5],[16.0],[17.58333333],[21.0],[21.0],[18.5],[16.0],[15.16666667],[7.0],[21.66666667],[15.83333333],[20.33333333],[11.33333333],[15.83333333],[20.33333333],[20.33333333],[11.33333333],[24.25],[11.33333333],[20.33333333],[13.5],[35.0],[20.33333333],[20.33333333],[13.5],[20.33333333],[23.16666667],[35.0],[20.33333333],[35.0],[35.0],[20.33333333],[24.25],[35.0],[35.0],[24.25],[16.91666667],[35.0],[35.0],[13.5],[13.66666667],[35.0],[13.83333333],[16.16666667],[26.75],[15.16666667],[18.5],[18.5],[13.83333333],[31.0],[11.83333333],[11.83333333],[21.41666667],[17.91666667],[20.0],[20.33333333],[19.66666667],[20.33333333],[19.66666667],[20.33333333],[20.33333333],[19.66666667],[20.33333333],[17.33333333],[15.66666667],[19.66666667],[19.66666667],[19.66666667],[20.0],[19.66666667],[19.66666667],[16.5],[16.5],[18.5],[17.33333333],[17.33333333],[18.5],[17.33333333],[16.5],[15.66666667],[15.66666667],[15.66666667],[16.5],[19.66666667],[15.66666667],[15.66666667],[19.66666667],[17.33333333],[15.66666667],[17.33333333],[15.66666667],[17.33333333],[15.66666667],[15.66666667],[15.66666667],[15.66666667],[13.83333333],[11.5],[15.5],[12.0],[15.25],[19.0],[24.75],[12.0],[12.0],[30.5],[19.0],[30.5],[23.66666667],[19.0],[19.0],[19.0],[19.0],[21.33333333],[0.0],[18.33333333],[27.0],[27.0],[27.0],[22.66666667],[18.33333333],[18.33333333],[9.0],[27.0],[18.33333333],[27.0],[27.0],[18.33333333],[18.33333333],[18.33333333],[10.33333333],[9.0],[9.0],[10.33333333],[10.33333333],[10.33333333],[9.666666667],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[10.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[27.0],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[13.66666667],[9.0],[9.0],[13.66666667],[9.666666667],[9.0],[13.66666667],[9.0],[10.33333333],[11.0],[10.33333333],[10.33333333],[11.66666667],[10.33333333],[10.33333333],[11.0],[11.16666667],[11.16666667],[12.0],[12.0],[12.0],[10.58333333],[15.83333333],[10.41666667],[12.0],[15.83333333],[22.5],[10.41666667],[22.5],[22.5],[22.5],[22.5],[0.0],[22.5],[16.66666667],[16.66666667],[16.66666667],[14.66666667],[14.66666667],[16.66666667],[16.66666667],[15.66666667],[16.66666667],[14.66666667],[14.77777778],[11.66666667],[13.0],[12.33333333],[16.66666667],[14.83333333],[13.0],[13.0],[13.0],[13.0],[13.0],[13.0],[13.0],[14.66666667],[13.0],[13.0],[13.0],[13.0],[13.0],[13.0],[13.0],[13.0],[11.66666667],[14.66666667],[14.66666667],[13.0],[13.0],[0.0],[13.0],[13.0],[14.66666667],[15.66666667],[14.66666667],[13.0],[13.0],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[14.66666667],[11.66666667],[11.66666667],[12.33333333],[13.0],[13.0],[11.66666667],[11.66666667],[11.66666667],[11.0],[11.0],[11.66666667],[11.66666667],[12.5],[9.0],[11.66666667],[11.66666667],[10.33333333],[9.0],[13.0],[12.0],[9.0],[0.0],[9.0],[12.0],[12.75],[12.75],[13.5],[12.0],[14.33333333],[15.16666667],[13.5],[13.5],[15.16666667],[15.16666667],[13.5],[15.16666667],[15.16666667],[14.33333333],[15.16666667],[15.16666667],[15.16666667],[15.16666667],[15.16666667],[15.16666667],[15.16666667],[15.16666667],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[18.66666667],[18.66666667],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[14.83333333],[14.83333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[18.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[14.83333333],[18.33333333],[18.33333333],[18.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[11.33333333],[18.33333333],[18.33333333],[13.33333333],[11.33333333],[13.33333333],[15.66666667],[13.16666667],[10.83333333],[13.16666667],[8.0],[13.0],[11.33333333],[11.33333333],[10.83333333],[8.0],[13.66666667],[8.0],[13.0],[13.0],[13.0],[13.0],[13.33333333],[13.0],[13.33333333],[13.0],[12.83333333],[13.66666667],[12.83333333],[13.66666667],[12.0],[12.0],[12.0],[12.0],[12.0],[12.0],[12.0],[12.0],[15.33333333],[15.33333333],[15.33333333],[12.0],[15.33333333],[13.66666667],[13.66666667],[12.0],[12.0],[15.33333333],[15.0],[15.33333333],[18.0],[15.0],[18.0],[15.33333333],[18.0],[15.33333333],[12.0],[18.0],[15.33333333],[18.0],[18.0],[18.0],[18.0],[18.0],[18.0],[18.0],[18.0],[18.0],[18.0],[15.33333333],[12.0],[18.0],[18.0],[18.0],[16.75],[15.5],[12.0],[15.0],[15.33333333],[12.0],[13.25],[12.0],[8.5],[13.25],[8.5],[15.5],[12.0],[8.5],[12.0],[8.5],[14.08333333],[8.5],[18.0],[15.5],[8.5],[15.5],[14.08333333],[15.5],[12.0],[12.33333333],[12.0],[12.66666667],[15.33333333],[12.66666667],[15.5],[15.5],[8.5],[12.66666667],[14.08333333],[8.5],[15.5],[14.08333333],[8.5],[8.5],[11.0],[15.5],[8.5],[15.5],[13.5],[13.5],[13.5],[14.5],[13.5],[15.5],[14.5],[13.5],[13.5],[13.5],[13.5],[0.0],[0.0],[0.0],[12.66666667],[12.66666667],[0.0],[10.66666667],[10.66666667],[18.0],[10.66666667],[10.66666667],[10.66666667],[10.66666667],[10.66666667],[10.66666667],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[25.33333333],[13.33333333],[25.33333333],[23.33333333],[10.66666667],[23.33333333],[13.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[13.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[23.33333333],[19.16666667],[23.33333333],[23.33333333],[6.0],[15.0],[13.33333333],[18.33333333],[13.33333333],[15.0],[25.33333333],[0.0],[15.0],[15.0],[17.41666667],[21.58333333],[15.0],[15.0],[15.0],[19.83333333],[19.83333333],[19.83333333],[19.83333333],[15.0],[13.75],[21.58333333],[19.83333333],[19.83333333],[19.83333333],[19.83333333],[6.0],[12.5],[15.0],[13.75],[16.16666667],[15.0],[12.5],[15.0],[12.5],[15.0],[6.0],[15.0],[19.83333333],[9.666666667],[6.0],[15.0],[13.33333333],[15.0],[15.0],[15.0],[6.0],[13.33333333],[12.5],[15.0],[15.0],[12.5],[13.75],[12.5],[12.5],[13.75],[12.5],[12.5],[12.5],[12.5],[12.5],[19.83333333],[12.5],[19.83333333],[19.83333333],[21.58333333],[16.16666667],[19.83333333],[12.5],[12.5],[12.5],[19.83333333],[12.5],[12.5],[12.5],[19.83333333],[19.83333333],[0.0],[0.0],[0.0],[0.0],[0.0],[12.75],[12.0],[11.25],[12.75],[11.25],[11.25],[0.0],[0.0],[0.0],[11.25],[23.0],[23.0],[23.0],[23.0],[23.0],[23.0],[23.0],[23.0],[23.0],[23.0],[12.66666667],[21.83333333],[23.0],[16.16666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[10.5],[10.5],[11.66666667],[10.5],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[11.66666667],[10.5],[13.75],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[17.0],[0.0],[10.5],[10.25],[13.5],[10.0],[10.0],[10.0],[10.0],[10.0],[10.0],[10.0],[13.5],[0.0],[10.0],[10.0],[13.5],[14.33333333],[17.0],[17.0],[13.5],[17.0],[10.0],[17.0],[17.0],[17.0],[13.5],[10.0],[17.0],[11.66666667],[17.0],[17.0],[0.0],[11.66666667],[17.0],[0.0],[10.0],[12.0],[12.0],[12.0],[0.0],[0.0],[10.0],[12.0],[12.0],[12.0],[10.0],[12.0],[7.0],[7.0],[7.0],[7.0],[13.0],[7.0],[7.0],[7.0],[0.0],[7.0],[7.0],[0.0],[0.0],[0.0],[7.0],[0.0],[11.0],[11.0],[0.0],[0.0],[14.0],[0.0],[0.0],[11.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"q","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758778872,"submitTime":1493758756463,"finishTime":1493758778994,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"621.181818","height":"416.181818","xColumns":[],"yColumns":["q"],"pivotColumns":[],"pivotAggregation":"count","customPlotOptions":{"histogram":[{"key":"bins","value":"20"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Distribution of Q values","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6468011b-d1c2-42fd-bfa2-370c716f74b0"},{"version":"CommandV1","origId":2109564766429445,"guid":"84740b7c-abf1-45a8-8d18-f57a85edc243","subtype":"command","commandType":"auto","position":6.999755501747131,"command":"%md\nDistribution of q values is around 14, with the range mostly between 5 - 25. The values around 0 appear to be erroneous and should be removed. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756507,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6a8dffd-1428-4a8c-a142-343f809edc98"},{"version":"CommandV1","origId":2109564766429446,"guid":"7d5ba5e0-9a4f-4daf-934b-f1d251237fba","subtype":"command","commandType":"auto","position":6.999755680561066,"command":"%md\n### Review of Data within the smry_pen_rate table","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756573,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6a592519-9384-441b-970a-22d607891501"},{"version":"CommandV1","origId":2109564766429447,"guid":"9d2b9e41-a474-464a-b9cb-18992387e7b5","subtype":"command","commandType":"auto","position":6.999755725264549,"command":"%sql\n-- How many individual blast locaitons are there?\nSELECT distinct (BLAST_LOC)\nFROM smry_pen_rate","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-035_tc EAST"],["160-037"],["256-234 prod"],["256-246_tc2"],["250-029"],["220-140toe"],["160-021tc"],["160-028"],["184-055_W"],["160-023north2"],["208-223"],["148-021"],["148-032"],["160-001"],["172-ps13"],["256-fr01"],["148-025"],["148-027"],["148-029"],["148-023"],["172-047"],["184-054"],["160-007"],["148-002b"],["208-ps25"],["148-019"],["244-249_ext"],["256-247west"],["160-018_ext"],["256-245tc"],["184-059"],["184-053tc"],["172-048 PROD"],["172-ps18"],["160-027_tc1"],["160-032"],["184-056D65"],["172-048probes"],["244-234east"],["160-006"],["184-055_E"],["256-234 N"],["160-035"],["148-pmhole_dr4"],["184-067new"],["208-125"],["232-150_east"],["256-239new"],["172-043 D65 UG"],["256-249"],["148-007"],["172-048 S"],["250-025tc"],["268-094 PT2"],["172-043 D65 PROD"],["160-014"],["160-ps02"],["148-010"],["148-034_west"],["160-018 D65E"],["196-108tc"],["160-023south"],["244-242"],["268-097"],["196-116"],["172-ps15"],["160-010"],["250-025D652"],["172-045"],["244-259"],["196-ps23"],["268-089tc4"],["172-037"],["208-ps27"],["172-048 C"],["160-008"],["172-027d65west"],["250-025north"],["172-038"],["256-fr01center"],["160-ps07"],["160-036"],["172-034"],["148-ps01"],["148-003"],["160-031"],["256-249_tc2"],["268-094tc"],["160-011"],["264-025"],["256-232"],["160-037 probing"],["148-002a"],["160-020"],["256-236 S"],["172-030"],["256-236 N"],["256-238"],["208-124"],["220-136 center"],["160-010 tc"],["244-241new"],["232-148A"],["268-106"],["256-235"],["172-043tc D65"],["268-109"],["184-ps12"],["244-253"],["172-027d65east"],["244-fr01east"],["148-033"],["160-034"],["232-150-drillablearea"],["220-136_tc_new"],["160-005"],["196-111VC"],["208-222"],["160-026"],["208-130"],["256-250"],["160-027"],["250-025northV2"],["160-024west"],["256-241"],["148-030"],["148-002"],["172-ps16"],["148-011"],["256-fr01west"],["196-113east"],["220-139"],["160-003"],["160-018"],["268-099"],["232-149"],["250-028"],["232-148B"],["244-246tc"],["256-248"],["148-012"],["160-023north"],["184-053tcD65"],["184-065"],["160-025"],["184-067"],["160-024_east"],["148-039"],["184-066"],["172-032"],["184-056"],["232-151tc"],["160-009 D65E"],["244-240"],["268-112"],["160-009"],["148-041north"],["256-252"],["256-245_west"],["160-021"],["268-103"],["244-237"],["160-005tc"],["256-247east"],["148-ps02"],["256-242"],["160-029"],["dr2pmhole-256"],["148-041"],["256-234 crest"],["244-256"],["184-ps11"],["172-036"],["232-150"],["268-098"],["160-038"],["172-ps12"],["244-234north"],["172-027tc"],["160-030"],["256-237"],["256-246"],["148-017"],["256-234"],["232-148C"],["196-115"],["148-022"],["232-154"],["244-234"],["244-252"],["256-233"],["196-ps24"],["148-006"],["256-231"],["184-061"],["256-234 tc"],["160-039"],["148-019tc"],["232-150_cutoff"],["256-251"],["184-056-1"],["160-040"],["268-102"],["172-044"],["160-ps01"],["244-243"],["148-ps05"],["160-ps04"],["160-013"],["268-100 S"],["184-053"],["148-035_tc"],["250-025"],["160-ps08"],["244-257"],["268-101toe"],["172-042"],["208-ps26"],["268-089tc2"],["268-109probe"],["256-ps04"],["172-033"],["172-035"],["probe_172-041"],["268-095"],["250-fr01-01"],["256-253"],["172-048"],["184-056-2"],["244-238"],["268-094tc2"],["268-094 D65 PT1"],["208-ps23"],["250-025_toe"],["160-015"],["160-033"],["244-246"],["268-104"],["268-094"],["184-064"],["244-ps21"],["148-038"],["172-043"],["244-254"],["196-114"],["244-236D651"],["234-244west"],["160-017A"],["172-027"],["196-110"],["184-063"],["172-031_frost"],["232-149D65"],["196-113west"],["244-236"],["244-244"],["264-027"],["244-249"],["148-035"],["172-041"],["184-060"],["250-027"],["172-046"],["220-ps18correct"],["160-ps03"],["184-053_probesholes_redrill"],["244-245"],["256-239"],["244-255"],["148-020"],["148-031"],["148-013"],["148-014"],["268-100 N"],["256-232d65east"],["160-019"],["268-110"],["208-126"],["256-245_east"],["148-016"],["148-042"],["148-023tc1"],["148-003atc"],["148-026"],["148-024"],["160-ps09"],["160-004"],["148-003a"],["268-089P1"],["256-232d65west"],["160-024west tc"],["220-138"],["244-241"],["232-151"],["208-129"],["172-048addedcholes"],["148-005"],["244-239"],["184-057frost"],["268-089Col"],["256-240"],["148-041south"],["160-016"],["268-108"],["172-039"],["184-062"],["244-258"],["268-107"],["220-137new"],["220-136 west"],["256-236"],["148-034_east"],["160-004A"],["208-220"],["160-002"],["dr-5_pm_hole"],["250-025middle"],["244-251"],["256-244"],["148-001"],["196-113"],["148-ps08"],["172-050"],["172-040"],["268-093"],["196-108"],["208-131"],["172-049"],["172-ps17"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758779000,"submitTime":1493758756620,"finishTime":1493758779957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61a24b38-44b8-4360-8a17-350ad565aeca"},{"version":"CommandV1","origId":2109564766429448,"guid":"7e4b4681-5272-4614-a280-ea41c8ead0b9","subtype":"command","commandType":"auto","position":6.999755747616291,"command":"%md\nThe levels in smry_pen_rate range from 148 - 268, with four records for levels that have alpha-numeric characters. These should be removed. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756665,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2552f692-a118-4f9f-8866-af226e2d77eb"},{"version":"CommandV1","origId":2109564766429449,"guid":"7a865d5d-19ea-41af-9247-2675ba626885","subtype":"command","commandType":"auto","position":6.999755769968033,"command":"%sql\n-- Counts of distinct levels \nSELECT DISTINCT (lvl), COUNT(lvl) as counts\nFROM smry_pen_rate\nGROUP BY lvl \nORDER BY counts","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dr2pmhole",1],["dr",1],["probe_172",2],["234",67],["264",156],["196",1032],["220",1044],["250",1052],["232",1573],["208",1824],["268",3187],["184",3288],["244",3721],["256",4676],["148",5774],["172",7019],["160",9545]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"lvl","type":"\"string\"","metadata":"{}"},{"name":"counts","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758779962,"submitTime":1493758756715,"finishTime":1493758780916,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"493bebd3-48c8-4dd8-b89b-77101939b334"},{"version":"CommandV1","origId":2109564766429450,"guid":"d8801f89-c197-4678-9fa8-df62a9507939","subtype":"command","commandType":"auto","position":6.999755781143904,"command":"%md \nNumber of levels range from 160-234 which is similar to that shown in the smry_geotech. There are some discrepancies, such as the alphabetic characters. These should be removed.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756758,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f805db9-fd6e-4dfe-8ff6-6e7c83c53650"},{"version":"CommandV1","origId":2109564766429451,"guid":"c5757ae5-0064-454e-a6b9-96d42c27cda5","subtype":"command","commandType":"auto","position":6.999755792319775,"command":"%sql\n-- Counts of distinct levels \nSELECT DISTINCT (BLAST_NO), COUNT(BLAST_NO) as counts\nFROM smry_pen_rate\nGROUP BY BLAST_NO \nORDER BY counts","commandVersion":0,"state":"finished","results":{"type":"table","data":[["009 D65E",1],["pmhole_dr4",1],["002b",1],["025north",1],["5_pm_hole",1],["148A",1],["048probes",1],["037 probing",1],["246tc",1],["089P1",1],["053tcD65",1],["023north2",1],["043 D65 PROD",2],["249_tc2",2],["136 center",2],["245tc",2],["140toe",2],["109probe",2],["154",2],["041north",4],["027d65east",4],["234east",5],["113east",5],["ps24",5],["56-1",6],["236D651",7],["041south",7],["053_probesholes_redrill",8],["034_east",9],["027d65west",9],["094 D65 PT1",9],["043 D65 UG",9],["018 D65E",10],["025_toe",10],["232d65east",11],["ps05",11],["234 N",11],["245_east",11],["150-drillablearea",12],["232d65west",13],["048addedcholes",15],["ps18correct",15],["102",15],["035_tc",16],["023tc1",17],["236 S",17],["027_tc1",19],["025D652",20],["031_frost",21],["151tc",21],["257",21],["223",21],["fr01west",23],["236 N",23],["048 PROD",23],["094tc",23],["048 C",25],["53",25],["ps16",25],["104",27],["010 tc",28],["034_west",29],["089tc2",30],["256",32],["094 PT2",33],["56-2",34],["234 tc",34],["232",34],["094tc2",35],["057frost",36],["101toe",37],["ps18",37],["fr01-1",38],["97",39],["241new",41],["025middle",43],["ps07",43],["67",44],["ps23",44],["089Col",44],["113west",45],["ps03",45],["234 crest",46],["126",47],["129",47],["056D65",48],["ps21",49],["111VC",49],["116",51],["246_tc2",51],["089tc4",52],["ps09",54],["234north",56],["043tc D65",57],["ps25",57],["115",59],["247east",63],["018_ext",65],["150_east",65],["002a",65],["244west",67],["ps13",69],["106",71],["44",71],["ps26",71],["003atc",74],["139",74],["24",76],["112",76],["259",77],["98",80],["ps27",82],["47",83],["234 prod",86],["4",86],["fr01center",87],["ps17",87],["137new",88],["024west tc",88],["109",89],["258",91],["17",92],["004A",92],["149D65",93],["99",93],["067new",96],["54",99],["245",101],["250",105],["108tc",106],["ps08",107],["053tc",107],["150",108],["048 S",110],["151",112],["ps15",113],["64",113],["65",114],["28",127],["5",128],["ps12",128],["249",128],["035_tc EAST",129],["253",133],["22",134],["fr01east",136],["249_ext",138],["3",140],["024west",141],["247west",142],["100 S",147],["19",150],["251",151],["100 N",152],["255",154],["231",155],["108",156],["ps02",163],["63",163],["45",164],["14",167],["233",168],["005tc",169],["025tc",170],["245_west",173],["8",173],["ps04",174],["222",174],["ps01",174],["019tc",175],["7",179],["239new",180],["10",183],["254",185],["131",186],["93",189],["ps11",190],["13",191],["248",192],["26",193],["241",194],["021tc",194],["62",196],["149",196],["138",203],["50",203],["024_east",205],["027tc",210],["114",218],["59",219],["46",219],["240",221],["003a",222],["017A",228],["60",229],["246",230],["125",236],["055_W",236],["130",239],["055_E",239],["243",240],["12",247],["1",250],["124",252],["42",255],["95",259],["113",266],["136 west",275],["31",278],["9",281],["49",285],["150_cutoff",290],["025northV2",293],["148B",295],["239",299],["34",313],["66",315],["244",319],["16",321],["238",328],["61",334],["110",340],["252",344],["103",348],["36",353],["235",357],["23",363],["35",364],["6",370],["148C",378],["40",383],["136_tc_new",385],["56",386],["2",398],["220",399],["237",400],["11",411],["107",418],["43",455],["15",489],["234",496],["21",499],["25",502],["20",516],["023north",532],["48",544],["242",547],["37",548],["023south",556],["32",563],["18",564],["38",568],["236",583],["fr01",612],["94",619],["30",746],["41",756],["29",843],["33",923],["39",984],["27",1190]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_NO","type":"\"string\"","metadata":"{}"},{"name":"counts","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758780921,"submitTime":1493758756814,"finishTime":1493758781725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f769cfb-8379-46db-8d2d-d5e44f58b0cf"},{"version":"CommandV1","origId":2109564766429452,"guid":"0e5640ff-fa80-440d-b0ef-612d45642a10","subtype":"command","commandType":"auto","position":6.9997558034956455,"command":"%md\nThis table should correspond to the blast_number summary from smry_geotech above. However it's clear that there are large differences. For example, in this table there are many values with alphabetic characters. Ideally they should have a three digit numeric character. These will need to be normalized or removed during cleaning.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756860,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72e3afea-9323-4555-bac1-370f19e0f271"},{"version":"CommandV1","origId":2109564766429453,"guid":"3ad10856-ca6c-438a-989b-c6973d434e43","subtype":"command","commandType":"auto","position":6.999755814671516,"command":"%sql\n-- Distribution of pen_rate values\nSELECT pen_rate\nFROM smry_pen_rate","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.50192],[0.42188],[0.44778],[0.51434],[0.37498],[0.47596],[0.53324],[0.41722],[0.26134],[0.54634],[0.45528],[0.3351],[0.44128],[0.45542],[1.56135],[0.32701],[0.50965],[0.41631],[0.39107],[0.30238],[0.46861],[0.40652],[0.53941],[0.41517],[0.51411],[0.54478],[0.41561],[0.3093],[0.41927],[0.39301],[0.42998],[0.67722],[0.25133],[0.45233],[0.41327],[0.50714],[0.38735],[0.36885],[0.44808],[0.74288],[0.43943],[0.49599],[0.43416],[0.42783],[0.40196],[0.50756],[0.45003],[0.77962],[0.46211],[0.18749],[0.41203],[0.4015],[0.39229],[0.66995],[0.53747],[0.50152],[0.4689],[0.46386],[0.42513],[0.34614],[0.48887],[0.5215],[0.43065],[0.49179],[0.44867],[0.38256],[0.35003],[0.47636],[0.39217],[0.3916],[0.50708],[0.46352],[0.49017],[0.39196],[0.53542],[0.38276],[0.50389],[0.4504],[0.46314],[0.63409],[0.4381],[0.36505],[0.70741],[0.32847],[0.54345],[0.38202],[0.39031],[0.06182],[0.37232],[0.42975],[0.55436],[0.50663],[0.46238],[0.29398],[0.63114],[0.34918],[0.73411],[0.55011],[0.37377],[0.56859],[0.28134],[0.53677],[0.33305],[0.59475],[0.46133],[0.51958],[0.47466],[0.45411],[0.46743],[0.40962],[0.40976],[0.4814],[0.37922],[0.44758],[0.64492],[0.52462],[0.55388],[0.51559],[0.51567],[0.44265],[0.40553],[0.44256],[1.06432],[0.54335],[0.49212],[0.41263],[0.41315],[0.49989],[0.5844],[0.42504],[0.33083],[0.43484],[0.43525],[0.58516],[0.50263],[0.53933],[0.35902],[0.55047],[0.29857],[0.43761],[0.44086],[0.54416],[0.84838],[2.242],[0.38412],[0.42157],[0.51615],[0.30025],[0.42368],[0.38802],[0.50022],[0.42763],[0.39731],[0.41752],[0.38236],[0.41513],[0.58586],[0.54953],[0.4977],[0.4384],[0.49968],[0.48025],[0.48566],[0.73142],[0.52507],[0.49913],[0.52968],[0.61644],[0.25288],[0.52921],[0.32344],[0.48841],[0.44285],[0.51776],[0.09596],[0.12584],[0.52524],[0.21967],[0.51763],[0.6177],[0.08696],[0.40741],[0.15553],[0.4565],[0.67164],[0.45934],[0.50945],[0.5437],[0.33268],[0.45134],[0.3742],[0.46531],[0.42513],[0.30656],[0.4571],[0.55163],[0.55185],[0.53324],[0.51026],[2.215],[0.45614],[0.36344],[0.3372],[0.01868],[0.46113],[0.51358],[0.45823],[0.0892],[0.56358],[0.46818],[0.46483],[0.50099],[0.40224],[0.79543],[0.57165],[0.63565],[0.37076],[0.46426],[0.40477],[0.68478],[0.40076],[0.51666],[0.4097],[0.41399],[0.34398],[0.36585],[0.30257],[0.33547],[0.68746],[0.47844],[0.49451],[0.53996],[0.48834],[0.09828],[0.55944],[0.06022],[0.47348],[0.0769],[0.43075],[0.46862],[0.50808],[0.08363],[0.06928],[0.46618],[0.55],[0.15435],[0.90309],[0.48888],[0.40538],[0.26988],[0.378],[0.51072],[0.42026],[0.33187],[0.08278],[0.43981],[0.11869],[0.67875],[1.23983],[0.3438],[0.29306],[0.3335],[0.83656],[0.53382],[0.2686],[0.38508],[0.38084],[0.44843],[0.3635],[0.38397],[0.32456],[0.22132],[0.54276],[0.43933],[0.41269],[0.45614],[0.34883],[0.51559],[0.56521],[0.53673],[0.55889],[0.503],[0.71674],[0.04558],[0.2986],[0.25899],[0.71221],[0.10029],[0.4772],[0.1498],[0.55185],[0.76592],[0.08269],[0.38957],[1.2203],[0.51702],[0.46794],[0.55596],[0.50017],[0.53704],[0.70982],[0.51866],[0.58664],[0.3683],[0.00993],[0.42741],[0.55936],[1.24506],[0.35327],[0.37019],[12.93908],[0.7436],[0.10173],[0.19028],[0.47254],[0.58594],[0.47202],[0.48961],[3.38589],[0.39105],[0.41501],[0.55951],[0.5265],[0.51188],[0.48226],[0.39521],[0.21794],[0.18008],[0.0],[0.51525],[0.47916],[0.30815],[0.17129],[0.96119],[0.09013],[0.50483],[0.16479],[0.17725],[0.58306],[1.02639],[1.22879],[0.91513],[12.54549],[0.13506],[0.4138],[0.42603],[0.24675],[0.3213],[0.35122],[0.47842],[0.40707],[0.55973],[0.38221],[0.33274],[0.34718],[0.12672],[0.49439],[0.43588],[0.08423],[0.78774],[0.74051],[0.65167],[0.72773],[0.09917],[0.096],[0.30882],[0.7448],[0.34185],[0.63644],[0.09636],[0.36184],[0.41576],[0.44914],[0.5542],[0.46716],[13.52739],[0.7397],[0.36422],[0.48454],[0.39929],[0.65163],[1.70691],[0.62476],[0.47514],[0.60488],[0.65214],[0.39493],[0.81672],[0.50886],[0.82657],[0.42641],[0.06215],[0.0615],[0.75802],[2.398],[0.69061],[0.34272],[0.43038],[0.5143],[2.32548],[0.42246],[0.51055],[0.47768],[0.21781],[0.45238],[0.65152],[0.63352],[0.38531],[0.43799],[0.56918],[0.13191],[0.70275],[0.1047],[0.38484],[0.04633],[0.69911],[0.0724],[13.098],[0.42208],[0.05772],[0.35846],[0.48447],[0.44817],[0.50803],[0.48998],[0.29113],[0.52616],[0.7104],[0.38955],[0.39923],[3.4533],[0.69452],[0.42857],[0.05033],[0.45338],[0.88382],[0.09463],[0.19368],[0.15938],[0.40512],[0.49238],[0.05253],[0.06491],[1.01005],[1.117],[0.46907],[0.36633],[0.41667],[13.72819],[0.44994],[0.31934],[0.47596],[0.46773],[0.35533],[0.47026],[0.40371],[0.54571],[0.63464],[13.82305],[0.41784],[0.42413],[0.52441],[3.1E-4],[13.79214],[0.56642],[0.05293],[0.4848],[0.05731],[0.61386],[0.15794],[0.42226],[0.61459],[0.46663],[0.50806],[0.41218],[0.45656],[0.32625],[0.68666],[1.8E-4],[0.71618],[0.46809],[0.1558],[0.46367],[0.32888],[0.33661],[0.41848],[0.57728],[0.45513],[0.51581],[1.31044],[0.30741],[0.51178],[0.43525],[0.80362],[0.00304],[0.64268],[0.32767],[0.34977],[0.60133],[0.56758],[0.41064],[0.37742],[0.2753],[0.47391],[0.03778],[0.53479],[0.84077],[0.66805],[0.47874],[13.91313],[0.28039],[0.98416],[4.17027],[0.49718],[0.52069],[0.45122],[0.39186],[0.01852],[0.32612],[0.53632],[14.11986],[0.73487],[0.39577],[0.52465],[4.56904],[0.50381],[0.40124],[0.4284],[0.45343],[0.47434],[0.6045],[0.25624],[0.373],[0.68783],[0.35339],[0.265],[0.58149],[0.59207],[1.17122],[0.42937],[0.4501],[0.32862],[0.51431],[0.54501],[0.6513],[0.48995],[0.40429],[0.63309],[0.53993],[0.50357],[0.23692],[0.27621],[0.48279],[0.44365],[0.52424],[0.52795],[0.45287],[0.49604],[0.48198],[0.36541],[0.49638],[0.31739],[0.39317],[0.12038],[0.06626],[0.39059],[0.07839],[0.38111],[0.13993],[0.3271],[0.49732],[0.47243],[0.46399],[0.42473],[0.35225],[0.38935],[0.4854],[0.37599],[0.44352],[0.23328],[0.50224],[0.42909],[0.50055],[0.54085],[0.31141],[0.43806],[0.3111],[0.34203],[0.47031],[0.44775],[0.27655],[0.52074],[0.42422],[0.43295],[0.39747],[0.1282],[0.36137],[0.47873],[0.42633],[0.02368],[0.48296],[0.46883],[0.2864],[0.36491],[0.55342],[0.38198],[0.51017],[0.33065],[0.25096],[0.37978],[0.47422],[0.42955],[0.43031],[0.48706],[0.41549],[0.52451],[0.5578],[0.30935],[0.42819],[0.38149],[0.61751],[0.46867],[5.09345],[0.41309],[0.47153],[0.47443],[0.37932],[0.28704],[0.45866],[0.46895],[0.37289],[0.45528],[0.45817],[0.4353],[0.46829],[0.44263],[0.45341],[0.50524],[0.41357],[0.51938],[0.51964],[0.43742],[0.4498],[0.36116],[0.41695],[0.48705],[0.49254],[0.47281],[3.46082],[0.55882],[0.46958],[0.54581],[0.55211],[0.43581],[0.43777],[0.41212],[0.38566],[0.49768],[0.41788],[0.37996],[0.32413],[0.51108],[0.41166],[0.55409],[0.49202],[0.49583],[0.43679],[0.4893],[0.34931],[0.38521],[2.59283],[0.53774],[0.37757],[0.44011],[0.57968],[0.53111],[0.4573],[0.70676],[0.53469],[0.81406],[0.3138],[0.55648],[1.14067],[0.45708],[0.50503],[0.41319],[0.5016],[0.50312],[0.57165],[0.46993],[0.4535],[0.34928],[0.26673],[0.35482],[0.56076],[0.48113],[0.4531],[0.52585],[0.07338],[0.43993],[0.08257],[0.41433],[0.34951],[0.3544],[0.64134],[0.35963],[0.084],[0.49118],[0.46762],[0.40979],[0.4518],[0.49245],[1.05694],[0.44784],[0.50517],[0.4519],[0.15535],[0.44636],[0.43835],[0.35451],[0.15317],[0.5025],[0.36149],[0.26568],[0.49503],[0.28031],[0.09129],[0.48984],[0.40189],[0.45692],[0.34746],[0.1726],[0.0877],[0.3714],[0.51189],[0.46173],[1.05115],[0.40059],[0.37436],[0.09036],[0.14301],[0.41792],[0.73692],[0.46987],[1.16659],[0.17495],[0.60722],[0.45734],[0.67858],[0.3886],[0.36226],[0.42103],[0.59989],[0.41038],[0.45222],[0.29587],[0.45533],[0.37803],[0.54508],[0.48008],[0.37035],[0.4392],[13.85114],[0.46466],[0.46082],[0.44348],[0.5125],[1.16443],[0.57509],[0.52305],[0.4479],[0.00284],[0.48237],[0.40064],[0.45546],[0.20004],[0.45511],[0.5089],[0.47483],[0.51381],[1.00342],[0.74253],[0.57919],[0.42824],[0.43044],[0.40177],[0.40537],[0.4185],[0.01693],[0.05175],[0.40949],[0.4132],[0.35974],[0.33858],[0.56708],[0.50103],[0.38363],[0.47096],[0.31516],[0.4235],[0.41334],[0.3807],[0.35684],[0.42042],[0.37238],[0.47965],[0.12269],[0.27396],[0.44339],[0.35033],[2.4058],[0.33933],[0.49746],[0.51953],[0.61496],[0.29767],[0.84551],[0.54439],[0.46811],[0.36234],[0.71401],[0.54282],[0.52069],[0.39182],[0.45872],[0.44419],[0.52649],[0.2647],[0.42401],[0.37915],[0.38692],[0.34919],[0.67846],[0.67904],[0.85164],[0.71612],[0.32028],[0.68431],[0.70986],[0.69126],[0.46023],[0.64619],[0.39936],[0.68516],[0.56468],[0.68481],[0.66829],[0.49002],[0.62862],[0.67866],[0.59121],[0.69597],[0.5514],[0.67845],[0.51989],[0.61577],[0.38595],[0.79924],[0.30985],[0.22429],[0.35491],[0.52659],[0.52951],[0.68323],[0.66209],[0.32742],[0.43038],[0.75238],[0.34895],[0.378],[0.60572],[0.53876],[0.58241],[0.58078],[0.71743],[0.31978],[0.65163],[13.38432],[0.54194],[0.49952],[0.44469],[0.42918],[0.4267],[0.57628],[0.49554],[0.551],[0.63925],[0.73273],[0.66173],[0.64031],[0.27682],[0.22236],[0.25468],[0.47012],[0.52724],[0.43748],[0.2206],[0.70074],[0.1317],[0.48576],[0.3841],[0.68463],[0.5642],[0.55702],[0.40732],[0.42497],[0.18539],[0.70376],[0.47638],[0.63027],[1.48448],[0.65009],[0.68784],[0.55859],[0.50776],[0.59994],[0.4539],[1.94994],[0.34477],[0.38368],[0.53041],[0.52361],[0.55042],[0.57928],[0.46338],[0.24225],[0.45405],[0.54788],[0.22194],[0.44285],[0.54849],[0.46263],[0.51766],[0.56326],[0.49692],[0.52433],[0.51031],[0.55026],[0.62019],[0.38573],[0.44755],[0.41301],[0.52187],[0.4554],[0.5412],[0.51027],[0.00207],[0.56153],[0.68181],[0.21209],[0.4266],[0.41232],[0.61036],[0.17693],[0.51288],[0.52599],[0.50532],[0.57628],[0.52926],[0.39913],[2.267],[0.29205],[0.42137],[0.54645],[0.53382],[0.46386],[0.56416],[0.49574],[0.67067],[0.67132],[0.62962],[0.5104],[0.41747],[0.39106],[0.33872],[0.35585],[0.45148],[0.3292],[0.43849],[0.43303],[0.49661],[0.4109],[0.347],[0.45485],[0.55872],[0.51294],[0.27582],[0.47962],[0.31419],[0.44014],[0.56312],[0.31974],[0.48451],[0.51197],[1.35595],[0.5202],[0.3898],[0.38457],[0.5486],[0.3364]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"pen_rate","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[[0.0,41990],[1.5837965,859],[3.167593,266],[4.7513895,90],[6.335186,205],[7.9189825,41],[9.502779,10],[11.0865755,102],[12.670372,354],[14.2541685,14],[15.837965,11],[17.421761500000002,2],[19.005558,1],[20.5893545,5],[23.756947500000003,1],[25.340744,7],[28.508337,2],[30.092133500000003,1],[31.67593,1]],"aggSchema":[{"name":"__DATABRICKS_INTERNAL_HISTOGRAM_BIN_FIELD__","type":"\"double\"","metadata":"{\"aggRole\":\"groupBy\"}"},{"name":"pen_rate","type":"\"double\"","metadata":"{\"aggRole\":\"agg\"}"}],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"histogram","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758781729,"submitTime":1493758756924,"finishTime":1493758783053,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"630.181818","height":"714.181818","xColumns":[],"yColumns":["pen_rate"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"histogram":[{"key":"bins","value":"20"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5862468d-ed97-4a5e-acaa-0725b8fd2264"},{"version":"CommandV1","origId":2109564766429454,"guid":"437d90b3-3d3c-4c33-9567-ff11fbcb8b6f","subtype":"command","commandType":"auto","position":6.999755837023258,"command":"%md\nThere are many penetrations rates above 2. It is unclear if these are erroneous and should be exploded. Check with the mining professor.\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758756970,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"77ec19eb-caac-4113-8802-94f379ddeddd"},{"version":"CommandV1","origId":2109564766429455,"guid":"05f9381a-ae02-464e-9844-5d183822e934","subtype":"command","commandType":"auto","position":6.999755848199129,"command":"%sql\n-- Rock type classifications\nSELECT DISTINCT rock_type, count(rock_type)\nFROM smry_pen_rate\nGROUP BY rock_type","commandVersion":0,"state":"finished","results":{"type":"table","data":[["TC",2023],["FI",377],["AM",29],["PF",5235],["UI",11],["CG",877],["MI",13],["FV",3865],["GB",46],["OVB",6095],["KB",3],["CH",55],["KP",6303],["KM",1203],["MF",16772],["VC",882],["CB",173]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"rock_type","type":"\"string\"","metadata":"{}"},{"name":"count(rock_type)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758783062,"submitTime":1493758757026,"finishTime":1493758783872,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"465.181818","height":"299.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93a01afe-6783-4e64-a7a6-c6e6600f4ed2"},{"version":"CommandV1","origId":2109564766429456,"guid":"99dd8704-465d-425a-9e52-fdf4fad78b47","subtype":"command","commandType":"auto","position":6.999755848897621,"command":"%md\nThe majority of rock type classification is mf, followed by kp and ovb.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757067,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"68aefeaa-342b-4f91-8cc1-84420e4e2a7c"},{"version":"CommandV1","origId":2109564766429457,"guid":"bf60abc0-6d5b-456c-8ff2-95b715e9e7d5","subtype":"command","commandType":"auto","position":6.999755849596113,"command":"%md\n### Review of Data within the smry_bmm table","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757124,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"77a7cf76-c820-4462-b680-2f705dcd2c4c"},{"version":"CommandV1","origId":2109564766429458,"guid":"b9bb1cf5-1e27-4af5-aeb5-97104c29af1a","subtype":"command","commandType":"auto","position":6.999755849770736,"command":"%md\nFollowing discussions with Prof. Esmaeili and B.Ohadi, another data table was provided (smry_bmm). This table contains geotechnical data, blast parameters and blast outcomes for distinct blast locations. The data was compiled by B.Ohadi.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757177,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"efd26a85-eee4-4013-bd99-cb42e5f75141"},{"version":"CommandV1","origId":2109564766429459,"guid":"c7de27da-6712-4b37-a9a5-54cb95b6008f","subtype":"command","commandType":"auto","position":6.999755849945359,"command":"%sql -- Let's see what's in the smry_bmm table\nSELECT *\nFROM smry_bmm\nLIMIT 10","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",4,5.356508844,3.383941489,4.15224361,137.2274458,50.82110229,2.91],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",2,4.32437884,3.559450099,2.455721349,43.96416691,34.60241245,4.969],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",1,5.450931245,2.459278349,4.864627575,52.26805117,63.1814408,4.477],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","KP","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",3,3.770576537,3.582944739,1.174629483,38.55241937,18.15116816,3.609],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","PF","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",2,3.367295405,3.261074209,0.839090785,61.54097887,14.42948811,3.514],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",5,3.471212651,3.083808846,1.593562131,128.7207427,27.32771714,3.378],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","KP","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",3,10.6697479,8.512415932,6.432907214,74.42905077,37.07866057,3.502],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",9,5.262258131,5.243138373,0.448174779,30.23283923,4.885672245,3.794],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","MF","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",6,3.910291883,3.832769234,0.774766165,120.5125372,11.42792727,2.084],["148-20","H","",99.0,2.7,12.5,17.7,"148",0.741934184,"31/07/2016","KP","NA",0,0,3361641,361641,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Free Face",2,2.831665688,2.417720001,1.474096525,48.15194443,31.37088044,3.368]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM1","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM2","type":"\"string\"","metadata":"{}"},{"name":"RQD","type":"\"double\"","metadata":"{}"},{"name":"FRACS_FREQ","type":"\"double\"","metadata":"{}"},{"name":"IS_50","type":"\"double\"","metadata":"{}"},{"name":"Q","type":"\"double\"","metadata":"{}"},{"name":"LEVEL","type":"\"string\"","metadata":"{}"},{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"},{"name":"BLAST_DATE","type":"\"string\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"string\"","metadata":"{}"},{"name":"MATERIAL","type":"\"string\"","metadata":"{}"},{"name":"HG_MG","type":"\"integer\"","metadata":"{}"},{"name":"LG","type":"\"integer\"","metadata":"{}"},{"name":"NAG","type":"\"integer\"","metadata":"{}"},{"name":"TOTAL_TONS","type":"\"integer\"","metadata":"{}"},{"name":"BLAST_TYPE","type":"\"string\"","metadata":"{}"},{"name":"DH_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"RS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HOLE_DIA","type":"\"integer\"","metadata":"{}"},{"name":"BENCH_HEIGHT","type":"\"integer\"","metadata":"{}"},{"name":"BURDEN","type":"\"integer\"","metadata":"{}"},{"name":"SPACING","type":"\"integer\"","metadata":"{}"},{"name":"STEMMING","type":"\"double\"","metadata":"{}"},{"name":"SUB_DRILL","type":"\"double\"","metadata":"{}"},{"name":"EXPLOSIVE","type":"\"string\"","metadata":"{}"},{"name":"BLAST_PATTERN","type":"\"string\"","metadata":"{}"},{"name":"TOTAL_EXPLOSIVE","type":"\"double\"","metadata":"{}"},{"name":"HOLE_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"FIRING_DIRECTION","type":"\"string\"","metadata":"{}"},{"name":"POWDER_FACTOR","type":"\"double\"","metadata":"{}"},{"name":"INITIATION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"CONFINEMENT","type":"\"string\"","metadata":"{}"},{"name":"BMM_NUM","type":"\"integer\"","metadata":"{}"},{"name":"THREED_DIST","type":"\"double\"","metadata":"{}"},{"name":"H_DIST","type":"\"double\"","metadata":"{}"},{"name":"V_DIST","type":"\"double\"","metadata":"{}"},{"name":"DIRECTION","type":"\"double\"","metadata":"{}"},{"name":"INCLINATION","type":"\"double\"","metadata":"{}"},{"name":"HEAVE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758783876,"submitTime":1493758757225,"finishTime":1493758784025,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4a63385-858f-4b13-b97e-7da2b76c8910"},{"version":"CommandV1","origId":2109564766429460,"guid":"a6ea4589-5dce-4009-bc0e-aa5e6ec1e05b","subtype":"command","commandType":"auto","position":6.999755850294605,"command":"%sql\n-- See how many blast locations per blast level\nSELECT LEVEL, COUNT(LEVEL)\nFROM smry_bmm\nGROUP BY LEVEL\nSORT BY COUNT(LEVEL) DESC","commandVersion":0,"state":"finished","results":{"type":"table","data":[["232",183],["250",6],["160",100],["184",123],["166",2],["268",5],["208",205],["256",122],["244",193],["220",219],["190",9],["178",4],["148",71],["172",94],["264",8],["262",3],["196",183]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"LEVEL","type":"\"string\"","metadata":"{}"},{"name":"count(LEVEL)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: ParseException: \nmissing 'BY' at 'COUNT'(line 4, pos 5)\n\n== SQL ==\nSELECT BLAST_LOC, COUNT(BLAST_LOC) AS COUNT \nFROM smry_bmm \nGROUP BY BLAST_LOC\nSORT COUNT desc\n-----^^^\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nmissing 'BY' at 'COUNT'(line 4, pos 5)\n\n== SQL ==\nSELECT BLAST_LOC, COUNT(BLAST_LOC) AS COUNT \nFROM smry_bmm \nGROUP BY BLAST_LOC\nSORT COUNT desc\n-----^^^\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:50)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:47)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parse(DatabricksSqlParser.scala:69)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parsePlan(DatabricksSqlParser.scala:47)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:699)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758784032,"submitTime":1493758757264,"finishTime":1493758785004,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"646a019f-120c-449b-ba75-61b4441bac74"},{"version":"CommandV1","origId":2109564766429461,"guid":"1c70a1ce-c920-4788-9fae-f3de09de070e","subtype":"command","commandType":"auto","position":6.999755850643851,"command":"%md\nSome levels have a large number of blasts - for example, 208 and 256, while some levels have far fewer blast data associated. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757302,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a93a7e84-f815-499b-b86b-2be884a7e363"},{"version":"CommandV1","origId":2109564766429462,"guid":"3c2b74f2-2110-4caa-9c78-e086ca38f388","subtype":"command","commandType":"auto","position":6.999755850818474,"command":"%sql\n-- See distribution of RQD\nSELECT RQD\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[97.3],[97.3],[97.3],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[99.0],[99.0],[99.0],[99.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[99.0],[98.2],[98.2],[98.2],[98.7],[98.7],[98.7],[98.7],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[99.0],[98.7],[98.7],[98.7],[98.7],[97.3],[97.3],[97.3],[97.3],[99.0],[99.0],[99.0],[99.0],[98.0],[98.0],[98.0],[99.7],[99.7],[99.7],[99.7],[99.7],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[97.7],[97.7],[97.7],[97.7],[97.7],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[97.8],[99.7],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[98.2],[98.2],[96.0],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[97.0],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[95.0],[95.0],[95.0],[97.2],[97.2],[97.2],[97.2],[95.0],[95.0],[97.5],[97.5],[99.3],[99.3],[99.3],[96.4],[96.4],[96.4],[95.0],[95.0],[95.0],[96.8],[96.8],[96.8],[96.8],[96.8],[96.8],[96.8],[96.8],[96.8],[99.7],[99.7],[99.7],[99.7],[96.0],[96.0],[96.0],[96.0],[99.8],[99.8],[98.2],[98.2],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[96.0],[96.0],[100.0],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[98.2],[100.0],[100.0],[100.0],[100.0],[98.0],[98.0],[98.0],[98.0],[98.0],[100.0],[100.0],[100.0],[100.0],[98.0],[98.0],[98.0],[98.0],[98.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[100.0],[98.2],[98.2],[98.2],[98.2],[87.0],[87.0],[87.0],[87.0],[87.0],[87.0],[87.0],[87.0],[96.8],[95.6],[93.7],[93.7],[93.7],[97.5],[97.5],[97.5],[97.5],[97.5],[97.5],[100.0],[100.0],[96.3],[96.3],[96.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[93.3],[93.3],[93.3],[98.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[99.3],[98.3],[98.3],[99.3],[99.3],[99.3],[99.3],[99.3],[95.8],[95.8],[95.8],[95.8],[95.8],[96.3],[93.3],[93.3],[93.3],[96.3],[96.3],[93.3],[93.3],[93.3],[93.3],[99.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[99.3],[99.3],[99.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[98.3],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.8],[93.8],[93.8],[93.8],[93.8],[93.8],[93.8],[97.3],[97.3],[96.9],[96.9],[96.9],[96.9],[96.9],[93.5],[93.5],[93.5],[93.5],[93.5],[94.0],[94.0],[94.0],[94.0],[94.0],[94.0],[94.0],[94.0],[99.8],[99.8],[99.8],[99.8],[99.3],[99.3],[97.3],[97.3],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.2],[98.2],[90.0],[90.0],[90.0],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[93.3],[98.0],[98.0],[87.7],[87.7],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[94.3],[94.3],[94.3],[94.3],[98.7],[98.7],[98.7],[98.7],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[98.0],[98.0],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.0],[98.3],[98.3],[98.3],[98.3],[98.3],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[96.5],[96.5],[96.5],[96.5],[96.5],[96.5],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[98.7],[94.3],[94.3],[98.0],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[94.3],[98.7],[98.7],[98.7],[98.7],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[92.2],[90.0],[90.0],[90.0],[90.0],[90.0],[89.3],[89.3],[89.3],[89.3],[89.3],[89.3],[93.3],[93.3],[87.7],[87.7],[87.7],[87.7],[87.7],[87.7],[98.7],[98.7],[80.8],[80.8],[80.8],[80.8],[80.8],[80.8],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[88.5],[97.5],[97.5],[85.5],[85.5],[85.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[91.5],[85.5],[98.7],[98.7],[91.5],[91.5],[91.5],[96.3],[96.3],[96.3],[96.3],[96.3],[98.0],[98.0],[98.0],[98.0],[95.0],[95.0],[95.0],[95.0],[96.5],[96.5],[96.5],[98.7],[96.8],[96.8],[98.7],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[91.5],[91.5],[91.5],[91.5],[91.5],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[96.3],[96.3],[96.3],[96.3],[95.0],[95.0],[95.0],[98.7],[98.7],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[98.0],[98.0],[98.0],[96.3],[96.3],[98.7],[98.7],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[97.5],[96.3],[95.0],[95.0],[95.0],[95.0],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[96.3],[98.0],[98.0],[98.0],[96.5],[96.5],[96.5],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[98.0],[98.0],[98.0],[98.0],[98.0],[76.5],[85.5],[85.5],[58.0],[58.0],[58.0],[58.0],[98.7],[98.7],[95.0],[95.0],[95.0],[95.0],[95.0],[95.0],[76.0],[76.0],[76.0],[76.0],[76.0],[76.0],[76.0],[58.0],[58.0],[58.0],[58.0],[58.0],[77.7],[77.7],[77.7],[77.7],[64.7],[64.7],[90.7],[89.5],[89.5],[89.5],[89.5],[89.5],[89.5],[89.5],[90.1],[90.1],[90.1],[90.1],[89.5],[89.5],[89.5],[89.5],[92.1],[92.1],[92.1],[92.1],[92.1],[92.1],[92.1],[92.1],[90.7],[90.7],[90.7],[90.7],[90.7],[92.1],[92.1],[92.1],[92.1],[92.1],[92.1],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[93.5],[95.3],[95.3],[91.2],[91.2],[91.2],[91.2],[91.2],[91.2],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.0],[97.0],[97.0],[97.0],[97.0],[97.0],[84.7],[84.7],[84.7],[84.7],[84.7],[84.7],[84.7],[84.7],[84.7],[91.2],[91.2],[91.2],[91.2],[91.2],[91.2],[91.2],[91.2],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[97.7],[90.1],[90.1],[90.1],[90.1],[90.1],[90.1],[93.6],[93.6],[93.6],[93.6],[81.2],[81.2],[77.7],[77.7],[77.7],[77.7],[89.5],[89.5],[89.5],[89.5],[68.0],[68.0],[68.0],[91.0],[91.0],[95.0],[95.0],[95.0],[95.0],[71.0],[71.0],[71.0],[71.0],[71.0],[71.0],[71.0],[68.0],[68.0],[98.5],[98.5],[98.5],[78.5],[78.5],[98.5],[98.5],[98.5],[98.5],[98.5],[98.5],[91.0],[92.7],[92.7],[71.0],[71.0],[91.0],[71.0],[71.0],[71.0],[71.0],[71.0],[95.6],[95.6],[95.6],[94.3],[94.3],[94.3],[94.3],[95.6],[95.6],[95.6],[95.6],[95.6],[92.7],[92.7],[92.7],[92.7],[92.7],[92.7],[98.5],[98.5],[98.5]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"RQD","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"java.lang.IllegalArgumentException: requirement failed: Histogram supports only a single value","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758785014,"submitTime":1493758757346,"finishTime":1493758785317,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"692.181818","height":"261.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb2d3b55-43a1-4710-9c46-b629642f2355"},{"version":"CommandV1","origId":2109564766429463,"guid":"785f2007-6e09-481d-b1c8-68e0c6219ad5","subtype":"command","commandType":"auto","position":6.999755850905785,"command":"%md\nBased on visual assessment of the RQD, it appears that the data has been taken from the smry_geotech table. As that table has already been explored above, the subsequent visualizations will focus on the non-geotech parameters. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757388,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d4bb25c-91fb-4543-937e-cd9ee21abc4e"},{"version":"CommandV1","origId":2109564766429464,"guid":"c64d0322-d5a1-47f5-a065-cd3d69da9dc2","subtype":"command","commandType":"auto","position":6.999755850993097,"command":"%sql\n-- Box plot of Total Tons distribution\nSELECT TOTAL_TONS\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[262700],[262700],[262700],[316854],[316854],[361641],[361641],[361641],[361641],[361641],[361641],[633256],[633256],[633256],[633256],[633256],[633256],[633256],[633256],[633256],[207721],[207721],[207721],[207721],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[468000],[114666],[228000],[228000],[228000],[276000],[276000],[276000],[276000],[174000],[174000],[174000],[174000],[174000],[174000],[101000],[101000],[688000],[688000],[688000],[688000],[198000],[198000],[198000],[198000],[82900],[82900],[82900],[82900],[297192],[297192],[297192],[214769],[214769],[214769],[214769],[240420],[900813],[900813],[900813],[900813],[900813],[900813],[900813],[900813],[900813],[622099],[622099],[622099],[622099],[622099],[859484],[859484],[859484],[859484],[859484],[859484],[859484],[418472],[499071],[499071],[499071],[499071],[1648819],[1648819],[1648819],[1648819],[1648819],[474725],[474725],[141372],[757613],[757613],[757613],[757613],[757613],[757613],[757613],[792792],[792792],[792792],[792792],[792792],[792792],[792792],[792792],[792792],[792792],[112488],[510000],[510000],[510000],[510000],[510000],[510000],[102000],[102000],[102000],[227000],[227000],[227000],[227000],[40000],[40000],[324000],[324000],[158000],[158000],[158000],[263401],[263401],[263401],[237000],[237000],[237000],[370000],[370000],[370000],[370000],[370000],[370000],[370000],[370000],[370000],[289609],[289609],[289609],[275236],[0],[0],[0],[0],[300294],[300294],[532624],[532624],[528000],[528000],[528000],[528000],[528000],[528000],[154000],[154000],[154000],[154000],[249342],[249342],[249342],[281000],[281000],[281000],[523000],[523000],[447000],[582187],[582187],[582187],[582187],[582187],[582187],[582187],[538000],[538000],[538000],[538000],[822000],[822000],[822000],[822000],[822000],[725000],[725000],[725000],[725000],[478316],[478316],[478316],[478316],[478316],[617000],[617000],[617000],[617000],[617000],[617000],[617000],[223448],[223448],[223448],[223448],[1736883],[1736883],[1736883],[1736883],[1736883],[1736883],[1736883],[1736883],[1736883],[256813],[256813],[256813],[256813],[746128],[746128],[746128],[746128],[746128],[746128],[746128],[746128],[287736],[632175],[202576],[202576],[202576],[619000],[619000],[522000],[522000],[522000],[522000],[164059],[164059],[105533],[91349],[91349],[135500],[135500],[135500],[135500],[111478],[111478],[346400],[346400],[346400],[62768],[52827],[52827],[344915],[344915],[344915],[293000],[293000],[383059],[383059],[651146],[651146],[320897],[320897],[320897],[825418],[825418],[825418],[825418],[825418],[424065],[544892],[544892],[544892],[736613],[736613],[447488],[447488],[447488],[447488],[131000],[266922],[713580],[713580],[713580],[713580],[713580],[713580],[713580],[713580],[97615],[680784],[680784],[680784],[680784],[680784],[680784],[94969],[94969],[118187],[118187],[645540],[645540],[645540],[645540],[645540],[645540],[645540],[645540],[645540],[645540],[210178],[210178],[210178],[0],[0],[506000],[506000],[506000],[506000],[506000],[506000],[506000],[1136032],[1136032],[1136032],[800055],[800055],[800055],[800055],[800055],[800055],[800055],[0],[0],[0],[0],[0],[0],[0],[66268],[66268],[214000],[214000],[214000],[214000],[214000],[320500],[320500],[320500],[104261],[104261],[459417],[459417],[459417],[459417],[459417],[459417],[459417],[459417],[0],[0],[0],[0],[88856],[88856],[136400],[136400],[43325],[43325],[66552],[66552],[66552],[53087],[53087],[70173],[70173],[411000],[411000],[411000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[512000],[116336],[116336],[510432],[510432],[198699],[198699],[198699],[198699],[198699],[130946],[130946],[76739],[76739],[136895],[74573],[74573],[74573],[74573],[74573],[102980],[102980],[181579],[181579],[181579],[269133],[269133],[269133],[269133],[229290],[229290],[229290],[229290],[117914],[157288],[157288],[157288],[238283],[238283],[238283],[238283],[238283],[199608],[199608],[199608],[199608],[123268],[123268],[130810],[103711],[103711],[103711],[126826],[126826],[126826],[235837],[235837],[235837],[0],[0],[150000],[150000],[150000],[422868],[577749],[151830],[151830],[265320],[265320],[265320],[333983],[333983],[333983],[194676],[194676],[194676],[87681],[569851],[569851],[569851],[569851],[569851],[744000],[744000],[744000],[744000],[744000],[744000],[653397],[653397],[653397],[653397],[653397],[653397],[653397],[464339],[464339],[464339],[464339],[464339],[464339],[578228],[578228],[578228],[702974],[702974],[702974],[702974],[316793],[316793],[95643],[377033],[377033],[377033],[256846],[256846],[256846],[256846],[563435],[563435],[563435],[563435],[563435],[563435],[563435],[563435],[563435],[224342],[224342],[224342],[224342],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[560000],[354000],[354000],[354000],[354000],[354000],[602000],[602000],[602000],[602000],[602000],[602000],[378000],[378000],[823052],[823052],[823052],[823052],[823052],[823052],[229101],[229101],[331502],[331502],[331502],[331502],[331502],[331502],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[869844],[263731],[263731],[152000],[152000],[152000],[851085],[851085],[851085],[851085],[851085],[851085],[851085],[851085],[330000],[330000],[330000],[330000],[546000],[69708],[69708],[223172],[223172],[223172],[215473],[215473],[215473],[215473],[215473],[231050],[231050],[231050],[231050],[152512],[152512],[152512],[152512],[222004],[222004],[222004],[71141],[101236],[101236],[13945],[259438],[259438],[280563],[280563],[280563],[280563],[280563],[280563],[132825],[132825],[132825],[132825],[475681],[475681],[475681],[475681],[475681],[280887],[280887],[280887],[280887],[106313],[106313],[106313],[106313],[72653],[72653],[128540],[128540],[128540],[128540],[233372],[162694],[162694],[337512],[337512],[231755],[231755],[166114],[71996],[71996],[71996],[71996],[71996],[71996],[71996],[71996],[66783],[66783],[240969],[240969],[240969],[240969],[470708],[470708],[470708],[309329],[309329],[285011],[285011],[288322],[288322],[288322],[288322],[227620],[227620],[227620],[227620],[227620],[139629],[139629],[82327],[82327],[130781],[130781],[179541],[179541],[179541],[121411],[121411],[121411],[121411],[391200],[391200],[391200],[391200],[391200],[225086],[225086],[66952],[459108],[459108],[459108],[485339],[485339],[485339],[477660],[477660],[477660],[347734],[347734],[347734],[347734],[678896],[678896],[678896],[436583],[436583],[964702],[964702],[964702],[166658],[158587],[158587],[832000],[832000],[832000],[832000],[261760],[261760],[224473],[224473],[224473],[224473],[224473],[224473],[98259],[98259],[98259],[98259],[98259],[98259],[98259],[261536],[261536],[261536],[261536],[261536],[267892],[267892],[267892],[267892],[264195],[264195],[212382],[231448],[231448],[136300],[136300],[233300],[233300],[233300],[402085],[402085],[402085],[402085],[173380],[173380],[173380],[173380],[1351701],[1351701],[1351701],[1351701],[1351701],[1351701],[1351701],[1351701],[527485],[527485],[527485],[527485],[527485],[1174601],[1174601],[1174601],[1174601],[1174601],[1174601],[579358],[579358],[579358],[579358],[579358],[579358],[673000],[673000],[228427],[228427],[53766],[499588],[499588],[387212],[387212],[387212],[325793],[325793],[325793],[405700],[405700],[405700],[405700],[301902],[301902],[301902],[327029],[327029],[327029],[214693],[214693],[381693],[381693],[381693],[247010],[247010],[191704],[191704],[191704],[185459],[185459],[185459],[119002],[119002],[258860],[258860],[188677],[188677],[188677],[250247],[250247],[250247],[250321],[250321],[250321],[222725],[222725],[222725],[367901],[367901],[367901],[367901],[367901],[367901],[282289],[282289],[282289],[282289],[282289],[213327],[213327],[213327],[213327],[298255],[298255],[298255],[298255],[298255],[298255],[298255],[298255],[0],[0],[333092],[333092],[333092],[333092],[463222],[463222],[463222],[463222],[328699],[328699],[331053],[331053],[331053],[331053],[387500],[387500],[387500],[387500],[112257],[112257],[300625],[300625],[300625],[300625],[342991],[342991],[342991],[342991],[264274],[264274],[264274],[223251],[223251],[364547],[364547],[364547],[364547],[143233],[143233],[143233],[143233],[302688],[302688],[302688],[287204],[287204],[0],[0],[0],[345521],[345521],[0],[0],[0],[0],[0],[0],[155158],[300163],[300163],[253000],[253000],[193449],[412586],[412586],[412586],[412586],[412586],[269000],[269000],[269000],[507056],[507056],[566522],[566522],[746312],[746312],[746312],[746312],[746312],[378413],[378413],[218339],[218339],[218339],[218339],[211639],[211639],[211639]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"TOTAL_TONS","type":"\"integer\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: grouping expressions sequence is empty, and 'smry_bmm.`Q`' is not an aggregate function. Wrap '(count(smry_bmm.`Q`) AS `count(Q)`)' in windowing function(s) or wrap 'smry_bmm.`Q`' in first() (or first_value) if you don't care which value you get.;;\nAggregate [Q#889, count(Q#889) AS count(Q)#1159L]\n+- SubqueryAlias smry_bmm\n   +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_LOC, true) AS BLAST_LOC#883, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM1, true) AS GEO_DOM1#884, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM2, true) AS GEO_DOM2#885, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RQD AS RQD#886, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).FRACS_FREQ AS FRACS_FREQ#887, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).IS_50 AS IS_50#888, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).Q AS Q#889, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LEVEL, true) AS LEVEL#890, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).PEN_RATE AS PEN_RATE#891, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_DATE, true) AS BLAST_DATE#892, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).ROCK_TYPE, true) AS ROCK_TYPE#893, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).MATERIAL, true) AS MATERIAL#894, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HG_MG AS HG_MG#895, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LG AS LG#896, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).NAG AS NAG#897, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).TOTAL_TONS AS TOTAL_TONS#898, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_TYPE, true) AS BLAST_TYPE#899, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).DH_DELAY AS DH_DELAY#900, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HS_DELAY AS HS_DELAY#901, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RS_DELAY AS RS_DELAY#902, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HOLE_DIA AS HOLE_DIA#903, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BENCH_HEIGHT AS BENCH_HEIGHT#904, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BURDEN AS BURDEN#905, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).SPACING AS SPACING#906, ... 17 more fields]\n      +- ExternalRDD [obj#882]\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: grouping expressions sequence is empty, and 'smry_bmm.`Q`' is not an aggregate function. Wrap '(count(smry_bmm.`Q`) AS `count(Q)`)' in windowing function(s) or wrap 'smry_bmm.`Q`' in first() (or first_value) if you don't care which value you get.;;\nAggregate [Q#889, count(Q#889) AS count(Q)#1159L]\n+- SubqueryAlias smry_bmm\n   +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_LOC, true) AS BLAST_LOC#883, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM1, true) AS GEO_DOM1#884, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM2, true) AS GEO_DOM2#885, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RQD AS RQD#886, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).FRACS_FREQ AS FRACS_FREQ#887, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).IS_50 AS IS_50#888, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).Q AS Q#889, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LEVEL, true) AS LEVEL#890, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).PEN_RATE AS PEN_RATE#891, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_DATE, true) AS BLAST_DATE#892, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).ROCK_TYPE, true) AS ROCK_TYPE#893, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).MATERIAL, true) AS MATERIAL#894, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HG_MG AS HG_MG#895, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LG AS LG#896, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).NAG AS NAG#897, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).TOTAL_TONS AS TOTAL_TONS#898, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_TYPE, true) AS BLAST_TYPE#899, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).DH_DELAY AS DH_DELAY#900, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HS_DELAY AS HS_DELAY#901, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RS_DELAY AS RS_DELAY#902, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HOLE_DIA AS HOLE_DIA#903, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BENCH_HEIGHT AS BENCH_HEIGHT#904, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BURDEN AS BURDEN#905, assertnotnull(input[0, line51d14b79d7904f5191567da34ad856de39.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).SPACING AS SPACING#906, ... 17 more fields]\n      +- ExternalRDD [obj#882]\n\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:40)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:57)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$class$$anonfun$$checkValidAggregateExpression$1(CheckAnalysis.scala:243)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$11.apply(CheckAnalysis.scala:278)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:278)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:128)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:57)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:56)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:56)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:56)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:699)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:160)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:155)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:193)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758785330,"submitTime":1493758757431,"finishTime":1493758785585,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"boxPlot","width":"455.181818","height":"484.181818","xColumns":[],"yColumns":["TOTAL_TONS"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"histogram":[{"key":"bins","value":"20"}],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":0.3}],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a5809a71-a968-4239-842a-b2e414bf0910"},{"version":"CommandV1","origId":2109564766429465,"guid":"3654a4a8-13f4-4fbb-a4fe-85e486a1c033","subtype":"command","commandType":"auto","position":6.999755852390081,"command":"%md\nMedian tonnage is around 320,00o T, with 75% of data occuring within 200,000 to 600,000 T.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757474,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d65a2136-2539-4670-bc0b-328e08c22164"},{"version":"CommandV1","origId":2109564766429466,"guid":"c66197dd-b2c4-451e-b1b8-e9934f3c2e32","subtype":"command","commandType":"auto","position":6.999755855184048,"command":"%sql --See distribution of IS_50 values\nSELECT is_50\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[8.7],[8.7],[8.7],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[10.6],[10.6],[10.6],[10.6],[10.6],[10.6],[10.6],[10.6],[10.6],[12.5],[12.5],[12.5],[12.5],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[12.5],[10.6],[10.6],[10.6],[9.8],[9.8],[9.8],[9.8],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[12.5],[9.8],[9.8],[9.8],[9.8],[8.7],[8.7],[8.7],[8.7],[12.5],[12.5],[12.5],[12.5],[9.3],[9.3],[9.3],[9.0],[9.0],[9.0],[9.0],[9.0],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[8.7],[8.7],[8.7],[8.7],[8.7],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.0],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[10.2],[10.2],[9.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[12.7],[7.7],[7.7],[7.7],[7.7],[7.7],[7.7],[0.0],[0.0],[0.0],[7.7],[7.7],[7.7],[7.7],[0.0],[0.0],[8.8],[8.8],[7.7],[7.7],[7.7],[8.2],[8.2],[8.2],[0.0],[0.0],[0.0],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[9.0],[9.0],[9.0],[9.0],[9.7],[9.7],[9.7],[9.7],[10.3],[10.3],[12.2],[12.2],[11.7],[11.7],[11.7],[11.7],[11.7],[11.7],[8.3],[8.3],[8.3],[8.3],[11.7],[11.7],[11.7],[11.7],[11.7],[11.7],[8.0],[8.0],[11.7],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[10.5],[8.3],[8.3],[8.3],[8.3],[8.2],[8.2],[8.2],[8.2],[8.2],[8.3],[8.3],[8.3],[8.3],[8.2],[8.2],[8.2],[8.2],[8.2],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[8.3],[12.2],[12.2],[12.2],[12.2],[8.2],[8.2],[8.2],[8.2],[8.2],[8.2],[8.2],[8.2],[9.7],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.7],[11.7],[12.7],[12.7],[12.7],[13.2],[13.2],[13.2],[13.2],[14.3],[14.3],[8.0],[8.0],[8.0],[11.0],[13.8],[13.8],[13.8],[13.8],[13.8],[13.8],[13.8],[14.3],[14.3],[13.8],[13.8],[13.8],[13.8],[13.8],[9.5],[9.5],[9.5],[9.5],[9.5],[10.9],[8.0],[8.0],[8.0],[10.9],[10.9],[8.0],[8.0],[8.0],[8.0],[13.8],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[13.8],[13.8],[13.8],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[9.5],[9.5],[9.5],[9.5],[9.5],[9.5],[9.5],[14.7],[14.7],[9.4],[9.4],[9.4],[9.4],[9.4],[11.0],[11.0],[11.0],[11.0],[11.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[8.0],[10.8],[10.8],[10.8],[10.8],[13.8],[13.8],[14.7],[14.7],[12.3],[12.3],[12.3],[12.3],[12.3],[12.3],[12.3],[12.5],[12.5],[5.5],[5.5],[5.5],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[9.0],[9.0],[4.8],[4.8],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[10.7],[10.7],[10.8],[10.7],[10.7],[10.7],[10.7],[10.7],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[7.0],[7.0],[7.0],[7.0],[11.8],[11.8],[11.8],[11.8],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[10.7],[10.7],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[10.7],[10.7],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[10.8],[11.3],[11.3],[11.3],[11.3],[11.3],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[9.4],[9.4],[9.4],[9.4],[9.4],[9.4],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[11.8],[7.0],[7.0],[10.8],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[7.0],[11.8],[11.8],[11.8],[11.8],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[6.3],[5.5],[5.5],[5.5],[5.5],[5.5],[4.5],[4.5],[4.5],[4.5],[4.5],[4.5],[6.3],[6.3],[4.8],[4.8],[4.8],[4.8],[4.8],[4.8],[11.0],[11.0],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[7.9],[10.0],[10.0],[9.0],[9.0],[9.0],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[6.8],[9.0],[11.0],[11.0],[6.8],[6.8],[6.8],[9.0],[9.0],[9.0],[9.0],[9.0],[13.8],[13.8],[13.8],[13.8],[9.0],[9.0],[9.0],[9.0],[11.4],[11.4],[11.4],[11.0],[10.0],[10.0],[11.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[6.8],[6.8],[6.8],[6.8],[6.8],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[11.0],[11.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[13.8],[13.8],[13.8],[9.0],[9.0],[11.0],[11.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[10.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[13.8],[13.8],[13.8],[11.4],[11.4],[11.4],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[13.8],[13.8],[13.8],[13.8],[13.8],[7.1],[9.3],[9.3],[5.2],[5.2],[5.2],[5.2],[11.0],[11.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.5],[9.5],[9.5],[9.5],[9.5],[9.5],[9.5],[5.2],[5.2],[5.2],[5.2],[5.2],[7.3],[7.3],[7.3],[7.3],[4.5],[4.5],[10.0],[8.7],[8.7],[8.7],[8.7],[8.7],[8.7],[8.7],[9.3],[9.3],[9.3],[9.3],[8.7],[8.7],[8.7],[8.7],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[10.0],[10.0],[10.0],[10.0],[10.0],[7.5],[7.5],[7.5],[7.5],[7.5],[7.5],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[5.0],[12.3],[12.3],[12.7],[12.7],[12.7],[12.7],[12.7],[12.7],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[8.7],[8.7],[8.7],[8.7],[8.7],[8.7],[14.0],[14.0],[14.0],[14.0],[14.0],[14.0],[14.0],[14.0],[14.0],[12.7],[12.7],[12.7],[12.7],[12.7],[12.7],[12.7],[12.7],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[11.3],[9.3],[9.3],[9.3],[9.3],[9.3],[9.3],[10.0],[10.0],[10.0],[10.0],[7.9],[7.9],[7.3],[7.3],[7.3],[7.3],[8.7],[8.7],[8.7],[8.7],[7.3],[7.3],[7.3],[11.5],[11.5],[8.0],[8.0],[8.0],[8.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[9.0],[7.3],[7.3],[11.2],[11.2],[11.2],[13.3],[13.3],[11.2],[11.2],[11.2],[11.2],[11.2],[11.2],[11.5],[10.2],[10.2],[9.0],[9.0],[11.5],[9.0],[9.0],[9.0],[9.0],[9.0],[11.1],[11.1],[11.1],[8.8],[8.8],[8.8],[8.8],[11.1],[11.1],[11.1],[11.1],[11.1],[11.0],[11.0],[11.0],[11.0],[11.0],[11.0],[11.2],[11.2],[11.2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"is_50","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"java.lang.IllegalArgumentException: requirement failed: Histogram supports only a single value","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758785591,"submitTime":1493758757516,"finishTime":1493758785788,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"626.181818","height":"383.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"Distribution of is_50 values","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e94fa394-6203-4267-ab3f-996403b0b877"},{"version":"CommandV1","origId":2109564766429467,"guid":"94cc8973-0ab5-4980-bdf8-4a751eecd363","subtype":"command","commandType":"auto","position":6.999755856581032,"command":"%sql\n-- What Blast Types are there?\nSELECT DISTINCT Blast_Type, COUNT(*)\nFROM smry_bmm\nGROUP BY BLAST_TYPE","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Trim",109],["Toe/Boulder",2],["Production",1419]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Blast_Type","type":"\"string\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758785794,"submitTime":1493758757558,"finishTime":1493758786624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"459.181818","height":"397.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb0866d0-db32-4a0f-b40b-725a38ae607b"},{"version":"CommandV1","origId":2109564766429468,"guid":"beafba5a-9c1c-4256-bc12-fe40246b6ffb","subtype":"command","commandType":"auto","position":6.999755857978016,"command":"%md\nMajority of blast types are for production","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757595,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c2a12318-0e2f-4692-a8be-73605d5ad4df"},{"version":"CommandV1","origId":2109564766429469,"guid":"232e80d2-cc37-4361-94ea-cf8182881bc4","subtype":"command","commandType":"auto","position":6.999755858327262,"command":"%sql\n-- What is the most prominant HS_delay used in the blasting process?\nSELECT DISTINCT HS_DELAY, COUNT(*)\nFROM smry_bmm\nGROUP BY HS_DELAY","commandVersion":0,"state":"finished","results":{"type":"table","data":[[72,4],[55,6],[25,250],[42,1215],[0,55]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"HS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758786629,"submitTime":1493758757635,"finishTime":1493758787353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"455.181818","height":"335.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c77fd20-a6cc-455a-8f41-567b389cce76"},{"version":"CommandV1","origId":2109564766429470,"guid":"b44e22a4-c5ba-44bb-8a6b-74dc6144e0f9","subtype":"command","commandType":"auto","position":6.999755858501885,"command":"%md\nA blasting delay of 42 ms was most used. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757669,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4bfb81d7-9c40-4ce4-b370-4f732454769d"},{"version":"CommandV1","origId":2109564766429471,"guid":"756d0d11-1484-4879-a387-730af7e5353d","subtype":"command","commandType":"auto","position":6.999755858589197,"command":"%sql\n-- What is the most prominant RS_delay used in the blasting process?\nSELECT DISTINCT RS_DELAY, COUNT(*)\nFROM smry_bmm\nGROUP BY RS_DELAY","commandVersion":0,"state":"finished","results":{"type":"table","data":[[65,26],[115,6],[500,3],[57,8],[107,16],[100,1282],[87,44],[82,66],[90,13],[0,66]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"RS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758787356,"submitTime":1493758757709,"finishTime":1493758788018,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"464.181818","height":"336.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b6f54bc-bf2e-4291-8732-0a38d96f8701"},{"version":"CommandV1","origId":2109564766429472,"guid":"45065ba5-653a-4909-9acf-0d1d9fa9de22","subtype":"command","commandType":"auto","position":6.999755858632852,"command":"%md\nThe most common blasting dleay was 100 ms. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757743,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b87f98ba-85cf-4e85-9105-566e3eadb8d3"},{"version":"CommandV1","origId":2109564766429473,"guid":"17f46513-1c94-4e36-9699-d0ff02f59d9a","subtype":"command","commandType":"auto","position":6.99975585865468,"command":"%sql\n-- Lets visualize the hole diameter distributions\nSELECT DISTINCT HOLE_DIA, COUNT(*)\nFROM smry_bmm\nGROUP BY HOLE_DIA","commandVersion":0,"state":"finished","results":{"type":"table","data":[[165,115],[229,2],[216,1358],[203,55]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"HOLE_DIA","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758788022,"submitTime":1493758757797,"finishTime":1493758788775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"463.181818","height":"337.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8fc2ef07-f2fc-4e27-a7fd-135a44fb4f52"},{"version":"CommandV1","origId":2109564766429474,"guid":"0d5f9b8e-ea29-49e9-b148-e9eb6a3fd3b7","subtype":"command","commandType":"auto","position":6.999755858665594,"command":"%md\nThe greatest proportion of hole diameter was 216 mm. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757831,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80337e78-2788-403d-a588-966f0b88765b"},{"version":"CommandV1","origId":2109564766429475,"guid":"eb055ec4-9070-423a-9e66-601925da58ab","subtype":"command","commandType":"auto","position":6.999755858671051,"command":"%sql\n-- What is the most common burden? \nSELECT DISTINCT BURDEN, COUNT(*)\nFROM smry_bmm\nGROUP BY BURDEN","commandVersion":0,"state":"finished","results":{"type":"table","data":[[6,1182],[5,6],[7,2],[0,340]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BURDEN","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758788778,"submitTime":1493758757881,"finishTime":1493758789442,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a17e97e-c113-4c56-a61e-dce0419423d9"},{"version":"CommandV1","origId":2109564766429476,"guid":"ea0e94d8-9200-4658-9e8f-f1c870ace4d0","subtype":"command","commandType":"auto","position":6.99975585867378,"command":"%md\nBurden of 6 m was used in almost all cases. Values of 0 are likely erroneous and should be removed.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757917,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93f35e64-a4e3-4c17-ac3f-10aca552ec57"},{"version":"CommandV1","origId":2109564766429477,"guid":"a9674005-75ae-444d-bef3-6684f293c979","subtype":"command","commandType":"auto","position":6.999755858675144,"command":"%sql\n-- What is the most common bencht height? \nSELECT DISTINCT BENCH_HEIGHT, COUNT(*)\nFROM smry_bmm\nGROUP BY BENCH_HEIGHT","commandVersion":0,"state":"finished","results":{"type":"table","data":[[12,1474],[13,2],[6,27],[16,4],[8,3],[10,17],[11,3]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BENCH_HEIGHT","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758789446,"submitTime":1493758757958,"finishTime":1493758790106,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9670cb73-2856-47e5-a075-9adc74b80215"},{"version":"CommandV1","origId":2109564766429478,"guid":"0ffd87dd-4e2e-46b5-b4fd-17274bdb62e9","subtype":"command","commandType":"auto","position":6.999755858675826,"command":"%md\nAlmost all bench heights were 12 m.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758757993,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8238c6ce-c9e3-4e7c-a7fd-59075a351a1b"},{"version":"CommandV1","origId":2109564766429479,"guid":"00db04be-97f1-4951-b876-297eac9e7ffb","subtype":"command","commandType":"auto","position":6.999755858676167,"command":"%sql\n-- What is the most common spacing? \nSELECT DISTINCT SPACING, COUNT(*)\nFROM smry_bmm\nGROUP BY SPACING","commandVersion":0,"state":"finished","results":{"type":"table","data":[[6,10],[4,4],[8,2],[7,1342],[0,172]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"SPACING","type":"\"integer\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758790110,"submitTime":1493758758042,"finishTime":1493758790791,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"631.181818","height":"252.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dbe3263e-d6c6-4922-b078-c6a274070659"},{"version":"CommandV1","origId":2109564766429480,"guid":"644dac23-c44a-4701-869f-c734c6920203","subtype":"command","commandType":"auto","position":6.9997558586763375,"command":"%md\nMost common stemming height was 7 m.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758078,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a518324f-8d12-43bc-b6cb-188242f03f4b"},{"version":"CommandV1","origId":2109564766429481,"guid":"ba50e971-0455-4f64-b126-8f641f87f029","subtype":"command","commandType":"auto","position":6.999755858676423,"command":"%sql\n-- What is the most common stemming? \nSELECT DISTINCT STEMMING, COUNT(*)\nFROM smry_bmm\nGROUP BY STEMMING","commandVersion":0,"state":"finished","results":{"type":"table","data":[[3.5,5],[4.5,1241],[2.5,2],[1.0,4],[4.0,63],[3.0,11],[1.5,3],[5.0,201]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"STEMMING","type":"\"double\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758790796,"submitTime":1493758758132,"finishTime":1493758791556,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"557.181818","height":"224.181818","xColumns":["STEMMING"],"yColumns":["count(1)"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e01baf6f-c8ad-4a68-8d16-5fc61b44c429"},{"version":"CommandV1","origId":2109564766429482,"guid":"8a01bc0e-45f1-44d5-9a01-0ae39ef00798","subtype":"command","commandType":"auto","position":6.999755858676465,"command":"%md\nMost common stemming was 4.5 m, followed by 5 m and 4 m. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758166,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c017f080-02af-47bd-88ae-75dc81186f67"},{"version":"CommandV1","origId":2109564766429483,"guid":"fce10500-b0e1-4e59-89cc-280e09c5cc05","subtype":"command","commandType":"auto","position":6.999755858676487,"command":"%sql\n-- What is the most common explosive? \nSELECT DISTINCT EXPLOSIVE, COUNT(*)\nFROM smry_bmm\nGROUP BY EXPLOSIVE","commandVersion":0,"state":"finished","results":{"type":"table","data":[["NA",7],["Fortis Extra-1.05",1465],["Centra Control 100",58]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EXPLOSIVE","type":"\"string\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758791561,"submitTime":1493758758213,"finishTime":1493758792509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"496a42a5-39c9-4e43-a545-85cd404d7e19"},{"version":"CommandV1","origId":2109564766429484,"guid":"d647b2c3-b207-422c-ad7d-8e8555784f49","subtype":"command","commandType":"auto","position":6.999755858676497,"command":"%md\nAlmost all explosive used was th Fortis Extra 1.05","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758249,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84beb79a-31ea-40f6-a064-42676fd26798"},{"version":"CommandV1","origId":2109564766429485,"guid":"fa8b507e-0818-4c5d-9ae0-fd2731000b2f","subtype":"command","commandType":"auto","position":6.999755858676503,"command":"%sql\n-- What types of blast patterns were used? \nSELECT DISTINCT BLAST_PATTERN, COUNT(*)\nFROM smry_bmm\nGROUP BY BLAST_PATTERN","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Staggered",1523],["Square",4],["staggered",3]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_PATTERN","type":"\"string\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758792514,"submitTime":1493758758289,"finishTime":1493758793248,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa6d2b5d-1a36-40a8-a70f-22ca6842f1ea"},{"version":"CommandV1","origId":2109564766429486,"guid":"99e84b7b-f941-4b37-a675-5577014ed8a6","subtype":"command","commandType":"auto","position":6.999755858676505,"command":"%md\nAlmost all th blast patterns were staggered. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758324,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"732296a5-1344-49d1-a001-0659413239ce"},{"version":"CommandV1","origId":2109564766429487,"guid":"9f0a04fe-1bff-4d92-8969-1c49cec0166a","subtype":"command","commandType":"auto","position":6.999755858676506,"command":"%sql\n-- What is the most common hole depth? \nSELECT DISTINCT HOLE_DEPTH, COUNT(*)\nFROM smry_bmm\nGROUP BY HOLE_DEPTH","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0,351],[7.0,11],[7.5,4],[13.7,84],[13.5,145],[14.0,18],[10.0,1],[13.0,913],[12.0,3]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"HOLE_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758793252,"submitTime":1493758758370,"finishTime":1493758793933,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"627.181818","height":"290.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a9a0f9a-596b-42d6-ba5a-c9d28d6699b5"},{"version":"CommandV1","origId":2109564766429488,"guid":"cf5d0b77-224e-4d7f-bc6c-ceb8259cb77c","subtype":"command","commandType":"auto","position":6.999755858676506,"command":"%md\nHole depth ranged from 1 to 8 m, with most holes drilled to 7 m depth.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758404,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18dcae50-8195-4e55-b746-1ffe15f47d0c"},{"version":"CommandV1","origId":2109564766429489,"guid":"ac1bdaac-1383-4c41-a923-ff3244c205ac","subtype":"command","commandType":"auto","position":6.999755858676506,"command":"%sql\n-- What is breakdown of blast initiation types? \nSELECT DISTINCT INITIATION_TYPE, COUNT(*)\nFROM smry_bmm\nGROUP BY INITIATION_TYPE","commandVersion":0,"state":"finished","results":{"type":"table","data":[["NA",1],["V",1281],["Echelon",223],["Centre Lift",25]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"INITIATION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758793940,"submitTime":1493758758442,"finishTime":1493758794588,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"459.181818","height":"338.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e20346c3-23fd-4c35-8b5f-74a8203f98b4"},{"version":"CommandV1","origId":2109564766429490,"guid":"0c8fc8f4-ed55-4ead-a89d-c4d5498df774","subtype":"command","commandType":"auto","position":6.999755858676506,"command":"%md\nMost initiation types were \"V\" followed by \"Echelon\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758477,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"882263a7-3c13-4144-afb6-560dfdfc6e7b"},{"version":"CommandV1","origId":2109564766429491,"guid":"3f2ccb37-3f50-4377-a072-c4291498c300","subtype":"command","commandType":"auto","position":6.999755858676507,"command":"%sql\n-- What is breakdown of confinement? \nSELECT DISTINCT CONFINEMENT, COUNT(*)\nFROM smry_bmm\nGROUP BY CONFINEMENT","commandVersion":0,"state":"finished","results":{"type":"table","data":[["NA",1],["free face",269],["Free Face",262],["Choked",325],["choked",673]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"CONFINEMENT","type":"\"string\"","metadata":"{}"},{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758794592,"submitTime":1493758758515,"finishTime":1493758795207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"86cc443b-4077-4e59-b933-1f1833e4711a"},{"version":"CommandV1","origId":2109564766429492,"guid":"4fa8fcaa-bba4-4a0d-b09c-3b0766f46f09","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%md\nTwo types of confinement are presented. Free face and Choked. The values need to be normalized.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758550,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"50ef214b-36b5-49c9-9d6d-1260bf5286c5"},{"version":"CommandV1","origId":2109564766429493,"guid":"fb7a9c5c-77d1-4ee3-b481-ece464b32b77","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%sql\n-- What is distribution of three d distances? \nSELECT THREED_DIST\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[5.356508844],[4.32437884],[5.450931245],[3.770576537],[3.367295405],[3.471212651],[10.6697479],[5.262258131],[3.910291883],[2.831665688],[4.584303773],[4.989933315],[6.090413865],[4.573019548],[4.980814837],[4.576599014],[4.156921365],[7.051122723],[1.328950035],[3.827031702],[3.304241824],[3.394851486],[4.688046188],[3.562305394],[4.252932702],[2.997664121],[4.259806213],[3.348690307],[3.745790936],[4.362246997],[5.119821669],[4.147212085],[4.547108104],[4.3830922],[4.864496507],[5.286909371],[3.995899868],[4.820827177],[3.269669976],[1.781171677],[6.642979804],[4.925685644],[2.693398225],[3.205021061],[3.885725029],[5.454354041],[2.872540328],[4.144254202],[3.225317243],[2.785084467],[1.689396356],[3.948755357],[3.384239716],[0.642964477],[70.24876289],[55.17227066],[173.6417078],[11.74822395],[5.766563411],[4.407335177],[1.772450246],[4.576212003],[3.772417331],[3.134927644],[2.94092089],[5.490831158],[2.408747572],[3.092542554],[5.764967814],[4.534306702],[6.32672358],[5.874820136],[3.106681585],[8.612817077],[6.061866814],[3.143699057],[2.853667136],[3.86573432],[3.860165287],[2.783870068],[3.02764669],[2.774825119],[3.167033859],[3.883676111],[3.062834932],[6.01966891],[4.489872066],[3.656064576],[4.417436302],[3.499108465],[5.15769689],[3.852598406],[3.732311661],[3.725206125],[3.646752751],[3.247379307],[4.743927855],[5.333461469],[4.70679035],[4.403279158],[7.528388072],[4.167096696],[4.327196204],[4.167226962],[4.119143565],[0.745568682],[4.520917152],[3.547954717],[4.794228558],[4.973622156],[4.238928073],[4.701696281],[4.674357464],[4.17858894],[4.754289871],[3.265286903],[4.886178694],[5.016955455],[3.560844537],[5.309973355],[5.164490808],[4.080802518],[3.857029253],[4.019355698],[4.923834036],[4.347405435],[5.144772532],[5.170727116],[4.382145139],[4.657573963],[4.070791437],[4.681914234],[0.879478971],[1.991264132],[1.767786745],[4.612970643],[4.267619943],[5.800522099],[4.227054138],[3.083392293],[3.09139813],[4.749164303],[2.992526439],[4.759298092],[6.708697675],[3.406494424],[2.626669106],[3.036793442],[3.280622017],[5.687850155],[5.079728225],[5.133408243],[5.197519337],[5.255747813],[3.80631226],[3.309543645],[5.816689229],[3.233724197],[3.42388763],[1.854670696],[3.929883074],[9.124672341],[3.42432439],[3.783751301],[4.04643078],[3.166083551],[4.732495282],[4.298352763],[4.856605517],[1.683265219],[2.126748739],[0.900548133],[3.673485366],[1.001248306],[3.434556812],[7.169650025],[2.17686111],[5.086895078],[4.276116176],[4.356901245],[5.384063854],[2.577733338],[5.440602694],[2.210398267],[5.118323699],[4.907596435],[5.698094261],[6.583891984],[3.744886004],[3.471839482],[3.995800611],[3.085954905],[3.314688182],[6.418469439],[4.031536571],[2.067578303],[2.547261375],[2.499509542],[4.227814228],[4.981221439],[3.454748562],[3.919041372],[3.728796693],[5.075323128],[5.541604246],[5.135137611],[6.792734042],[6.318832329],[4.647715406],[3.527715418],[4.821700052],[16.36490913],[4.007248471],[2.329234158],[5.283491044],[7.005636342],[4.463782873],[5.789001273],[4.223284352],[4.961819101],[4.612636135],[4.328024038],[4.413423963],[4.738083604],[5.27131096],[5.166298809],[4.167156164],[5.974741551],[5.27756988],[5.23500906],[6.343548184],[4.078161774],[5.674521951],[4.673016343],[5.46293784],[5.999264829],[5.267525207],[2.677243753],[4.084991193],[1.540164971],[3.464436929],[4.36486815],[5.930884181],[7.889647459],[4.852995107],[4.13247445],[6.733230549],[5.314964853],[8.702055927],[9.108153984],[5.38941952],[5.495859291],[3.124153387],[2.892074859],[4.61411896],[3.880274403],[5.917210983],[4.615717272],[3.785618415],[5.991115504],[4.085028448],[3.173800959],[2.921728639],[2.047313942],[2.869317406],[3.494839564],[3.078257326],[5.052921123],[3.799242776],[2.007305],[5.493834184],[3.728238851],[5.202174448],[3.661090972],[4.281093923],[2.430962979],[2.668216953],[3.383931494],[4.263035664],[4.323995833],[7.256483952],[4.552724842],[2.699256264],[3.132259423],[1.048847364],[1.59832539],[4.570588276],[5.263281132],[6.062193955],[5.459817262],[5.55207384],[6.254084205],[5.521102853],[6.119862703],[7.670795937],[3.414431882],[3.757302816],[3.89914851],[3.944534565],[3.320743975],[5.931231757],[5.247967916],[4.055227877],[3.440329564],[3.1880421],[1.907496103],[7.063245469],[4.737104402],[6.004415051],[6.288365845],[5.841318889],[6.242982485],[4.789799148],[5.802650553],[3.827607235],[2.862064751],[4.417324429],[3.061775629],[2.899883585],[3.932731615],[4.294874052],[2.670737008],[1.373388476],[2.562730291],[2.671060959],[4.97953723],[5.92297926],[5.785644999],[4.748391459],[4.063626814],[5.938030658],[5.519036402],[6.21966737],[5.708512701],[5.798773223],[10.64959761],[9.021228338],[4.652649396],[3.665715188],[3.003162805],[4.330367902],[4.13332452],[4.388107401],[5.35230058],[3.52227443],[6.359613986],[4.509921539],[12.21839322],[4.32094047],[20.60868463],[6.292111263],[5.442186006],[6.146256613],[5.484453996],[5.290131585],[5.932067395],[1.913049338],[6.655963361],[5.7199383],[6.34249724],[4.342240021],[4.965789173],[5.311859359],[6.440823219],[3.766880595],[3.957061908],[5.15830597],[1.961360256],[4.221237983],[5.170027301],[4.497140653],[5.15091761],[4.338432786],[5.222320601],[6.247955452],[6.713568084],[6.218342762],[5.487610745],[4.432319251],[4.65092524],[5.623175758],[4.838210417],[4.342644416],[3.924584648],[4.299590919],[7.336300006],[5.646086543],[4.842740534],[4.74547349],[2.70399839],[4.176690648],[5.107754901],[2.274027218],[3.480853751],[4.132758257],[4.558450665],[4.125609839],[1.106720474],[4.611483333],[5.767531219],[4.29798456],[1.079787834],[2.204760996],[6.716271714],[3.330490137],[5.10834714],[5.215962743],[4.425628212],[3.969596387],[5.49067386],[3.164750229],[4.786380753],[2.987875294],[3.719459609],[4.454688705],[3.936806716],[3.076555184],[4.398496783],[5.413789693],[2.97565208],[2.554022706],[5.105248299],[4.652467],[4.625658319],[5.200143769],[5.926920165],[4.734975504],[6.491530009],[4.904449872],[4.457682635],[2.211343068],[3.425093279],[5.494325058],[2.397368168],[3.653199515],[3.653108741],[5.365193871],[3.153475019],[3.139938418],[4.872991918],[2.185789221],[3.164451678],[4.149359088],[3.384840371],[4.550061711],[4.85349833],[4.196939145],[4.073720653],[3.80125015],[3.030689947],[6.79798952],[4.882613564],[3.734331082],[3.500298634],[4.081532363],[5.111219908],[4.107980247],[5.404130373],[3.249006168],[4.184186251],[8.293402266],[6.605596192],[5.671406513],[4.697031308],[7.518126119],[7.531267778],[2.219374514],[3.342403931],[3.120712741],[3.333294594],[3.809357132],[4.203099737],[4.623473031],[4.902685378],[6.081517265],[4.618480187],[3.234849214],[8.47433315],[7.818202664],[3.559597871],[4.551194564],[3.538218007],[3.378940296],[2.988233573],[2.281634048],[4.067227615],[3.46416591],[4.066494279],[5.75366823],[2.12539553],[3.142400562],[8.284004951],[8.49450813],[7.442098672],[4.029180697],[4.852474346],[1.384138426],[3.352768437],[5.111269202],[7.360630235],[3.115510367],[5.193973357],[3.0777977],[4.648906954],[6.789857227],[3.571812755],[2.62503758],[4.115295878],[3.496276267],[4.647440749],[4.008947336],[3.681695566],[4.261711715],[3.846189898],[2.753870161],[3.676596659],[3.709713742],[3.220499711],[4.968383572],[2.989829177],[3.571721743],[2.98322578],[3.154392517],[4.585893331],[3.942941495],[4.760262927],[5.345163426],[5.652291128],[4.30401064],[4.740133251],[5.177592607],[6.215929875],[5.09433689],[6.003511729],[6.9558253],[6.643982569],[5.234146378],[4.362397489],[3.596578151],[3.441294313],[3.695093018],[2.686320624],[4.353721546],[4.573613517],[3.778846942],[4.135663829],[4.755687295],[3.021528257],[4.2876121],[5.05648642],[5.17882856],[5.579571716],[3.799192921],[5.132849403],[5.030564686],[3.799192921],[3.967675665],[5.132849403],[5.17882856],[3.967675665],[5.030564686],[4.910793237],[5.05648642],[5.579571716],[4.910793237],[4.887548325],[4.280906738],[3.75159976],[2.911462254],[5.532736636],[4.300277437],[3.709019722],[6.770207231],[5.41242244],[2.674078535],[3.744331119],[6.00537401],[3.681552672],[6.43577122],[5.245450238],[5.630816481],[4.895644491],[4.879583835],[4.791721922],[2.125262144],[4.796318762],[3.918527848],[10.63168086],[4.370575174],[3.879110142],[45.41503329],[2.074067432],[2.29588944],[4.453064141],[2.29588944],[4.453064141],[4.132402529],[3.328835284],[4.535211051],[4.132402529],[4.53164871],[4.535211051],[2.764963704],[3.328835284],[2.764963704],[4.53164871],[6.777417584],[4.573640787],[2.892026869],[4.008071823],[4.499172993],[4.070198626],[3.504830164],[4.400772329],[3.825652156],[2.59313622],[5.084495666],[2.992398826],[4.301980281],[3.852381655],[4.320319085],[4.691198672],[3.739573503],[3.794987396],[2.223214302],[3.979987322],[4.220054483],[4.907773073],[6.436129227],[4.611328122],[5.379722045],[4.833033221],[3.509930309],[5.283804113],[3.669950165],[4.706245915],[6.192134018],[5.014716907],[4.369916284],[4.027980326],[4.334759693],[4.746213532],[4.116884134],[4.696124746],[4.209417939],[6.556753515],[2.771774048],[3.901685177],[3.420500363],[8.689797323],[3.722767058],[9.668722697],[3.232569936],[1.221733257],[3.232569936],[1.221733257],[9.668722697],[4.119273843],[4.101415694],[4.476072472],[4.972076289],[6.238898192],[3.331693683],[4.204097544],[8.827024852],[5.587597974],[5.007206572],[4.294122894],[4.702816356],[4.466044628],[4.227094471],[3.07306705],[3.698647933],[5.53278194],[3.375995107],[5.367868973],[3.808761888],[4.764371778],[5.01339528],[5.496475826],[3.231329923],[4.404741964],[5.327336094],[5.560628236],[4.077003959],[3.540356883],[2.851177573],[3.903995847],[6.454988687],[5.371637426],[6.29191195],[4.822820993],[5.041357474],[2.925193432],[4.992543308],[5.358557854],[3.577827291],[3.416680425],[5.697923184],[5.231792558],[4.648784463],[7.640169423],[4.88063562],[4.678553139],[3.938758489],[10.64966867],[3.901268246],[5.414953994],[6.933471429],[4.092408739],[4.176113544],[3.196135261],[4.507645096],[4.065625073],[1.696130468],[2.91150089],[4.172813253],[3.580624901],[4.34978063],[3.034013795],[4.365821406],[2.996843535],[3.832832372],[4.78354611],[2.329942014],[10.63755896],[3.198422236],[3.584506624],[3.214440052],[3.037589099],[4.84349708],[11.55097615],[4.834727745],[9.978046862],[5.218172141],[12.44915424],[5.604788258],[3.294438764],[4.2645448],[3.315700701],[4.048006673],[4.507883141],[8.270270305],[3.778236928],[4.044214891],[5.461386041],[4.852724015],[4.770017499],[4.836315829],[7.091593573],[5.626675571],[8.621680324],[4.863498596],[4.803139722],[6.191944817],[2.79884125],[4.785417042],[5.679898595],[3.144954787],[4.901801972],[5.051177096],[6.960854761],[8.414709823],[4.50089895],[6.98451985],[4.24204911],[4.340796188],[5.506295665],[4.462587023],[7.214349983],[8.168579974],[5.744269666],[6.922444656],[7.435348947],[5.812358826],[6.204436393],[4.451643929],[5.624601337],[6.299048722],[1.860578095],[5.209891492],[3.394964965],[3.826961736],[4.55010021],[3.621254498],[10.18269257],[3.829303076],[4.68018708],[7.745407999],[5.987178948],[3.193619531],[3.541421113],[6.144235198],[13.92221716],[3.475159515],[6.251736485],[4.516665517],[3.840672099],[4.139967602],[2.895281574],[5.831939963],[3.870172825],[4.032057673],[5.603603369],[4.282449242],[3.931395907],[5.152378838],[5.601224094],[4.177942341],[5.216626687],[2.127840288],[4.402494749],[4.686534011],[5.216315875],[4.705765355],[9.551997358],[4.668041731],[9.571801216],[8.883081544],[10.04844983],[6.836408869],[7.021992928],[3.633024207],[4.796449814],[4.679839198],[3.432863831],[3.884368286],[3.174069086],[7.214507864],[6.064816434],[4.497471415],[5.435453886],[2.739008077],[5.266803475],[9.8850439],[4.26298056],[5.515301898],[0.185215407],[13.8932153],[8.848467613],[6.336407373],[3.397052138],[3.751588045],[4.227533161],[5.224796109],[4.802306266],[4.109428554],[3.39801162],[4.570016487],[4.650800949],[2.71423228],[3.845218394],[4.551823174],[4.205725478],[5.03887993],[3.280793014],[3.907202842],[5.08520917],[3.443725265],[5.307079108],[3.452446607],[6.348857141],[5.77696657],[3.189166613],[3.449969654],[4.630820785],[4.144545245],[4.38411511],[3.780579658],[4.817479805],[2.574656308],[2.747512855],[2.443650054],[1.559670752],[6.659225433],[5.670289614],[3.320724987],[4.825604922],[3.843161594],[6.07928316],[1.227903523],[4.271007625],[2.799830963],[5.056921497],[3.387590813],[7.473352936],[4.044219311],[3.493794862],[5.663949836],[4.164897752],[3.381405138],[4.959498346],[2.180240793],[30.17546063],[2.592026792],[2.561039868],[3.575012339],[5.625416473],[4.018225024],[3.671406622],[4.942971289],[4.809627501],[4.351833408],[6.947092327],[4.198426013],[6.724565048],[4.011278421],[5.110775787],[3.765798297],[5.120002624],[4.611406098],[4.095988711],[4.57492678],[5.578175276],[5.491296672],[6.599372153],[8.933850977],[5.184622668],[4.213296592],[3.20797095],[3.330570974],[4.834315348],[4.428613642],[5.209920722],[4.846215918],[6.727307962],[6.15205631],[5.556059152],[5.819156541],[4.695020227],[3.373740202],[4.399138356],[3.025630372],[4.784493055],[3.583918565],[2.087959433],[4.891924921],[2.07101022],[4.838163636],[6.017496314],[7.124236157],[6.631882448],[4.499114808],[5.472446458],[8.304613346],[7.024688546],[5.4899875],[6.832525745],[6.426202803],[5.336775062],[6.424107482],[5.113611823],[7.457957904],[7.405212313],[4.60108842],[4.196970469],[5.437707176],[5.89910507],[5.044346939],[2.472072094],[3.452965625],[5.123511199],[3.368724764],[3.878118179],[6.129631493],[5.710649391],[3.385211997],[4.754725856],[6.888117657],[6.510666955],[4.688485659],[3.635104842],[7.631070412],[10.2576759],[2.158943968],[3.846364016],[3.565341961],[3.615985277],[3.867571137],[5.717916516],[8.111937252],[5.618273584],[4.433540896],[3.044559567],[1.436287359],[1.097463314],[6.721233347],[6.166007848],[8.502143502],[9.328018944],[6.547680374],[5.291510717],[7.131525451],[8.898367522],[4.599484305],[6.167631125],[5.186139451],[7.305126048],[6.245939652],[4.151221695]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"THREED_DIST","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758795211,"submitTime":1493758758593,"finishTime":1493758795372,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"boxPlot","width":"458.181818","height":"377.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1ed8cb1-2e69-4fef-89c5-ddd2dfda0829"},{"version":"CommandV1","origId":2109564766429494,"guid":"76aeb946-75e5-430b-8f25-ae9929cee388","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%md\nMost 3d-distance values range between 3.6 to 5.1 m. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758629,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ecc17bc5-0932-4d33-97a3-486af9b18cd0"},{"version":"CommandV1","origId":2109564766429495,"guid":"ba34f6a1-2a0a-49bc-a98f-7af8efc4948d","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%sql\n-- What is distribution of horizontal distances? \nSELECT H_DIST\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[3.383941489],[3.559450099],[2.459278349],[3.582944739],[3.261074209],[3.083808846],[8.512415932],[5.243138373],[3.832769234],[2.417720001],[4.176144154],[4.730634735],[6.021904184],[4.348192843],[4.579355522],[3.990694175],[3.085388954],[5.743156275],[0.95829484],[3.593291527],[2.645430211],[3.224788055],[4.529506485],[2.963467732],[3.964962799],[2.347192578],[3.039217333],[1.856223316],[3.559124049],[4.075057055],[4.080279035],[3.647928179],[4.065560355],[4.189879832],[4.251468099],[4.642208203],[3.681231995],[3.93402148],[2.961906987],[1.728900807],[6.518221306],[4.71712476],[1.921880589],[2.341968403],[1.617643348],[2.710846547],[2.868293221],[3.979079919],[3.089683803],[2.455635559],[1.68367485],[3.677082812],[1.867424162],[0.632408097],[70.08936708],[53.95126135],[173.5611346],[3.371683556],[4.128100047],[3.901049218],[1.747296483],[4.389314297],[3.583707577],[3.134010211],[2.284944857],[4.785777784],[2.408711274],[2.732001647],[2.052120123],[3.515693388],[4.329918244],[5.184833653],[3.066307552],[2.282015118],[5.166354711],[3.133654736],[1.874810924],[3.537681161],[3.705345463],[2.111671376],[2.748825568],[2.77156454],[2.94300017],[2.754923048],[2.655267407],[5.589725307],[3.135015949],[3.199816401],[3.768173696],[2.981852445],[4.695162724],[3.620078452],[2.963087748],[3.409403614],[2.92556063],[2.979122018],[4.438565647],[4.961852074],[4.670949047],[3.938615493],[2.989001339],[3.761742283],[3.605206513],[3.69367527],[4.067321723],[0.716801925],[4.283882935],[3.236739409],[4.252057973],[4.746725714],[3.92347104],[4.365573731],[3.943513154],[3.326897954],[3.825551071],[3.231597283],[4.169509923],[4.512763455],[3.546495876],[4.913308153],[4.853553131],[3.655195344],[2.914485375],[3.835734349],[4.24385167],[3.85240081],[4.699500612],[3.534176283],[4.129495127],[3.235299213],[3.471599199],[3.977170476],[0.477782377],[1.62087538],[1.015198503],[3.587281004],[4.145405408],[5.11460233],[4.030341052],[0.686560267],[2.768087427],[3.812747303],[2.638359528],[2.956549509],[4.352544199],[3.398021189],[2.21358736],[2.788535458],[3.060231527],[5.426509836],[4.411694006],[5.020787388],[5.094175694],[4.723171921],[3.642509162],[3.002399041],[5.310724338],[3.014822051],[3.014753888],[1.84177143],[3.876433025],[2.649209882],[2.842641377],[1.389486596],[3.289255539],[3.111487104],[4.184454684],[3.908828597],[3.508218921],[0.85749519],[1.700308207],[0.521529482],[2.758214096],[0.876707477],[2.597814658],[5.933895179],[2.167350917],[4.25958167],[3.72346183],[3.769513762],[5.088123426],[2.249458824],[5.173695874],[1.825199715],[5.107924529],[4.851771326],[5.039476659],[6.534607104],[3.166452431],[3.196701112],[3.934200046],[2.438236248],[2.686890582],[5.980954856],[3.833855761],[1.986272892],[2.028262804],[2.189701578],[4.227772581],[4.263524364],[3.232923136],[3.334872861],[3.62401559],[4.012635169],[3.778767656],[4.964467041],[6.669167864],[5.949663267],[4.407432019],[1.933370115],[3.3762531],[5.013982948],[3.325501616],[2.32910734],[4.941188723],[5.237185599],[4.284917969],[5.215009588],[3.85398547],[4.157639354],[4.237142079],[4.307046436],[4.248551753],[4.579000437],[4.422377754],[4.37350946],[4.110061435],[5.189884873],[4.357900527],[4.862120628],[6.232840203],[4.029204636],[4.471584171],[4.671319407],[4.832331218],[5.99878021],[4.300039186],[2.398241439],[3.609488191],[1.497964619],[2.9952671],[4.314139659],[5.715384939],[7.727415415],[4.576596661],[4.003379198],[6.393416145],[4.707191307],[8.450593174],[1.880086434],[4.933686857],[5.471687582],[3.117841881],[2.793239875],[4.482029005],[3.440097237],[5.282275741],[4.184461375],[3.048445013],[5.670983336],[3.637436047],[3.054719791],[2.610891993],[1.99780905],[2.727898275],[3.414234321],[2.150752892],[2.907436672],[2.252594948],[1.752824578],[3.574592704],[3.321534134],[4.404661621],[3.31274418],[4.273261635],[2.430696402],[2.566652489],[2.758833993],[4.179112944],[4.154887844],[6.995644931],[4.169023147],[2.46483184],[2.941651237],[1.038510954],[1.572057569],[3.965360513],[4.810306539],[5.768352971],[5.054801381],[4.977890718],[5.847313656],[5.001299231],[5.7376571],[3.767274877],[3.332796279],[3.578415851],[3.621974352],[3.157327984],[2.638166788],[5.801119633],[4.833399321],[4.051360882],[2.648590758],[3.121588378],[1.524477615],[3.687783616],[3.42204924],[3.353746562],[3.820313076],[5.826310324],[2.575518006],[4.653474079],[4.428001016],[3.087962758],[2.498335446],[3.819711507],[2.783054616],[2.773160652],[3.494441443],[4.072622988],[2.558746763],[1.046733968],[2.562592633],[2.540071849],[4.660132724],[5.57228804],[5.653711347],[4.025197262],[3.635360368],[5.220329683],[4.918058255],[5.91794466],[5.533862665],[5.345533557],[3.660549822],[3.549648997],[3.537656993],[3.491297752],[2.940986399],[3.998405808],[3.329001201],[3.872349804],[4.851129353],[3.260020245],[5.991754751],[4.278299896],[4.781373234],[4.150462263],[4.133206624],[5.264041888],[5.125770673],[5.423558242],[5.207430557],[5.017324885],[5.316128008],[0.618055014],[3.479112675],[2.119188524],[3.632523779],[2.818108763],[2.879452899],[4.905114168],[4.816515857],[3.392003685],[3.771392316],[4.862128443],[1.957306312],[3.84510338],[4.99160385],[3.986980938],[4.441315571],[4.104296895],[4.625038054],[6.179953479],[5.831426069],[4.94807892],[5.470771884],[3.598750478],[4.576740434],[4.536165782],[4.28298424],[4.337462853],[3.68604395],[3.871375596],[5.482597285],[4.396609262],[4.65861181],[4.271108522],[2.280506304],[4.081353942],[4.954721486],[2.248578662],[3.32955012],[3.639926373],[4.272676094],[3.960013131],[1.051560745],[4.546864524],[5.759747304],[4.154788202],[0.963419431],[1.980921502],[6.534879953],[3.149029692],[3.864953557],[5.119319095],[3.932680129],[3.831037066],[4.765198947],[2.969367778],[4.261767708],[2.809085617],[3.523760775],[3.846137023],[3.59441706],[2.221373674],[3.720150132],[4.913930504],[2.229924887],[2.107850564],[4.454244268],[4.241064135],[4.18329834],[4.746224289],[5.658190965],[4.47329856],[6.206540502],[4.898570097],[4.351536051],[1.945010283],[2.985923141],[4.629476104],[2.225187632],[3.247129347],[3.332821627],[4.936287877],[3.036175555],[2.849711915],[4.154918651],[2.084090209],[2.564038416],[3.990421782],[3.120166983],[3.492781843],[4.229526688],[3.92658694],[4.016324315],[2.583506532],[2.393054115],[4.590987366],[4.388130923],[3.720426051],[3.27230347],[3.553137347],[4.639522605],[4.080031005],[5.393656737],[3.070586263],[4.091336334],[8.070577737],[6.360657199],[5.125569822],[4.543383981],[6.947628804],[6.816957826],[2.031277923],[3.069255447],[3.056475912],[3.27900061],[3.623989514],[3.181944374],[3.395063033],[4.764314536],[5.423339377],[4.00938524],[3.230827913],[8.250907829],[7.631275778],[3.004663042],[3.848532188],[3.528772307],[2.914269891],[2.090345904],[2.250138885],[3.779730811],[2.588699287],[3.18190446],[5.752362036],[2.060168197],[2.906369729],[4.256028665],[2.619616003],[2.167197268],[3.042950213],[4.427237626],[1.167400959],[3.349068079],[4.517086672],[6.883537753],[2.990608801],[5.161310396],[2.757037721],[4.547365501],[6.314563247],[3.570496464],[2.542195311],[3.823801511],[2.917835156],[3.160149522],[3.142292157],[3.502379905],[3.344771442],[3.300330286],[2.643493332],[3.493998426],[3.404746393],[2.942412955],[4.280345897],[1.981167333],[2.977016124],[2.976766198],[3.01725206],[3.967032266],[3.303422013],[4.723490341],[5.263208622],[1.323948639],[3.749799461],[3.927153804],[5.059459359],[5.572022972],[4.905835301],[5.910199066],[6.618760987],[6.196551703],[4.865157962],[4.031729778],[3.342908016],[3.327611907],[3.66358977],[2.292006326],[4.031283294],[4.023692334],[3.522167656],[4.118082078],[4.417343659],[2.633524065],[4.197207167],[4.331528252],[5.022613264],[5.413128578],[3.630124653],[4.876720209],[3.665501875],[3.630124653],[3.821646242],[4.876720209],[5.022613264],[3.821646242],[3.665501875],[4.494435004],[4.331528252],[5.413128578],[4.494435004],[4.581208683],[3.664389717],[2.973605387],[2.734700166],[4.835527065],[4.010290014],[3.563660197],[6.427872198],[5.341251258],[2.213094892],[3.335880693],[5.737916434],[2.92627972],[4.86536011],[4.832307937],[5.385530243],[4.570879237],[4.538624021],[4.478712538],[2.114012772],[4.754727437],[3.343270554],[9.042474219],[3.588406331],[3.196940569],[45.37102901],[1.756881328],[2.079449928],[4.369348807],[2.079449928],[4.369348807],[3.764964409],[3.053324254],[3.707965075],[3.764964409],[3.887843875],[3.707965075],[2.577003687],[3.053324254],[2.577003687],[3.887843875],[6.513249957],[4.546715958],[2.267820319],[3.404500698],[4.356456473],[3.621918],[2.848573854],[3.823253196],[3.366025698],[2.564421377],[4.145240283],[2.978090664],[4.28871321],[3.669746176],[4.035731656],[3.75710274],[3.644844304],[3.690672567],[1.713681708],[3.285373799],[3.664625629],[3.143621002],[5.991559146],[4.504169846],[4.71504666],[4.347941352],[3.509195349],[5.264679002],[3.529496423],[4.579191632],[6.042509495],[4.461090674],[3.716235864],[3.92661088],[3.926808883],[4.67487433],[3.858440229],[4.52212439],[3.668497785],[3.974274525],[2.705392578],[3.827880092],[3.262659651],[5.450112109],[3.392353903],[5.852935844],[2.94653186],[0.468728066],[2.94653186],[0.468728066],[5.852935844],[3.79603372],[3.338476449],[4.337026285],[4.934870312],[5.755196782],[3.118131652],[3.914707907],[8.771722351],[5.57098555],[4.969396945],[3.550978457],[4.637989435],[3.509092903],[3.783073486],[3.012441535],[3.44011991],[4.169113695],[2.657356769],[4.883919021],[3.758000133],[4.743758004],[4.449223752],[5.496249085],[3.156619077],[4.092549939],[4.869549877],[5.311926581],[3.872190207],[3.274445449],[1.660672454],[3.720585975],[5.331403661],[4.394328731],[5.45257673],[4.178308031],[3.301251278],[2.787436098],[4.170201554],[5.282373141],[3.162930445],[3.168231368],[5.280312964],[5.204095502],[4.576073863],[7.469830052],[4.524549259],[4.508350031],[3.336168011],[4.234170521],[3.724412705],[4.861771385],[6.705736723],[4.021862504],[3.937393173],[3.185037834],[4.495972643],[2.581792013],[0.524832354],[2.781279202],[3.830616791],[3.304504804],[3.365246054],[2.681163367],[3.664316171],[2.959781242],[3.192660489],[4.290678501],[1.750921186],[2.234615851],[2.587111323],[2.935453968],[3.090341891],[2.825508273],[4.391646616],[3.252613718],[4.450100448],[3.371104418],[4.849396354],[2.741389793],[4.595142762],[2.621225858],[3.906733802],[3.314378524],[4.044045128],[4.325537655],[3.498295156],[3.372665563],[3.538413769],[4.640321648],[4.851287664],[4.60140196],[4.64199623],[6.554059811],[5.414155151],[7.349821767],[4.725189732],[3.084272524],[4.847707602],[2.375812282],[4.379184627],[5.670195147],[3.133423208],[4.211860634],[4.092296421],[6.757399278],[8.324649722],[4.159731362],[6.915332675],[4.218387488],[4.107353649],[5.23820055],[4.457354372],[6.93943809],[8.094566078],[5.744234762],[5.924001519],[6.692698858],[5.812228918],[5.76308702],[4.427961382],[4.781385573],[6.026755097],[1.644564988],[4.40790313],[3.393444415],[3.452650142],[4.02561101],[2.666468826],[3.183264048],[3.710704785],[4.596462118],[7.295449884],[5.730126788],[3.129567382],[3.286324695],[6.13771301],[3.359984078],[3.389094422],[6.121698621],[4.145383215],[3.801516803],[3.158564864],[1.972131081],[5.007312353],[3.793510907],[3.656509948],[5.264681187],[4.208097076],[3.863507344],[4.962733218],[4.412456232],[3.850561647],[4.285126019],[1.970870366],[4.002895202],[3.939239775],[4.798848612],[4.211147112],[9.410833014],[4.64741498],[3.405601415],[4.494616335],[4.508217608],[2.620508538],[4.328298164],[3.203855398],[4.632394841],[4.504954078],[2.831117661],[3.503783767],[2.950905902],[6.909700138],[5.829660796],[4.044182241],[5.155405027],[2.73058089],[4.910719397],[9.75247625],[4.004769656],[4.173080996],[0.086162637],[3.300012273],[8.81990958],[6.202745844],[3.200521207],[3.712464545],[4.133953677],[5.037905319],[4.380269969],[3.054670195],[3.389075685],[4.273121224],[4.239910612],[2.473485395],[3.659472366],[3.953389685],[4.204732215],[4.867582254],[3.270026911],[3.239024081],[4.748829329],[3.267538829],[5.291247584],[3.420551125],[4.913626156],[5.674547823],[3.088979119],[2.66828072],[4.289468149],[4.089116897],[4.321770933],[2.918359985],[4.311590194],[2.029366896],[2.746305883],[2.240889109],[1.498706108],[5.615516806],[5.56092834],[3.255304901],[3.90954537],[3.644771598],[5.725120523],[1.112065196],[4.256360535],[2.637116986],[4.88665939],[3.380424233],[7.438657137],[4.036792786],[3.110813398],[5.633906371],[4.109790262],[3.214154944],[4.733018065],[2.175385943],[30.17483887],[2.578164075],[2.289287225],[2.896856572],[5.519544365],[3.933831211],[3.671333818],[4.847139878],[4.760413427],[3.583515732],[6.926617212],[3.924133025],[6.060316988],[3.716547323],[4.943703066],[3.609204483],[4.629583134],[3.903810703],[3.477609812],[4.571074491],[5.480188775],[4.97385424],[6.549874044],[8.156426914],[5.140765118],[4.031887524],[3.191062675],[3.027560073],[4.178672755],[4.131369022],[4.7311971],[4.608007812],[6.548403241],[6.151697327],[4.9782286],[5.366731315],[3.5104259],[3.361407444],[3.770930919],[2.929779002],[4.471186197],[2.675370815],[2.081537893],[4.816740911],[1.525747358],[4.695364736],[5.855088129],[6.949610925],[6.601637145],[3.381692624],[5.144538269],[6.515581325],[7.024144147],[5.468727823],[6.724282266],[5.450308248],[4.156007339],[6.077632763],[4.903324688],[7.441113089],[7.400982435],[4.447701654],[4.041917367],[4.921255632],[5.897926754],[5.036522709],[0.856021028],[3.388096958],[4.970272025],[3.364444828],[3.579087314],[6.12471134],[5.64134071],[3.361220017],[4.305133912],[0.785053501],[5.938377977],[4.627058677],[3.49533017],[6.863232839],[8.336682134],[1.764047902],[2.947855153],[3.430292262],[3.451008693],[3.800674677],[5.652497943],[8.109107041],[5.601848356],[3.618320743],[2.636099012],[1.434139464],[0.732909954],[6.462887281],[6.110956144],[8.479745102],[9.313193491],[6.546113427],[5.082637307],[7.0902342],[4.931593252],[4.370906198],[6.065783543],[5.171766623],[7.176652493],[6.19017843],[4.056928025]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"H_DIST","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758795380,"submitTime":1493758758667,"finishTime":1493758795542,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"boxPlot","width":"468.181818","height":"373.181818","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fca0c20e-a575-4012-9635-3765e333d3af"},{"version":"CommandV1","origId":2109564766429496,"guid":"e0e51ab3-804c-472c-b491-9f92635893fb","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%md\nSimilarly, most horizontal distances range from 3.1 m to 4.1 m","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758702,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ef95b6e-a126-45e6-80ed-e81282f57035"},{"version":"CommandV1","origId":2109564766429497,"guid":"9ef9ac72-612d-45f2-bb3d-a7933098d1b0","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%sql\n-- What is distribution of vertical distances? \nSELECT V_DIST\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[4.15224361],[2.455721349],[4.864627575],[1.174629483],[0.839090785],[1.593562131],[6.432907214],[0.448174779],[0.774766165],[1.474096525],[1.890941851],[1.58761755],[0.910939655],[1.416236839],[1.959086379],[2.240450521],[2.785744107],[4.090780813],[-0.920749258],[1.316976709],[1.979826514],[1.061017724],[-1.208862298],[1.976835532],[1.538345399],[1.864584989],[2.98481272],[2.787142224],[1.167726739],[1.556633826],[3.09255508],[1.972812225],[2.036519362],[1.287013688],[2.363968119],[2.530081756],[1.554267272],[2.786368545],[1.384864164],[-0.428339287],[1.281394427],[1.418137182],[1.887],[2.188],[3.533],[4.733],[-0.156147163],[1.158346185],[0.925486531],[1.313982302],[-0.138921016],[1.439350848],[-2.822375853],[-0.116031538],[4.729620475],[11.543],[5.28916054],[11.254],[-4.026418207],[-2.050955474],[0.297548105],[1.294463713],[1.178207334],[-0.075837539],[1.851497417],[2.691757382],[0.01322376],[1.449132999],[-5.387360847],[2.863535798],[4.612942581],[2.762428573],[0.499227877],[8.305],[3.170963302],[-0.251101096],[2.151394924],[1.558433135],[1.082262003],[1.814049766],[1.269095141],[0.1344784],[1.169980113],[2.737396415],[1.526601723],[2.234140725],[3.214129146],[1.768610524],[2.305343897],[1.83093311],[2.134779662],[1.318160261],[2.269418722],[1.501042195],[2.177131283],[1.292402555],[1.674510821],[1.955974242],[0.579750295],[1.968800484],[6.909594631],[1.792760405],[2.393138732],[1.929389425],[0.651335328],[-0.205104021],[1.444658746],[1.453100365],[2.21464003],[1.485096748],[1.604645196],[1.745770293],[2.509645733],[2.528310806],[2.822840976],[0.467843515],[2.547533951],[2.191987235],[-0.319344358],[2.013757688],[1.764932664],[-1.814523682],[2.526351057],[1.200983858],[2.496770837],[2.014681617],[2.09365193],[-3.774389606],[1.466446732],[3.350497608],[2.12587439],[2.47031089],[0.738381514],[1.156674476],[1.447218703],[2.900157436],[1.013999005],[2.73621995],[1.27449507],[-3.005984536],[-1.376384538],[2.831522484],[1.412187484],[3.729575489],[5.105093877],[-0.24011718],[1.414009049],[1.202574076],[1.182143737],[1.704297623],[2.51805378],[1.069380281],[1.031300762],[2.305326891],[1.104599487],[1.392364585],[2.372779086],[1.169538448],[1.623042052],[0.218360689],[0.645947352],[-8.731628275],[1.909289796],[3.51938928],[2.356777473],[0.585434074],[2.210622219],[1.787986431],[3.358424802],[1.448476371],[1.277502329],[0.734162066],[2.426262503],[0.483613659],[2.246672984],[-4.024024041],[0.203259185],[2.780731114],[2.102617785],[2.184800781],[1.760438464],[1.258826501],[1.683160325],[1.246798499],[0.326105025],[0.738117723],[2.659314423],[0.804079383],[1.999437468],[1.354537332],[0.698922399],[1.891592365],[1.941076181],[2.329147687],[1.246931083],[0.574108036],[1.541003087],[1.205302845],[-0.018765632],[2.575835209],[1.217988353],[2.058520895],[0.877744713],[3.107678209],[-4.053429736],[1.31289957],[1.289742517],[2.12817974],[1.475059828],[2.950738225],[3.442340249],[-15.57787617],[2.235862094],[0.024305613],[1.870810416],[4.653044977],[1.250933865],[2.513207262],[1.727115142],[2.708077508],[1.82292049],[0.425609061],[1.195039363],[1.217452765],[2.868674649],[2.750101522],[0.687448536],[2.960174252],[2.97681824],[1.940387297],[1.17996041],[0.630010678],[3.493584744],[-0.125923574],[2.547992315],[0.076252739],[3.042447173],[1.189988283],[1.912785417],[0.358064433],[1.74089007],[0.663530685],[1.584222891],[1.591724862],[1.614411506],[1.02484149],[2.11201885],[2.468035938],[2.076837103],[8.912],[2.169003633],[0.51488285],[-0.198485227],[0.749605221],[1.096134017],[1.795065583],[2.666636237],[1.948109067],[2.244524401],[1.932204177],[1.859170895],[0.86121979],[1.311389051],[0.447496791],[0.889692856],[0.746262405],[2.202255699],[4.13265337],[3.059421787],[0.978202106],[4.171870209],[1.693273732],[2.76795502],[1.558625389],[0.258843927],[-0.036000066],[-0.729161647],[1.959547743],[0.841717338],[1.197433493],[1.928084891],[1.829357671],[1.100267413],[1.075981921],[0.146887005],[0.288581101],[2.272926129],[2.13613653],[1.864483723],[2.063634546],[2.458887538],[2.218669026],[2.338713901],[2.128851922],[6.681972038],[0.74216847],[1.145541115],[1.443835479],[2.364451932],[2.016783713],[1.235524646],[2.044362554],[0.177054039],[2.195639887],[0.647532572],[1.146520554],[6.024092343],[3.275627744],[4.980500386],[4.994872672],[0.418466687],[5.686962046],[1.134616618],[3.750141389],[2.261650536],[1.396328986],[2.218684096],[1.27635301],[0.847882541],[1.804233066],[1.363702723],[-0.76527849],[0.88912536],[0.026562024],[0.826197099],[1.754694851],[2.007807092],[1.228509689],[2.518930021],[1.815824297],[2.829905669],[2.50448913],[1.91368576],[1.401242757],[2.247452311],[-10.00071518],[-8.293524746],[3.02194133],[1.117276979],[0.607935715],[1.662779952],[2.449922977],[2.064072083],[2.261341525],[1.333673559],[2.131563992],[1.426724322],[-11.24400297],[1.201744378],[-20.18996001],[3.446814057],[1.828623399],[2.89162348],[1.721017907],[1.676884967],[2.632148662],[1.810460099],[5.674294957],[5.312883789],[5.199234775],[3.303530143],[4.045715402],[2.038554599],[4.276140636],[1.638200361],[1.19788937],[1.722738366],[-0.126039893],[1.741846751],[1.346504104],[2.080446359],[2.608959223],[1.405968006],[2.425212456],[0.919305348],[3.326629888],[3.766205214],[-0.429565702],[2.587363319],[0.82737693],[3.323146943],[2.250405751],[-0.212076696],[1.347384379],[1.870543522],[4.874671762],[3.542332601],[1.322676029],[2.068127326],[1.452893076],[0.887296327],[1.240925108],[-0.33925475],[1.015105333],[1.957198716],[1.588619357],[1.157131171],[0.34503653],[0.769286377],[0.299545248],[1.100184658],[-0.487611287],[-0.967946822],[1.55037084],[1.084332306],[3.340261143],[0.999419501],[2.029830553],[1.039639588],[2.727705709],[1.094759797],[2.178709874],[1.018055388],[1.1905838],[2.247550102],[1.605806065],[2.128541943],[2.346754558],[2.272092833],[1.970264018],[1.44221981],[2.49464791],[1.912805318],[1.974013648],[2.124817692],[1.764442588],[1.552286386],[1.902318809],[-0.240082369],[0.96698939],[1.052127922],[1.677953207],[2.958979359],[0.892140199],[1.673922847],[1.495828692],[2.101991263],[0.852081391],[1.318467015],[2.546114929],[0.658970802],[1.854578502],[1.137415861],[1.312136554],[2.916082402],[2.380661681],[1.481962615],[0.681424211],[2.788368107],[1.859670282],[-5.013531342],[2.141079685],[0.321960606],[1.242626463],[2.008512242],[2.144620933],[-0.478381343],[-0.336291664],[1.061857373],[0.876573778],[1.909527728],[1.782117015],[2.427629673],[1.191538967],[2.872746828],[3.201418489],[0.894166224],[1.323380156],[0.629923021],[0.599172636],[1.173840602],[-2.746138635],[3.13847891],[1.156559948],[2.751770748],[2.292419952],[-0.161246511],[1.933091393],[1.699388975],[1.908595558],[2.429438611],[-0.258365373],[1.710049276],[2.135414219],[0.377794826],[1.501990502],[2.301973384],[2.532165028],[-0.122593253],[0.522506611],[1.194862456],[7.107106164],[8.080487632],[7.119556773],[-2.640975405],[1.986472823],[0.743649233],[0.157477596],[2.391861379],[2.606872736],[0.873306273],[0.581579089],[1.368057633],[0.966334759],[2.495686713],[0.096960611],[0.654266992],[1.521250199],[1.926184242],[3.40766203],[2.489509739],[1.134996581],[2.640963979],[1.975094106],[0.771844456],[1.144263079],[1.472982706],[1.309131159],[2.522592776],[2.239208455],[1.973466799],[0.196211764],[0.919990303],[2.300667869],[2.152717036],[0.590543931],[0.932419995],[5.495048225],[2.112702438],[2.65449171],[1.099698233],[2.755057933],[1.372970628],[1.054371889],[2.139043853],[2.3969254],[1.930421277],[1.666033268],[1.3267782],[0.877214654],[0.481479398],[1.401080118],[1.644276832],[2.174359814],[1.368948213],[0.380940026],[1.761714121],[1.481277828],[0.875825053],[2.608815424],[1.262387123],[1.35264908],[1.120741652],[1.601169258],[3.445384893],[1.120741652],[1.066522471],[1.601169258],[1.262387123],[1.066522471],[3.445384893],[1.978874483],[2.608815424],[1.35264908],[1.978874483],[1.703131124],[2.213235302],[2.287394099],[0.999013243],[2.688652579],[1.552404598],[1.028179602],[2.125597551],[0.8748438],[1.500968692],[1.700563297],[1.772239262],[2.233991288],[-4.212768947],[2.040477444],[1.643824272],[1.753396129],[1.791990627],[1.70344738],[0.218378531],[-0.630270315],[2.043869491],[5.591627478],[2.495048568],[2.1970586],[1.998743426],[1.102326499],[0.973137358],[0.859401681],[0.973137358],[0.859401681],[1.703465192],[1.32602992],[2.611347215],[1.703465192],[2.328198882],[2.611347215],[1.002036067],[1.32602992],[1.002036067],[2.328198882],[1.873756686],[0.49554419],[1.794661643],[2.115186692],[1.124208441],[1.856940186],[2.041925924],[2.179342123],[1.818099398],[0.384835622],[2.944330004],[0.292278519],[-0.337599381],[1.172095312],[1.542085277],[2.809185644],[0.836373113],[0.883665851],[1.416325117],[2.246467912],[-2.092696547],[-3.768803993],[2.350527267],[0.98833246],[2.590317408],[2.110359238],[0.071824625],[0.449155771],[1.005579044],[1.086165095],[1.352997669],[2.29042696],[2.299077929],[0.897971326],[1.835841385],[0.819812717],[1.435678923],[1.266482779],[2.06429731],[5.214993638],[0.602977921],[0.755302069],[1.027070949],[6.768223956],[1.533274133],[7.695930132],[1.32945793],[-1.128240289],[1.32945793],[-1.128240289],[7.695930132],[1.599545246],[2.3824747],[1.106990414],[0.607122409],[2.408642907],[1.17364296],[1.532807281],[0.986536735],[-0.430547466],[0.614175587],[2.414548287],[0.778161732],[2.762575178],[1.885916929],[0.607401922],[1.35851814],[3.637329652],[2.0822579],[2.227409328],[0.619759727],[0.442717115],[2.310528128],[0.049924956],[0.69083216],[1.628737784],[2.160554062],[1.644391188],[1.275971896],[1.346155214],[2.317623903],[1.182549606],[3.639095211],[3.089395352],[3.139675619],[2.408598001],[3.810121412],[-0.887105752],[2.744978631],[0.900375633],[1.672339417],[1.27906807],[2.141173419],[0.537627543],[0.818990221],[-1.60431537],[1.830043185],[1.250455706],[2.093752954],[-9.771757409],[1.161311296],[2.38430404],[1.762419091],[0.756591887],[1.391710937],[-0.266110134],[0.324182529],[3.14064599],[-1.612888578],[0.861001411],[1.65491554],[1.378812055],[2.756031663],[1.420071373],[2.373432862],[0.469857606],[2.120736427],[2.114802919],[1.537174287],[-10.40019965],[1.880627503],[2.05713338],[0.884540473],[1.115101131],[2.042768701],[-11.08357136],[1.889761457],[-9.391329734],[1.926830428],[-12.14356716],[3.209098692],[1.995620648],[1.709904486],[0.093627663],[-0.179044759],[1.269147119],[7.493951022],[1.702997735],[1.958392731],[2.879957029],[0.118060842],[1.257046914],[1.357137354],[2.708320402],[1.531796977],[4.507049102],[1.151607831],[3.682039406],[3.852260585],[1.479536529],[1.929496894],[-0.331866005],[0.269071762],[2.507567061],[2.960996463],[1.670644787],[1.227822628],[1.71893175],[0.980658723],[0.447423341],[1.404335269],[1.697217415],[-0.216043835],[1.97257311],[1.097132077],[0.020025049],[3.581402801],[3.239165936],[0.038860264],[-2.298229525],[0.458575695],[2.962176936],[1.832003764],[0.8701476],[-2.777293532],[0.101597807],[1.650709885],[2.120817749],[2.450189409],[-9.672334669],[0.945638434],[0.881298529],[2.601491124],[1.73549957],[0.636406874],[1.319747514],[0.283028558],[-13.51068606],[0.768617367],[1.268469582],[1.793339175],[-0.547021173],[2.676340738],[2.119753381],[2.989706796],[0.766493766],[1.699242206],[1.919245352],[0.794537921],[0.727450875],[1.385022272],[3.450208886],[1.621227068],[2.975044369],[0.80210616],[1.832700197],[2.538895632],[2.044750182],[2.100111324],[1.636115986],[0.438346442],[8.945460163],[7.66208599],[8.980385176],[6.314223723],[5.52939596],[1.712943512],[1.243723789],[1.267392469],[1.941475437],[1.676847128],[1.169131696],[2.074889807],[1.672439348],[1.967698944],[1.722195678],[0.214693376],[1.903694787],[-1.613474483],[1.461103438],[3.606099004],[-0.163953491],[-13.49560485],[0.7103338],[1.294605111],[1.138695408],[0.540388615],[0.884569743],[1.384920349],[1.968598606],[2.74888942],[-0.246270117],[1.620335056],[1.911310406],[1.117553966],[1.180663584],[2.256059442],[0.091399103],[1.302671851],[-0.265568828],[2.18516751],[1.818783192],[1.087397674],[0.409618924],[0.46820676],[4.020480692],[1.082981882],[-0.793089959],[2.18690846],[1.744982563],[0.675557762],[0.736723354],[2.403322191],[2.149023423],[1.584463665],[0.081430265],[0.974598166],[0.431801872],[3.579281264],[1.108269057],[0.655899716],[2.828766138],[1.218823628],[2.044670816],[0.520632367],[0.353413539],[0.940567607],[1.301159111],[-0.220235145],[0.719294174],[0.244977212],[1.590422127],[0.582603421],[0.675275712],[1.050289819],[1.481608533],[-0.14541635],[-0.193709422],[0.267717926],[1.148080661],[2.094978573],[1.086250659],[-0.819209584],[0.02312094],[0.968607333],[0.686280332],[2.469183876],[0.532978236],[1.492635583],[2.914160786],[1.509182086],[1.296082229],[1.074653345],[2.186638258],[2.454654396],[2.164105709],[0.187704676],[1.04094688],[2.327039565],[0.806760696],[3.645050517],[0.672938487],[1.223009064],[0.328932541],[1.388014055],[2.430904952],[1.595120307],[2.181524223],[1.500690748],[1.541131859],[0.06645932],[2.467191379],[2.249617268],[3.11771149],[0.288206438],[2.265501772],[0.755535671],[1.702899817],[2.384714508],[0.16362944],[0.854363176],[1.400420769],[1.16678077],[1.388598173],[1.567689004],[0.632654572],[2.967522376],[1.865850003],[-5.149155545],[-0.087453788],[0.482678724],[1.211377752],[3.404441579],[3.347950277],[2.081234474],[1.45135553],[0.500971159],[-0.250256659],[1.178119113],[1.130250022],[2.312985589],[-0.117900929],[0.280847013],[2.319130966],[-0.666161095],[1.243689271],[0.169757282],[1.493296556],[0.245546824],[0.887012662],[0.402318607],[2.018226935],[-6.843234313],[2.66916676],[0.756456063],[0.998325704],[3.336056149],[5.976591488],[1.244658209],[2.470762259],[0.97198678],[1.079763179],[0.716225176],[0.862459438],[0.214263823],[0.429293681],[2.562038226],[1.523261291],[0.07851992],[0.816865182],[1.845552953],[0.822111789],[0.616739101],[0.525703733],[0.143238558],[1.472033856],[0.766312113],[-7.406776125],[1.431933963],[1.116218479],[0.385839874],[1.364010843],[0.832738333],[0.87975938]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"V_DIST","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758795550,"submitTime":1493758758739,"finishTime":1493758795746,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"boxPlot","width":"325","height":"278","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87dd523a-74b2-422a-96ea-0f8a4995e2b8"},{"version":"CommandV1","origId":2109564766429498,"guid":"1b2f46ac-7b25-4931-9606-f99480f7da5e","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%md\nVertical distance has a greater fluctuation, and a median around 1.5 m.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758774,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c2f539e3-42b1-48e0-8809-dc94fef0af0a"},{"version":"CommandV1","origId":2109564766429499,"guid":"538dbe4c-7921-4dd3-b062-2e43ce92d6e9","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%sql\n-- What is distribution of heave? \nSELECT heave\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[2.91],[4.969],[4.477],[3.609],[3.514],[3.378],[3.502],[3.794],[2.084],[3.368],[3.838],[4.037],[4.594],[3.351],[3.958],[3.53],[3.615],[4.7],[4.319],[4.06],[4.048],[3.251],[3.795],[4.245],[2.857],[2.483],[3.654],[3.834],[2.678],[3.642],[4.192],[3.434],[3.202],[2.941],[3.987],[2.829],[4.42],[4.407],[4.058],[-0.066],[2.622],[2.951],[1.887],[2.188],[3.533],[4.733],[1.564],[2.403],[1.835],[1.343],[1.7],[3.237],[0.864],[0.629],[2.77],[3.543],[2.967],[2.754],[4.199],[3.899],[1.148],[4.35],[3.652],[1.346],[6.3],[3.355],[2.238],[3.114],[5.793],[4.409],[8.486],[4.63],[4.66],[1.405],[3.879],[2.527],[3.611],[3.472],[3.25],[3.132],[3.762],[4.382],[2.172],[3.598],[4.737],[4.105],[3.766],[3.48],[2.826],[3.145],[3.809],[2.638],[3.391],[2.863],[3.199],[3.228],[3.405],[2.814],[3.143],[3.275],[9.161],[3.282],[3.873],[3.478],[3.208],[1.049],[1.871],[2.892],[3.366],[4.025],[3.43],[4.479],[4.588],[4.572],[4.144],[4.209],[3.517],[3.613],[3.959],[4.243],[3.289],[1.866],[3.984],[2.884],[4.117],[3.331],[3.958],[3.249],[4.344],[5.99],[4.193],[3.413],[1.944],[2.684],[2.014],[3.878],[3.756],[3.427],[2.547],[3.775],[3.619],[4.798],[3.43],[1.777],[4.519],[2.263],[2.245],[2.891],[3.043],[3.414],[3.911],[3.593],[3.674],[3.927],[2.411],[2.289],[3.199],[2.951],[3.848],[1.528],[2.07],[2.352],[4.635],[5.557],[3.726],[3.212],[3.051],[3.729],[5.536],[4.147],[1.977],[5.349],[4.02],[3.405],[3.853],[3.996],[4.054],[4.522],[6.041],[3.536],[3.753],[3.043],[3.91],[3.899],[3.209],[2.671],[4.132],[2.664],[3.557],[4.257],[3.387],[3.305],[3.595],[1.498],[3.347],[1.662],[3.364],[2.194],[0.985],[3.852],[2.311],[4.289],[3.647],[4.746],[3.481],[4.204],[3.082],[3.827],[3.571],[4.684],[4.346],[2.84],[4.137],[2.882],[4.439],[3.882],[2.973],[3.268],[3.287],[3.553],[3.742],[3.608],[3.15],[3.397],[3.864],[3.929],[2.782],[4.508],[4.543],[3.492],[3.878],[3.767],[4.175],[2.846],[4.153],[2.923],[3.988],[2.617],[3.434],[1.99],[2.796],[3.167],[3.333],[3.859],[2.918],[2.57],[3.289],[3.535],[3.005],[3.812],[4.044],[1.987],[1.255],[3.934],[2.501],[2.231],[3.638],[3.889],[3.359],[3.222],[4.227],[3.69],[2.026],[1.465],[1.885],[3.532],[3.358],[5.093],[4.448],[3.725],[5.043],[2.395],[5.204],[3.463],[4.175],[2.169],[1.686],[3.056],[3.046],[3.738],[3.016],[2.99],[1.925],[2.059],[1.44],[2.102],[3.411],[4.187],[3.946],[2.814],[4.259],[4.152],[3.402],[2.95],[2.867],[3.2648315],[3.4342982],[3.5531629],[3.697],[3.256],[3.358],[3.223],[3.186],[4.371],[1.486],[1.643],[4.52],[3.708],[3.811],[3.452],[3.232],[4.039],[2.728],[4.023],[2.468],[4.555],[4.304],[2.48],[3.541],[2.753],[3.928],[2.351],[2.017],[1.411],[2.854],[3.518],[3.914],[2.519],[4.669],[4.551],[5.415],[4.278],[3.855],[3.358],[4.455],[3.732],[4.932],[3.566],[2.815],[1.566],[3.941],[4.229],[4.922],[3.73],[3.244],[3.716],[4.266],[3.412],[3.968],[3.977],[3.13],[3.596],[4.001],[3.98],[3.44],[4.796],[3.768],[4.436],[3.95],[4.417],[2.872],[2.723],[3.388],[5.542],[4.531],[2.679],[4.095],[6.384],[3.771],[3.7],[2.879],[4.328],[3.66],[3.418],[3.685],[3.14],[5.001],[3.292],[3.968],[2.826],[3.762],[3.43],[3.262],[3.434],[2.93],[2.74],[4.179],[4.499],[7.162],[5.306],[1.462],[1.77],[2.81],[3.356],[3.601],[2.219],[2.449],[0.948],[1.173],[2.464],[2.731],[1.002],[2.357],[5.295],[2.023],[4.733],[3.786],[3.627],[3.257],[4.209],[2.309],[4.905],[3.347],[3.021],[3.815],[3.262],[4.063],[4.399],[4.219],[2.929],[3.831],[4.654],[3.401],[2.764],[-0.156],[4.444],[3.912],[1.656],[-0.021],[2.073],[2.219],[2.953],[4.947],[3.454],[2.863],[3.438],[4.965],[2.361],[6.422],[6.139],[2.737],[3.535],[2.378],[3.573],[4.435],[3.907],[4.19],[3.573],[5.379],[3.056],[3.563],[3.913],[3.968],[4.389],[4.403],[4.023],[3.304],[3.062],[3.158],[3.299],[3.527],[4.42],[5.828],[4.311],[4.264],[3.222],[3.602],[2.32],[2.449],[1.545],[4.751],[3.607],[3.125],[2.148],[3.835],[2.607],[3.13],[3.488],[1.069],[3.424],[3.607],[4.096],[3.796],[2.616],[3.841],[4.091],[4.067],[6.075],[2.417],[2.612],[1.709],[3.114],[3.41],[2.56],[2.632],[3.141],[3.905],[1.723],[2.816],[3.011],[2.516],[2.972],[3.934],[3.197],[3.368],[2.091],[2.752],[2.639],[3.698],[3.939],[3.937],[2.537],[3.638],[3.431],[2.92],[2.329],[1.966],[3.094],[3.379],[3.113],[3.096],[2.448],[4.379],[2.352],[3.291],[2.276],[3.759],[3.119],[5.293],[4.333],[3.272],[5.207],[2.715],[3.326],[3.617],[3.524],[3.332],[3.295],[2.965],[3.281],[1.876],[3.163],[3.628],[3.421],[3.938],[3.375],[3.779],[3.773],[3.994],[3.822],[4.376],[4.292],[3.43],[3.289],[4.837],[3.43],[2.978],[3.289],[4.376],[2.978],[4.837],[3.608],[3.822],[4.292],[3.608],[4.842],[4.523],[3.896],[2.947],[4.117],[3.904],[3.46],[2.905],[3.03],[3.887],[1.594],[4.943],[3.942],[3.909],[3.429],[2.675],[3.679],[3.294],[3.4],[2.386],[1.841],[2.215],[7.348],[4.58],[4.482],[3.644],[3.903],[3.066],[3.098],[3.066],[3.098],[3.603],[3.126],[2.936],[3.603],[2.989],[2.936],[2.507],[3.126],[2.507],[2.989],[5.41],[2.578],[2.843],[4.426],[2.978],[3.694],[3.507],[3.496],[3.087],[2.125],[3.405],[2.679],[2.921],[2.686],[2.738],[3.773],[2.529],[3.394],[3.887],[3.548],[1.576],[2.041],[1.341],[3.802],[4.798],[3.767],[3.18],[3.41],[3.23],[3.654],[3.328],[4.608],[5.152],[1.571],[4.001],[3.627],[3.285],[5.048],[3.496],[7.479],[2.381],[2.076],[1.542],[3.141],[4.216],[5.085],[2.446],[1.354],[2.446],[1.354],[5.085],[3.129],[4.474],[2.517],[2.326],[3.44],[1.708],[2.69],[0.277],[-0.214],[2.827],[2.713],[2.972],[5.297],[3.753],[2.595],[3.183],[3.149],[3.786],[4.017],[2.522],[2.487],[2.863],[3.578],[2.789],[3.563],[3.802],[3.068],[5.179],[3.568],[3.744],[4.6],[5.115],[4.073],[5.232],[3.396],[3.345],[3.247],[4.53],[3.655],[3.059],[2.272],[3.784],[3.477],[3.048],[2.336],[4.86],[4.106],[4.014],[3.708],[3.44],[5.969],[6.081],[3.548],[3.521],[1.507],[2.257],[3.971],[0.935],[3.234],[3.132],[2.579],[3.134],[5.027],[3.487],[2.201],[3.693],[4.095],[3.909],[2.845],[2.668],[3.634],[2.022],[3.965],[3.9],[2.543],[3.234],[2.817],[2.73],[1.375],[4.293],[6.826],[2.725],[3.362],[3.694],[3.58],[4.148],[3.08],[3.454],[3.309],[4.017],[3.603],[3.153],[3.794],[2.794],[3.252],[4.4],[4.139],[4.889],[3.066],[2.559],[3.151],[2.6],[3.116],[4.105],[3.563],[3.279],[3.595],[3.902],[3.823],[3.79],[4.379],[2.797],[3.151],[3.729],[2.857],[4.034],[3.305],[3.017],[4.674],[2.74],[3.65],[3.311],[1.171],[3.143],[3.352],[3.905],[3.39],[3.93],[4.14],[3.256],[3.072],[3.769],[3.405],[2.131],[2.66],[3.523],[2.638],[3.608],[4.037],[2.794],[2.354],[3.704],[2.514],[4.947],[2.904],[4.147],[4.077],[2.798],[4.382],[3.745],[3.002],[3.729],[4.792],[2.449],[3.392],[4.297],[3.383],[3.813],[1.553],[1.037],[4.664],[4.253],[5.213],[1.45],[1.811],[2.7052855],[3.6753958],[3.0495741],[2.2570453],[3.0332071],[2.8427661],[2.502],[3.593],[2.933],[3.487],[2.693],[3.466],[6.292],[1.528],[4.777],[-0.187],[2.854],[3.073],[4.908],[3.436],[3.603],[2.512],[3.598],[4.478],[4.452],[2.693],[3.58],[3.385],[3.895],[4.693],[4.929],[2.506],[4.131],[1.456],[2.649],[4.762],[4.012],[1.904],[3.986],[5.759],[3.767],[1.797],[3.93],[2.829],[3.312],[3.723],[4.326],[4.155],[2.326],[2.45],[4.233],[3.378],[5.03],[3.806],[3.054],[4.538],[2.362],[3.79],[2.95],[3.0],[3.585],[2.548],[2.041],[1.621],[3.114],[3.317],[4.115],[2.446],[3.241],[2.62],[2.094],[3.59],[2.932],[2.652],[2.615],[4.14],[3.221],[3.235],[3.165],[3.718],[4.104],[3.622],[3.708],[3.376],[3.134],[4.712],[3.572],[4.024],[4.24],[4.014],[4.72],[3.131],[4.006],[2.83],[4.173],[3.022],[3.405],[4.997],[3.814],[4.377],[3.502],[5.519],[4.308],[3.012],[3.426],[3.433],[4.376],[4.031],[3.986],[3.4],[3.79],[3.599],[3.518],[3.537],[3.67],[3.232],[3.458],[2.702],[2.95],[4.119],[5.189],[4.162],[3.103],[2.404],[1.271],[3.957],[3.379],[4.368],[4.194],[3.1],[2.868],[3.786],[2.87],[2.902],[3.187],[4.603],[2.99],[5.179],[0.938],[3.731],[2.476],[3.016],[3.123],[3.975],[1.111],[2.829],[3.247],[5.324],[3.596],[3.452],[4.062],[6.505],[1.524],[3.495],[2.927],[2.724],[3.436],[2.309],[1.941],[2.471],[3.778],[3.242],[0.818],[-0.073],[4.207],[2.152],[0.8],[1.853],[3.282],[3.162],[2.898],[4.997],[4.252],[5.668],[2.99],[1.182],[1.959],[3.817]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"heave","type":"\"double\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"java.lang.IllegalArgumentException: requirement failed: Histogram supports only a single value","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758795755,"submitTime":1493758758816,"finishTime":1493758795913,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"histogram","width":"500","height":"388","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da516e21-7c62-4911-9837-6004e6847474"},{"version":"CommandV1","origId":2109564766429500,"guid":"20a3f9c4-c057-4a21-bd4f-381d2f6dfeff","subtype":"command","commandType":"auto","position":6.999755858676508,"command":"%md\nMost heave was measured between 2 and 5 m. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758850,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c74e873-3d45-481d-856f-b121386431d2"},{"version":"CommandV1","origId":2109564766429501,"guid":"7013f429-ef29-4fdb-aaf8-f6bd18b6c82e","subtype":"command","commandType":"auto","position":6.999755859025754,"command":"%sql\nSELECT COUNT(BLAST_LOC)\nFROM smry_bmm","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1530]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(BLAST_LOC)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758795918,"submitTime":1493758758885,"finishTime":1493758796099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72593e05-dacc-4a49-a67c-4e2848180941"},{"version":"CommandV1","origId":2109564766429502,"guid":"2e75178b-1e98-415c-b347-71e9e315113b","subtype":"command","commandType":"auto","position":6.999755859200377,"command":"%md \n### Data Selection\nBased on a review of the tables, the smry_bmm table was selected for further analysis. This table was selected as it contains already contains the necessary elements to be assessed with the clustering technique. As it was shown, the Table contains:\n* Geotechnical data (Such as RQD, FRAQS_FREQ, Q, and PEN_RATE)\n* Blast data (Such as BLAST_LOC, LEVEL)\n* Rock data (Such as ROCK_TYPE, MATERIAL)\n* Blast parameters (Such as BENCH_HEIGHT, SPACING, STEMMING, SUB_DRILL, POWDER_FAC, INITIATION)\n* Blast outcomes (Such as D_Dist, V_Dist, HEAVE )","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758914,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f2b4f21-663f-4a38-8627-d1de6b896cda"},{"version":"CommandV1","origId":2109564766429503,"guid":"13976152-7982-44f7-93e5-a9d263194aad","subtype":"command","commandType":"auto","position":6.999755859375,"command":"%md <a id=\"preparation\"></a>\n## 4.0) Data Preparation","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758950,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df15175a-4e79-4c89-bb9c-cb30711e2676"},{"version":"CommandV1","origId":2109564766429504,"guid":"d19bf9c8-f4e8-45d5-a613-d12026dae824","subtype":"command","commandType":"auto","position":6.999763488769531,"command":"%md\n### 4.1) Data Cleaning","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758758986,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62ec6a29-d193-4284-9c68-40da389457e0"},{"version":"CommandV1","origId":2109564766429505,"guid":"10621012-2a3e-4e9c-8439-7587626740f2","subtype":"command","commandType":"auto","position":6.9997711181640625,"command":"%md\n####List of Cleaning to be Performed \n* Remove GEO_DOM, GEO_DOM1 - These columns appear to not provide any further useful information \n* Remove blast locations where no RQD, FRAQS_FREQ, IS_50 or Q exist, or are 0 - Geotech parameters are an important component of the clustering process\n* Remove LEVEL column - not required for analysis \n* Remove BLAST_DATE column - not required for analysis \n* Normalize BLAST PATTERN & CONFINEMENT labels","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758759034,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c44d6bc4-c704-42eb-b78b-9b16aef0e7c0"},{"version":"CommandV1","origId":2109564766429506,"guid":"2564c4d4-aa36-482c-8194-223de1dc28bd","subtype":"command","commandType":"auto","position":6.99981689453125,"command":"#Convert spark df to pandas, do not select GEO_DOM, GEO_DOM1, BLAST_DATE, LEVEL, BMM_NUM \npDf = sqlContext.sql(\"SELECT BLAST_LOC, RQD, FRACS_FREQ, IS_50, Q, PEN_RATE, ROCK_TYPE, BLAST_TYPE, DH_DELAY, HS_DELAY, RS_DELAY, HOLE_DIA, BENCH_HEIGHT, BURDEN, SPACING, STEMMING, SUB_DRILL, EXPLOSIVE, BLAST_PATTERN, TOTAL_EXPLOSIVE, HOLE_DEPTH, POWDER_FACTOR, INITIATION_TYPE, CONFINEMENT, THREED_DIST, H_DIST,V_DIST, DIRECTION, INCLINATION, HEAVE FROM smry_bmm \").toPandas()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;DIRECTINO&#96;&apos; given input columns: [BLAST_DATE, RS_DELAY, Q, BENCH_HEIGHT, THREED_DIST, V_DIST, DH_DELAY, MATERIAL, BLAST_TYPE, HG_MG, HOLE_DEPTH, FIRING_DIRECTION, BLAST_LOC, HS_DELAY, LG, BLAST_PATTERN, INCLINATION, NAG, CONFINEMENT, PEN_RATE, IS_50, LEVEL, TOTAL_EXPLOSIVE, RQD, HOLE_DIA, ROCK_TYPE, GEO_DOM1, POWDER_FACTOR, BMM_NUM, SPACING, GEO_DOM2, H_DIST, HEAVE, INITIATION_TYPE, FRACS_FREQ, EXPLOSIVE, DIRECTION, BURDEN, STEMMING, SUB_DRILL, TOTAL_TONS]; line 1 pos 298;\\n&apos;Project [BLAST_LOC#330, RQD#333, FRACS_FREQ#334, IS_50#335, Q#336, PEN_RATE#338, ROCK_TYPE#340, BLAST_TYPE#346, DH_DELAY#347, HS_DELAY#348, RS_DELAY#349, HOLE_DIA#350, BENCH_HEIGHT#351, BURDEN#352, SPACING#353, STEMMING#354, SUB_DRILL#355, EXPLOSIVE#356, BLAST_PATTERN#357, TOTAL_EXPLOSIVE#358, HOLE_DEPTH#359, POWDER_FACTOR#361, INITIATION_TYPE#362, CONFINEMENT#363, ... 6 more fields]\\n+- SubqueryAlias smry_bmm\\n   +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_LOC, true) AS BLAST_LOC#330, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM1, true) AS GEO_DOM1#331, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM2, true) AS GEO_DOM2#332, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RQD AS RQD#333, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).FRACS_FREQ AS FRACS_FREQ#334, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).IS_50 AS IS_50#335, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).Q AS Q#336, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LEVEL, true) AS LEVEL#337, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).PEN_RATE AS PEN_RATE#338, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_DATE, true) AS BLAST_DATE#339, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).ROCK_TYPE, true) AS ROCK_TYPE#340, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).MATERIAL, true) AS MATERIAL#341, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HG_MG AS HG_MG#342, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LG AS LG#343, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).NAG AS NAG#344, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).TOTAL_TONS AS TOTAL_TONS#345, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_TYPE, true) AS BLAST_TYPE#346, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).DH_DELAY AS DH_DELAY#347, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HS_DELAY AS HS_DELAY#348, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RS_DELAY AS RS_DELAY#349, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HOLE_DIA AS HOLE_DIA#350, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BENCH_HEIGHT AS BENCH_HEIGHT#351, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BURDEN AS BURDEN#352, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).SPACING AS SPACING#353, ... 17 more fields]\\n      +- ExternalRDD [obj#329]\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-8-cec0b91fa3c6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Convert spark df to pandas, do not select GEO_DOM, GEO_DOM1, BLAST_DATE, LEVEL, BMM_NUM</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>pDf <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;SELECT BLAST_LOC, RQD, FRACS_FREQ, IS_50, Q, PEN_RATE, ROCK_TYPE, BLAST_TYPE, DH_DELAY, HS_DELAY, RS_DELAY, HOLE_DIA, BENCH_HEIGHT, BURDEN, SPACING, STEMMING, SUB_DRILL, EXPLOSIVE, BLAST_PATTERN, TOTAL_EXPLOSIVE, HOLE_DEPTH, POWDER_FACTOR, INITIATION_TYPE, CONFINEMENT, THREED_DIST, H_DIST,V_DIST, DIRECTINO, INCLINATION, HEAVE FROM smry_bmm &quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>toPandas<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/context.py</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    382</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    383</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 384</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>sparkSession<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    385</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    386</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.py</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    543</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    544</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 545</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsparkSession<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_wrapped<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    546</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    547</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;DIRECTINO&#96;&apos; given input columns: [BLAST_DATE, RS_DELAY, Q, BENCH_HEIGHT, THREED_DIST, V_DIST, DH_DELAY, MATERIAL, BLAST_TYPE, HG_MG, HOLE_DEPTH, FIRING_DIRECTION, BLAST_LOC, HS_DELAY, LG, BLAST_PATTERN, INCLINATION, NAG, CONFINEMENT, PEN_RATE, IS_50, LEVEL, TOTAL_EXPLOSIVE, RQD, HOLE_DIA, ROCK_TYPE, GEO_DOM1, POWDER_FACTOR, BMM_NUM, SPACING, GEO_DOM2, H_DIST, HEAVE, INITIATION_TYPE, FRACS_FREQ, EXPLOSIVE, DIRECTION, BURDEN, STEMMING, SUB_DRILL, TOTAL_TONS]; line 1 pos 298;\\n&apos;Project [BLAST_LOC#330, RQD#333, FRACS_FREQ#334, IS_50#335, Q#336, PEN_RATE#338, ROCK_TYPE#340, BLAST_TYPE#346, DH_DELAY#347, HS_DELAY#348, RS_DELAY#349, HOLE_DIA#350, BENCH_HEIGHT#351, BURDEN#352, SPACING#353, STEMMING#354, SUB_DRILL#355, EXPLOSIVE#356, BLAST_PATTERN#357, TOTAL_EXPLOSIVE#358, HOLE_DEPTH#359, POWDER_FACTOR#361, INITIATION_TYPE#362, CONFINEMENT#363, ... 6 more fields]\\n+- SubqueryAlias smry_bmm\\n   +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_LOC, true) AS BLAST_LOC#330, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM1, true) AS GEO_DOM1#331, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).GEO_DOM2, true) AS GEO_DOM2#332, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RQD AS RQD#333, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).FRACS_FREQ AS FRACS_FREQ#334, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).IS_50 AS IS_50#335, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).Q AS Q#336, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LEVEL, true) AS LEVEL#337, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).PEN_RATE AS PEN_RATE#338, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_DATE, true) AS BLAST_DATE#339, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).ROCK_TYPE, true) AS ROCK_TYPE#340, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).MATERIAL, true) AS MATERIAL#341, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HG_MG AS HG_MG#342, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).LG AS LG#343, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).NAG AS NAG#344, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).TOTAL_TONS AS TOTAL_TONS#345, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BLAST_TYPE, true) AS BLAST_TYPE#346, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).DH_DELAY AS DH_DELAY#347, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HS_DELAY AS HS_DELAY#348, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).RS_DELAY AS RS_DELAY#349, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).HOLE_DIA AS HOLE_DIA#350, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BENCH_HEIGHT AS BENCH_HEIGHT#351, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).BURDEN AS BURDEN#352, assertnotnull(input[0, linee54e867e584a447c926ec1b72c6b78f839.$read$$iw$$iw$$iw$$iw$$iw$$iw$bmm, true], top level Product input object).SPACING AS SPACING#353, ... 17 more fields]\\n      +- ExternalRDD [obj#329]\\n&quot;</div>","workflows":[],"startTime":1493758796103,"submitTime":1493758759271,"finishTime":1493758796428,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"862f2fd6-f6df-4a20-b8dd-6a57f42cd1f5"},{"version":"CommandV1","origId":2109564766429507,"guid":"a60dba96-368d-4277-9493-170d15c97fa7","subtype":"command","commandType":"auto","position":6.999824523925781,"command":"#Confirm that appropriate columns selected\npDf.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">8</span><span class=\"ansired\">]: </span>\n  BLAST_LOC   RQD  FRACS_FREQ  IS_50     Q  PEN_RATE ROCK_TYPE  BLAST_TYPE  \\\n0    148-10  97.3         4.3    8.7  15.7  0.428324        KP  Production   \n1    148-10  97.3         4.3    8.7  15.7  0.428324        KP  Production   \n2    148-10  97.3         4.3    8.7  15.7  0.428324        KP  Production   \n3    148-19  99.0         2.7   12.5  17.7  0.433426        KP  Production   \n4    148-19  99.0         2.7   12.5  17.7  0.433426        PF  Production   \n\n   DH_DELAY  HS_DELAY  ...    HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  \\\n0         0        42  ...          13.0           0.22                V   \n1         0        42  ...          13.0           0.22                V   \n2         0        42  ...          13.0           0.22                V   \n3         0        42  ...          13.0           0.22          Echelon   \n4         0        42  ...          13.0           0.22          Echelon   \n\n   CONFINEMENT  THREED_DIST    H_DIST    V_DIST   DIRECTION INCLINATION  HEAVE  \n0       Choked     5.356509  3.383941  4.152244  137.227446   50.821102  2.910  \n1       Choked     4.324379  3.559450  2.455721   43.964167   34.602412  4.969  \n2       Choked     5.450931  2.459278  4.864628   52.268051   63.181441  4.477  \n3    Free Face     3.770577  3.582945  1.174629   38.552419   18.151168  3.609  \n4    Free Face     3.367295  3.261074  0.839091   61.540979   14.429488  3.514  \n\n[5 rows x 30 columns]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758796433,"submitTime":1493758759330,"finishTime":1493758796515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a75a0e4f-1bf8-41ad-bd80-ab62d80cd4d2"},{"version":"CommandV1","origId":2109564766429508,"guid":"56b3a724-0dc3-4b20-b50f-272497972e65","subtype":"command","commandType":"auto","position":6.9998321533203125,"command":"#Lets whats in the dataframe\npDf.info()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;\nRangeIndex: 1530 entries, 0 to 1529\nData columns (total 30 columns):\nBLAST_LOC          1530 non-null object\nRQD                1530 non-null float64\nFRACS_FREQ         1530 non-null float64\nIS_50              1530 non-null float64\nQ                  1530 non-null float64\nPEN_RATE           1530 non-null float64\nROCK_TYPE          1530 non-null object\nBLAST_TYPE         1530 non-null object\nDH_DELAY           1530 non-null int64\nHS_DELAY           1530 non-null int64\nRS_DELAY           1530 non-null int64\nHOLE_DIA           1530 non-null int64\nBENCH_HEIGHT       1530 non-null int64\nBURDEN             1530 non-null int64\nSPACING            1530 non-null int64\nSTEMMING           1530 non-null float64\nSUB_DRILL          1530 non-null float64\nEXPLOSIVE          1530 non-null object\nBLAST_PATTERN      1530 non-null object\nTOTAL_EXPLOSIVE    1530 non-null float64\nHOLE_DEPTH         1530 non-null float64\nPOWDER_FACTOR      1530 non-null float64\nINITIATION_TYPE    1530 non-null object\nCONFINEMENT        1530 non-null object\nTHREED_DIST        1530 non-null float64\nH_DIST             1530 non-null float64\nV_DIST             1530 non-null float64\nDIRECTION          1530 non-null float64\nINCLINATION        1530 non-null float64\nHEAVE              1530 non-null float64\ndtypes: float64(16), int64(7), object(7)\nmemory usage: 358.7+ KB\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758796520,"submitTime":1493758759375,"finishTime":1493758796597,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90067a49-f1ac-4e93-a71e-52a95576ac38"},{"version":"CommandV1","origId":2109564766429509,"guid":"cb5d22c2-9ef1-4324-b69d-78c846867d36","subtype":"command","commandType":"auto","position":6.999837875366211,"command":"#Remove the rows where RQD, FRACS_FREQ, IS_50, Q and PEN_RATE are zeros\npDf = pDf[(pDf.RQD > 0) & (pDf.FRACS_FREQ > 0) & (pDf.IS_50 > 0) & (pDf.Q > 0) & (pDf.PEN_RATE > 0)]\n#We only have 258 rows in the dataframe\npDf.shape","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>(258, 30)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;tuple&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-17-f9553b886d4a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> pDf<span class=\"ansiyellow\">[</span>pDf<span class=\"ansiyellow\">.</span>RQD <span class=\"ansiyellow\">&gt;</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>pDf<span class=\"ansiyellow\">.</span>shape<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;tuple&apos; object is not callable</div>","workflows":[],"startTime":1493758796602,"submitTime":1493758759420,"finishTime":1493758796642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4ba2bcfe-3d70-405f-8d46-12458372117c"},{"version":"CommandV1","origId":2109564766429510,"guid":"c0aa47b1-3008-442f-aaa0-2639155f4bc1","subtype":"command","commandType":"auto","position":6.99984073638916,"command":"# Normalize string labels by removing excessive whitespace in the middle of a word, shifting to lowercase, and removing any whitespace after the text\ndef normalizeLabels(label):\n  return re.sub('[ ]+',' ',label).lower().rstrip().lstrip()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">KeyError</span>: (&apos;CONFINEMENT&apos;, &apos;BLAST_PATTERN&apos;)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-28-c3d148a24c8a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Next we need to normalize the labels in a few columns</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;CONFINEMENT&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;BLAST_PATTERN&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>head<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">__getitem__</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   1995</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_multilevel<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1996</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1997</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_column<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1998</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1999</span>     <span class=\"ansigreen\">def</span> _getitem_column<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_getitem_column</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   2002</span>         <span class=\"ansired\"># get column</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2003</span>         <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">.</span>is_unique<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2004</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_get_item_cache<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2005</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2006</span>         <span class=\"ansired\"># duplicate columns &amp; possible reduce dimensionality</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">_get_item_cache</span><span class=\"ansiblue\">(self, item)</span>\n<span class=\"ansigreen\">   1348</span>         res <span class=\"ansiyellow\">=</span> cache<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1349</span>         <span class=\"ansigreen\">if</span> res <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1350</span><span class=\"ansiyellow\">             </span>values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_data<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1351</span>             res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_box_item_values<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span> values<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1352</span>             cache<span class=\"ansiyellow\">[</span>item<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/internals.pyc</span> in <span class=\"ansicyan\">get</span><span class=\"ansiblue\">(self, item, fastpath)</span>\n<span class=\"ansigreen\">   3288</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3289</span>             <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> isnull<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 3290</span><span class=\"ansiyellow\">                 </span>loc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3291</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3292</span>                 indexer <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span>isnull<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/indexes/base.pyc</span> in <span class=\"ansicyan\">get_loc</span><span class=\"ansiblue\">(self, key, method, tolerance)</span>\n<span class=\"ansigreen\">   1945</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1946</span>             <span class=\"ansigreen\">except</span> KeyError<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1947</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_maybe_cast_indexer<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1948</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1949</span>         indexer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>get_indexer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>key<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> method<span class=\"ansiyellow\">=</span>method<span class=\"ansiyellow\">,</span> tolerance<span class=\"ansiyellow\">=</span>tolerance<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansired\">KeyError</span>: (&apos;CONFINEMENT&apos;, &apos;BLAST_PATTERN&apos;)</div>","workflows":[],"startTime":1493758796646,"submitTime":1493758759465,"finishTime":1493758796669,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49fac6e0-9617-4e53-a3d6-7a706ab59d2c"},{"version":"CommandV1","origId":2109564766429511,"guid":"bf49f7dd-d9fa-4183-b6aa-3829195c04fe","subtype":"command","commandType":"auto","position":6.999843597412109,"command":"#Make the labels lowercase and strip blank spaces\npDf['CONFINEMENT'] = pDf['CONFINEMENT'].apply(normalizeLabels)\npDf['BLAST_TYPE'] = pDf['BLAST_TYPE'].apply(normalizeLabels)\npDf['ROCK_TYPE'] = pDf['ROCK_TYPE'].apply(normalizeLabels)\npDf['EXPLOSIVE'] = pDf['EXPLOSIVE'].apply(normalizeLabels)\npDf['BLAST_PATTERN'] = pDf['BLAST_PATTERN'].apply(normalizeLabels)\npDf['INITIATION_TYPE'] = pDf['INITIATION_TYPE'].apply(normalizeLabels)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: expected string or buffer","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-77-8b3429cb8d2f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Make the labels lowercase and strip blank spaces</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;CONFINEMENT&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;CONFINEMENT&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>normalizeLabels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;BLAST_TYPE&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;BLAST_TYPE&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>normalizeLabels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;ROCK_TYPE&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;ROCK_TYPE&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>normalizeLabels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;EXPLOSIVE&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> pDf<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;EXPLOSIVE&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>normalizeLabels<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/series.pyc</span> in <span class=\"ansicyan\">apply</span><span class=\"ansiblue\">(self, func, convert_dtype, args, **kwds)</span>\n<span class=\"ansigreen\">   2218</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2219</span>             values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>asobject<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2220</span><span class=\"ansiyellow\">             </span>mapped <span class=\"ansiyellow\">=</span> lib<span class=\"ansiyellow\">.</span>map_infer<span class=\"ansiyellow\">(</span>values<span class=\"ansiyellow\">,</span> f<span class=\"ansiyellow\">,</span> convert<span class=\"ansiyellow\">=</span>convert_dtype<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2221</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2222</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>mapped<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">and</span> isinstance<span class=\"ansiyellow\">(</span>mapped<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> Series<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/lib.so</span> in <span class=\"ansicyan\">pandas.lib.map_infer (pandas/lib.c:62658)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">&lt;ipython-input-7-210c8ba19ebd&gt;</span> in <span class=\"ansicyan\">normalizeLabels</span><span class=\"ansiblue\">(label)</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># Normalize string labels by removing excessive whitespace in the middle of a word, shifting to lowercase, and removing any whitespace after the text</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">def</span> normalizeLabels<span class=\"ansiyellow\">(</span>label<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\">   </span><span class=\"ansigreen\">return</span> re<span class=\"ansiyellow\">.</span>sub<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;[ ]+&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos; &apos;</span><span class=\"ansiyellow\">,</span>label<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>lower<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>rstrip<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>lstrip<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/lib/python2.7/re.pyc</span> in <span class=\"ansicyan\">sub</span><span class=\"ansiblue\">(pattern, repl, string, count, flags)</span>\n<span class=\"ansigreen\">    153</span>     a callable<span class=\"ansiyellow\">,</span> it<span class=\"ansired\">&apos;</span>s passed the match object <span class=\"ansigreen\">and</span> must <span class=\"ansigreen\">return</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    154</span>     a replacement string to be used.&quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 155</span><span class=\"ansiyellow\">     </span><span class=\"ansigreen\">return</span> _compile<span class=\"ansiyellow\">(</span>pattern<span class=\"ansiyellow\">,</span> flags<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sub<span class=\"ansiyellow\">(</span>repl<span class=\"ansiyellow\">,</span> string<span class=\"ansiyellow\">,</span> count<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    156</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    157</span> <span class=\"ansigreen\">def</span> subn<span class=\"ansiyellow\">(</span>pattern<span class=\"ansiyellow\">,</span> repl<span class=\"ansiyellow\">,</span> string<span class=\"ansiyellow\">,</span> count<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> flags<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: expected string or buffer</div>","workflows":[],"startTime":1493758796676,"submitTime":1493758759512,"finishTime":1493758796769,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb030409-6d12-410c-9e38-f9d9e92c695f"},{"version":"CommandV1","origId":2109564766429512,"guid":"39e072b3-3803-4a3d-9267-3607ed85eabd","subtype":"command","commandType":"auto","position":6.999845504760742,"command":"#Confirm that the labels are normalized\npDf.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>\n  BLAST_LOC   RQD  FRACS_FREQ  IS_50     Q  PEN_RATE ROCK_TYPE  BLAST_TYPE  \\\n0    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n1    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n2    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n3    148-19  99.0         2.7   12.5  17.7  0.433426        kp  production   \n4    148-19  99.0         2.7   12.5  17.7  0.433426        pf  production   \n\n   DH_DELAY  HS_DELAY  ...    HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  \\\n0         0        42  ...          13.0           0.22                v   \n1         0        42  ...          13.0           0.22                v   \n2         0        42  ...          13.0           0.22                v   \n3         0        42  ...          13.0           0.22          echelon   \n4         0        42  ...          13.0           0.22          echelon   \n\n   CONFINEMENT  THREED_DIST    H_DIST    V_DIST   DIRECTION INCLINATION  HEAVE  \n0       choked     5.356509  3.383941  4.152244  137.227446   50.821102  2.910  \n1       choked     4.324379  3.559450  2.455721   43.964167   34.602412  4.969  \n2       choked     5.450931  2.459278  4.864628   52.268051   63.181441  4.477  \n3    free face     3.770577  3.582945  1.174629   38.552419   18.151168  3.609  \n4    free face     3.367295  3.261074  0.839091   61.540979   14.429488  3.514  \n\n[5 rows x 30 columns]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758796773,"submitTime":1493758759557,"finishTime":1493758796846,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c565cb1-b790-4ad5-8efd-99f7887c22db"},{"version":"CommandV1","origId":2109564766429513,"guid":"d22177b9-5aec-4af2-867a-e432f0010f85","subtype":"command","commandType":"auto","position":7.0,"command":"%md <a id=\"modeling\"></a>\n## 5.0) Modeling\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758759605,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"41589789-5a41-4a16-88a4-105aef7b967d"},{"version":"CommandV1","origId":2109564766429514,"guid":"383136f0-870c-445e-b159-63e35b2f7995","subtype":"command","commandType":"auto","position":7.375,"command":"%md\n### 5.1) Feature Extraction","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758759659,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80760e92-3fc4-4bd6-8e84-c9ae98bb8b78"},{"version":"CommandV1","origId":2109564766429515,"guid":"466edfa5-5377-49c2-982c-477ccc40225d","subtype":"command","commandType":"auto","position":7.4375,"command":"%md\nAccording to Hudaverdi [4] the ratios to be used for clustering are :\n* Spacing (S) / Burden (B)\n* Bench Height (H) / Burden (B)\n* Burden (B) / Hole Diameter (D)\n* Stemming (T) / Burden (B)\n* Subdrill (U) / Burden (B)\n* Powder Factor","commandVersion":0,"state":"finished","results":null,"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":null,"workflows":[],"startTime":0,"submitTime":1493758759714,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0858463e-32a0-43e6-ade3-5ca83c3ec3d4"},{"version":"CommandV1","origId":2109564766429516,"guid":"d14552ed-cd1c-44de-89b8-b2a6b26a42b6","subtype":"command","commandType":"auto","position":7.453125,"command":"%sql\nSELECT *\nFROM smry_bmm\nLIMIT 5","commandVersion":0,"state":"finished","results":{"type":"table","data":[["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",4,5.356508844,3.383941489,4.15224361,137.2274458,50.82110229,2.91],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",2,4.32437884,3.559450099,2.455721349,43.96416691,34.60241245,4.969],["148-10","F","",97.3,4.3,8.7,15.7,"148",0.428324195,"23/06/2016","KP","NA",0,0,262700,262700,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"V","Choked",1,5.450931245,2.459278349,4.864627575,52.26805117,63.1814408,4.477],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","KP","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",3,3.770576537,3.582944739,1.174629483,38.55241937,18.15116816,3.609],["148-19","H","",99.0,2.7,12.5,17.7,"148",0.433426233,"31/07/2016","PF","NA",0,0,318654,316854,"Production",0,42,100,216,12,6,7,4.5,0.0,"Fortis Extra-1.05","Staggered",0.0,13.0,"NA",0.22,"Echelon","Free Face",2,3.367295405,3.261074209,0.839090785,61.54097887,14.42948811,3.514]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"BLAST_LOC","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM1","type":"\"string\"","metadata":"{}"},{"name":"GEO_DOM2","type":"\"string\"","metadata":"{}"},{"name":"RQD","type":"\"double\"","metadata":"{}"},{"name":"FRACS_FREQ","type":"\"double\"","metadata":"{}"},{"name":"IS_50","type":"\"double\"","metadata":"{}"},{"name":"Q","type":"\"double\"","metadata":"{}"},{"name":"LEVEL","type":"\"string\"","metadata":"{}"},{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"},{"name":"BLAST_DATE","type":"\"string\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"string\"","metadata":"{}"},{"name":"MATERIAL","type":"\"string\"","metadata":"{}"},{"name":"HG_MG","type":"\"integer\"","metadata":"{}"},{"name":"LG","type":"\"integer\"","metadata":"{}"},{"name":"NAG","type":"\"integer\"","metadata":"{}"},{"name":"TOTAL_TONS","type":"\"integer\"","metadata":"{}"},{"name":"BLAST_TYPE","type":"\"string\"","metadata":"{}"},{"name":"DH_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"RS_DELAY","type":"\"integer\"","metadata":"{}"},{"name":"HOLE_DIA","type":"\"integer\"","metadata":"{}"},{"name":"BENCH_HEIGHT","type":"\"integer\"","metadata":"{}"},{"name":"BURDEN","type":"\"integer\"","metadata":"{}"},{"name":"SPACING","type":"\"integer\"","metadata":"{}"},{"name":"STEMMING","type":"\"double\"","metadata":"{}"},{"name":"SUB_DRILL","type":"\"double\"","metadata":"{}"},{"name":"EXPLOSIVE","type":"\"string\"","metadata":"{}"},{"name":"BLAST_PATTERN","type":"\"string\"","metadata":"{}"},{"name":"TOTAL_EXPLOSIVE","type":"\"double\"","metadata":"{}"},{"name":"HOLE_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"FIRING_DIRECTION","type":"\"string\"","metadata":"{}"},{"name":"POWDER_FACTOR","type":"\"double\"","metadata":"{}"},{"name":"INITIATION_TYPE","type":"\"string\"","metadata":"{}"},{"name":"CONFINEMENT","type":"\"string\"","metadata":"{}"},{"name":"BMM_NUM","type":"\"integer\"","metadata":"{}"},{"name":"THREED_DIST","type":"\"double\"","metadata":"{}"},{"name":"H_DIST","type":"\"double\"","metadata":"{}"},{"name":"V_DIST","type":"\"double\"","metadata":"{}"},{"name":"DIRECTION","type":"\"double\"","metadata":"{}"},{"name":"INCLINATION","type":"\"double\"","metadata":"{}"},{"name":"HEAVE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758796850,"submitTime":1493758759766,"finishTime":1493758797007,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a527bd96-0a30-4100-89f1-7dd1e882164a"},{"version":"CommandV1","origId":2109564766429517,"guid":"3719395e-b20e-4b76-93e2-d1bd9da2c5dd","subtype":"command","commandType":"auto","position":7.46875,"command":"#Calculate ratios\npDf['SB_ratio'] = pDf['SPACING'] / pDf['BURDEN']\npDf['HB_ratio'] = pDf['BENCH_HEIGHT'] / pDf['BURDEN']\npDf['BD_ratio'] = pDf['BURDEN'] / pDf['HOLE_DIA']\npDf['TB_ratio'] = pDf['STEMMING'] / pDf['BURDEN']\npDf['UB_ratio'] = pDf['SUB_DRILL'] / pDf['BURDEN']","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797012,"submitTime":1493758759811,"finishTime":1493758797084,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"041830fb-1bd3-44fe-a61c-9fdafad346af"},{"version":"CommandV1","origId":2109564766429518,"guid":"2d93d922-626f-403a-8e76-de79873dd115","subtype":"command","commandType":"auto","position":7.484375,"command":"#Inspect dataframe to ensure the ratios have been calculated\npd.set_option('display.max_columns', None)\npDf.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>\n  BLAST_LOC   RQD  FRACS_FREQ  IS_50     Q  PEN_RATE ROCK_TYPE  BLAST_TYPE  \\\n0    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n1    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n2    148-10  97.3         4.3    8.7  15.7  0.428324        kp  production   \n3    148-19  99.0         2.7   12.5  17.7  0.433426        kp  production   \n4    148-19  99.0         2.7   12.5  17.7  0.433426        pf  production   \n\n   DH_DELAY  HS_DELAY  RS_DELAY  HOLE_DIA  BENCH_HEIGHT  BURDEN  SPACING  \\\n0         0        42       100       216            12       6        7   \n1         0        42       100       216            12       6        7   \n2         0        42       100       216            12       6        7   \n3         0        42       100       216            12       6        7   \n4         0        42       100       216            12       6        7   \n\n   STEMMING  SUB_DRILL          EXPLOSIVE BLAST_PATTERN  TOTAL_EXPLOSIVE  \\\n0       4.5        0.0  fortis extra-1.05     staggered              0.0   \n1       4.5        0.0  fortis extra-1.05     staggered              0.0   \n2       4.5        0.0  fortis extra-1.05     staggered              0.0   \n3       4.5        0.0  fortis extra-1.05     staggered              0.0   \n4       4.5        0.0  fortis extra-1.05     staggered              0.0   \n\n   HOLE_DEPTH  POWDER_FACTOR INITIATION_TYPE CONFINEMENT  THREED_DIST  \\\n0        13.0           0.22               v      choked     5.356509   \n1        13.0           0.22               v      choked     4.324379   \n2        13.0           0.22               v      choked     5.450931   \n3        13.0           0.22         echelon   free face     3.770577   \n4        13.0           0.22         echelon   free face     3.367295   \n\n     H_DIST    V_DIST   DIRECTION  INCLINATION  HEAVE  SB_ratio  HB_ratio  \\\n0  3.383941  4.152244  137.227446    50.821102  2.910  1.166667       2.0   \n1  3.559450  2.455721   43.964167    34.602412  4.969  1.166667       2.0   \n2  2.459278  4.864628   52.268051    63.181441  4.477  1.166667       2.0   \n3  3.582945  1.174629   38.552419    18.151168  3.609  1.166667       2.0   \n4  3.261074  0.839091   61.540979    14.429488  3.514  1.166667       2.0   \n\n   BD_ratio  TB_ratio  UB_ratio  \n0  0.027778      0.75       0.0  \n1  0.027778      0.75       0.0  \n2  0.027778      0.75       0.0  \n3  0.027778      0.75       0.0  \n4  0.027778      0.75       0.0  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797088,"submitTime":1493758759854,"finishTime":1493758797161,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5aa6b08f-177c-4b71-bda0-98940b28b01b"},{"version":"CommandV1","origId":2109564766429519,"guid":"c452b0ab-9a3b-435b-ab42-67e8225e142a","subtype":"command","commandType":"auto","position":7.498046875,"command":"# Convert a label feature into an index number\ndef facorizeFeature(feat, df, labelDict):\n  # Convert string labels into an index number\n  labels, levels = pd.factorize(df[feat])\n  \n  # Add index numbers to main dataframe\n  df[feat] = labels\n  \n  # Store labels in dictionary for later reference\n  labelDict[feat] = levels\n  \n  return df, labelDict","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: len() of unsized object","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-32-bd7e566c3a18&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>lala_df<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;B_changed&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> lala_df<span class=\"ansiyellow\">.</span>B<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x <span class=\"ansiyellow\">:</span> pd<span class=\"ansiyellow\">.</span>factorize<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/series.pyc</span> in <span class=\"ansicyan\">apply</span><span class=\"ansiblue\">(self, func, convert_dtype, args, **kwds)</span>\n<span class=\"ansigreen\">   2218</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2219</span>             values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>asobject<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2220</span><span class=\"ansiyellow\">             </span>mapped <span class=\"ansiyellow\">=</span> lib<span class=\"ansiyellow\">.</span>map_infer<span class=\"ansiyellow\">(</span>values<span class=\"ansiyellow\">,</span> f<span class=\"ansiyellow\">,</span> convert<span class=\"ansiyellow\">=</span>convert_dtype<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2221</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2222</span>         <span class=\"ansigreen\">if</span> len<span class=\"ansiyellow\">(</span>mapped<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">and</span> isinstance<span class=\"ansiyellow\">(</span>mapped<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> Series<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/lib.so</span> in <span class=\"ansicyan\">pandas.lib.map_infer (pandas/lib.c:62658)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">&lt;ipython-input-32-bd7e566c3a18&gt;</span> in <span class=\"ansicyan\">&lt;lambda&gt;</span><span class=\"ansiblue\">(x)</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>lala_df<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;B_changed&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> lala_df<span class=\"ansiyellow\">.</span>B<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x <span class=\"ansiyellow\">:</span> pd<span class=\"ansiyellow\">.</span>factorize<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/algorithms.pyc</span> in <span class=\"ansicyan\">factorize</span><span class=\"ansiblue\">(values, sort, order, na_sentinel, size_hint)</span>\n<span class=\"ansigreen\">    181</span>     <span class=\"ansiyellow\">(</span>hash_klass<span class=\"ansiyellow\">,</span> vec_klass<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> vals <span class=\"ansiyellow\">=</span> _get_data_algo<span class=\"ansiyellow\">(</span>vals<span class=\"ansiyellow\">,</span> _hashtables<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    182</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 183</span><span class=\"ansiyellow\">     </span>table <span class=\"ansiyellow\">=</span> hash_klass<span class=\"ansiyellow\">(</span>size_hint <span class=\"ansigreen\">or</span> len<span class=\"ansiyellow\">(</span>vals<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    184</span>     uniques <span class=\"ansiyellow\">=</span> vec_klass<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    185</span>     labels <span class=\"ansiyellow\">=</span> table<span class=\"ansiyellow\">.</span>get_labels<span class=\"ansiyellow\">(</span>vals<span class=\"ansiyellow\">,</span> uniques<span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> na_sentinel<span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: len() of unsized object</div>","workflows":[],"startTime":1493758797165,"submitTime":1493758759901,"finishTime":1493758797204,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22e218f6-5668-4837-a457-5ba2e89dba28"},{"version":"CommandV1","origId":2109564766429520,"guid":"0b7deafd-6ad7-4b98-b537-9a3249e912a9","subtype":"command","commandType":"auto","position":7.498291015625,"command":"# Initalize label dictionary\nmLabelDict = {}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797207,"submitTime":1493758759946,"finishTime":1493758797231,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41c462c6-e4df-400d-a30b-0e50423de98b"},{"version":"CommandV1","origId":2109564766429521,"guid":"1e79098c-63fb-4e47-96cb-ec5c61e3d711","subtype":"command","commandType":"auto","position":7.4984283447265625,"command":"# Apply label normalization to data\npDf, mLabelDict = facorizeFeature('ROCK_TYPE', pDf, mLabelDict)\npDf, mLabelDict = facorizeFeature('BLAST_TYPE', pDf, mLabelDict)\npDf, mLabelDict = facorizeFeature('EXPLOSIVE', pDf, mLabelDict)\npDf, mLabelDict = facorizeFeature('BLAST_PATTERN', pDf, mLabelDict)\npDf, mLabelDict = facorizeFeature('INITIATION_TYPE', pDf, mLabelDict)\npDf, mLabelDict = facorizeFeature('CONFINEMENT', pDf, mLabelDict)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797233,"submitTime":1493758759992,"finishTime":1493758797272,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d0475c29-c9bd-4bbb-ac69-9ad117a58147"},{"version":"CommandV1","origId":2109564766429522,"guid":"5b6ba5a0-e615-4c5d-abd5-1dd707defb43","subtype":"command","commandType":"auto","position":7.498443603515625,"command":"#Check the dataframe to ensure strings have been factorized\npDf.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">19</span><span class=\"ansired\">]: </span>\n  BLAST_LOC   RQD  FRACS_FREQ  IS_50     Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  \\\n0    148-10  97.3         4.3    8.7  15.7  0.428324          0           0   \n1    148-10  97.3         4.3    8.7  15.7  0.428324          0           0   \n2    148-10  97.3         4.3    8.7  15.7  0.428324          0           0   \n3    148-19  99.0         2.7   12.5  17.7  0.433426          0           0   \n4    148-19  99.0         2.7   12.5  17.7  0.433426          1           0   \n\n   DH_DELAY  HS_DELAY  RS_DELAY  HOLE_DIA  BENCH_HEIGHT  BURDEN  SPACING  \\\n0         0        42       100       216            12       6        7   \n1         0        42       100       216            12       6        7   \n2         0        42       100       216            12       6        7   \n3         0        42       100       216            12       6        7   \n4         0        42       100       216            12       6        7   \n\n   STEMMING  SUB_DRILL  EXPLOSIVE  BLAST_PATTERN  TOTAL_EXPLOSIVE  HOLE_DEPTH  \\\n0       4.5        0.0          0              0              0.0        13.0   \n1       4.5        0.0          0              0              0.0        13.0   \n2       4.5        0.0          0              0              0.0        13.0   \n3       4.5        0.0          0              0              0.0        13.0   \n4       4.5        0.0          0              0              0.0        13.0   \n\n   POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  THREED_DIST    H_DIST  \\\n0           0.22                0            0     5.356509  3.383941   \n1           0.22                0            0     4.324379  3.559450   \n2           0.22                0            0     5.450931  2.459278   \n3           0.22                1            1     3.770577  3.582945   \n4           0.22                1            1     3.367295  3.261074   \n\n     V_DIST   DIRECTION  INCLINATION  HEAVE  SB_ratio  HB_ratio  BD_ratio  \\\n0  4.152244  137.227446    50.821102  2.910  1.166667       2.0  0.027778   \n1  2.455721   43.964167    34.602412  4.969  1.166667       2.0  0.027778   \n2  4.864628   52.268051    63.181441  4.477  1.166667       2.0  0.027778   \n3  1.174629   38.552419    18.151168  3.609  1.166667       2.0  0.027778   \n4  0.839091   61.540979    14.429488  3.514  1.166667       2.0  0.027778   \n\n   TB_ratio  UB_ratio  \n0      0.75       0.0  \n1      0.75       0.0  \n2      0.75       0.0  \n3      0.75       0.0  \n4      0.75       0.0  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797275,"submitTime":1493758760036,"finishTime":1493758797315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2389c416-d2e0-4bbc-95eb-8eeb9850fc3e"},{"version":"CommandV1","origId":2109564766429523,"guid":"c5450cfd-9f1b-4e3d-b256-0cb906f80374","subtype":"command","commandType":"auto","position":7.4992218017578125,"command":"#See the indexed labels\nmLabelDict","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">20</span><span class=\"ansired\">]: </span>\n{&apos;BLAST_PATTERN&apos;: Index([u&apos;staggered&apos;], dtype=&apos;object&apos;),\n &apos;BLAST_TYPE&apos;: Index([u&apos;production&apos;, u&apos;trim&apos;], dtype=&apos;object&apos;),\n &apos;CONFINEMENT&apos;: Index([u&apos;choked&apos;, u&apos;free face&apos;], dtype=&apos;object&apos;),\n &apos;EXPLOSIVE&apos;: Index([u&apos;fortis extra-1.05&apos;], dtype=&apos;object&apos;),\n &apos;INITIATION_TYPE&apos;: Index([u&apos;v&apos;, u&apos;echelon&apos;, u&apos;centre lift&apos;], dtype=&apos;object&apos;),\n &apos;ROCK_TYPE&apos;: Index([u&apos;kp&apos;, u&apos;pf&apos;, u&apos;mf&apos;, u&apos;km&apos;, u&apos;cb&apos;, u&apos;fv&apos;, u&apos;cg&apos;, u&apos;tc&apos;, u&apos;vc&apos;], dtype=&apos;object&apos;)}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;dict&apos; object has no attribute &apos;head&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-68-8b12993a9dfc&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>mLabelDict<span class=\"ansiyellow\">.</span>head<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;dict&apos; object has no attribute &apos;head&apos;</div>","workflows":[],"startTime":1493758797318,"submitTime":1493758760082,"finishTime":1493758797341,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4032e8e4-e9d1-48db-80e4-ce62af9a9ac7"},{"version":"CommandV1","origId":2109564766429524,"guid":"9669ffd9-7a10-4b8f-bb44-7d7f2057c30c","subtype":"command","commandType":"auto","position":7.546875,"command":"#Drop columns that are not required for the clustering process\nfeatures = pDf.drop(['BLAST_LOC','DIRECTION','INCLINATION','HEAVE'],1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797346,"submitTime":1493758760127,"finishTime":1493758797363,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f6ca1d7-a8e9-472a-a444-57cc184a8a79"},{"version":"CommandV1","origId":2109564766429525,"guid":"ef5e57b3-4c70-4731-949a-973b9f0ada23","subtype":"command","commandType":"auto","position":7.552734375,"command":"#Drop columns that include blast movement as these are outcomes \nfeatures.drop(['THREED_DIST','H_DIST', 'V_DIST'],1,inplace='true')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;true&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-35-6ba765e7c0df&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Drop columns that we are trying to predict</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>features<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;THREED_DIST&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;H_DIST&apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;V_DIST&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span>inplace<span class=\"ansiyellow\">=</span>true<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;true&apos; is not defined</div>","workflows":[],"startTime":1493758797366,"submitTime":1493758760171,"finishTime":1493758797389,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d7266172-2c12-4388-8eb3-9f2e73c447b4"},{"version":"CommandV1","origId":2109564766429526,"guid":"9f1a93b1-db7c-48c0-8a3a-8aef3e6ce766","subtype":"command","commandType":"auto","position":7.5556640625,"command":"#Drop columns that created ratios for\nfeatures.drop(['HOLE_DIA','BENCH_HEIGHT','BURDEN','SPACING','STEMMING','SUB_DRILL' ],1,inplace='true')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797393,"submitTime":1493758760216,"finishTime":1493758797415,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2daad68c-d20d-4021-aa53-a33cfd33db5d"},{"version":"CommandV1","origId":2109564766429527,"guid":"c5c1b88c-3af3-4cc7-b401-becffa3ec202","subtype":"command","commandType":"auto","position":7.55859375,"command":"#View the dataframe to ensure the correct columns are in place\nfeatures.tail()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">24</span><span class=\"ansired\">]: </span>\n       RQD  FRACS_FREQ  IS_50     Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  \\\n1389  93.2         5.7    8.3  14.3  0.775956          1           0   \n1390  93.2         5.7    8.3  14.3  0.775956          0           0   \n1439  80.0        13.0   11.0   7.0  0.509853          2           0   \n1440  80.0        13.0   11.0   7.0  0.509853          2           0   \n1441  80.0        13.0   11.0   7.0  0.509853          2           0   \n\n      DH_DELAY  HS_DELAY  RS_DELAY  EXPLOSIVE  BLAST_PATTERN  TOTAL_EXPLOSIVE  \\\n1389         0        42       100          0              0              0.0   \n1390         0        42       100          0              0              0.0   \n1439         0        42       100          0              0              0.0   \n1440         0        42       100          0              0              0.0   \n1441         0        42       100          0              0              0.0   \n\n      HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  SB_ratio  \\\n1389        13.0           0.23                0            1  1.166667   \n1390        13.0           0.23                0            1  1.166667   \n1439        13.0           0.22                0            1  1.166667   \n1440        13.0           0.22                0            1  1.166667   \n1441        13.0           0.22                0            1  1.166667   \n\n      HB_ratio  BD_ratio  TB_ratio  UB_ratio  \n1389       2.0  0.027778      0.75       0.0  \n1390       2.0  0.027778      0.75       0.0  \n1439       2.0  0.027778      0.75       0.0  \n1440       2.0  0.027778      0.75       0.0  \n1441       2.0  0.027778      0.75       0.0  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797418,"submitTime":1493758760260,"finishTime":1493758797491,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62268d65-6702-4b44-8a37-b7089ea2b5b1"},{"version":"CommandV1","origId":2109564766429528,"guid":"6415c67e-f2ab-4a5e-b5f4-bb5bc929e855","subtype":"command","commandType":"auto","position":7.560791015625,"command":"#Count the number of times that infinity occurs in the dataset\nnp.isinf(features).sum()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">25</span><span class=\"ansired\">]: </span>\nRQD                 0\nFRACS_FREQ          0\nIS_50               0\nQ                   0\nPEN_RATE            0\nROCK_TYPE           0\nBLAST_TYPE          0\nDH_DELAY            0\nHS_DELAY            0\nRS_DELAY            0\nEXPLOSIVE           0\nBLAST_PATTERN       0\nTOTAL_EXPLOSIVE     0\nHOLE_DEPTH          0\nPOWDER_FACTOR       0\nINITIATION_TYPE     0\nCONFINEMENT         0\nSB_ratio           34\nHB_ratio           41\nBD_ratio            0\nTB_ratio           41\nUB_ratio            0\ndtype: int64\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;isinf&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-72-e791c0090cd1&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>isinf<span class=\"ansiyellow\">(</span>features<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;isinf&apos; is not defined</div>","workflows":[],"startTime":1493758797496,"submitTime":1493758760303,"finishTime":1493758797537,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bcd0feed-8883-403b-8510-aedaf03345a1"},{"version":"CommandV1","origId":2109564766429529,"guid":"0445babe-f67b-41c0-9ed3-34239dfe95e7","subtype":"command","commandType":"auto","position":7.56298828125,"command":"#Check if the dataframe has any null values \nfeatures.isnull().sum()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">26</span><span class=\"ansired\">]: </span>\nRQD                 0\nFRACS_FREQ          0\nIS_50               0\nQ                   0\nPEN_RATE            0\nROCK_TYPE           0\nBLAST_TYPE          0\nDH_DELAY            0\nHS_DELAY            0\nRS_DELAY            0\nEXPLOSIVE           0\nBLAST_PATTERN       0\nTOTAL_EXPLOSIVE     0\nHOLE_DEPTH          0\nPOWDER_FACTOR       0\nINITIATION_TYPE     0\nCONFINEMENT         0\nSB_ratio            7\nHB_ratio            0\nBD_ratio            0\nTB_ratio            0\nUB_ratio           41\ndtype: int64\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;is_null&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-65-7b3dfc4c57e3&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>features<span class=\"ansiyellow\">.</span>is_null<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">__getattr__</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">   2670</span>             <span class=\"ansigreen\">if</span> name <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>_info_axis<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2671</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">[</span>name<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2672</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> object<span class=\"ansiyellow\">.</span>__getattribute__<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2673</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2674</span>     <span class=\"ansigreen\">def</span> __setattr__<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">,</span> value<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;is_null&apos;</div>","workflows":[],"startTime":1493758797541,"submitTime":1493758760348,"finishTime":1493758797564,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d9388db9-9297-43bb-8eb5-24bab6160c53"},{"version":"CommandV1","origId":2109564766429530,"guid":"0cb13048-5987-4532-825a-dd514821c635","subtype":"command","commandType":"auto","position":7.5640869140625,"command":"#Convert infinities to NaN's so they can all be handled together\nfeatures.replace(np.inf, np.nan,inplace='True')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797567,"submitTime":1493758760390,"finishTime":1493758797589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31e94683-f6ce-4376-a49a-10607344e74c"},{"version":"CommandV1","origId":2109564766429531,"guid":"b986d80d-7142-4f97-ba15-a3360af86990","subtype":"command","commandType":"auto","position":7.56463623046875,"command":"#Confirm infinities are removed\nnp.isinf(features).sum()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">28</span><span class=\"ansired\">]: </span>\nRQD                0\nFRACS_FREQ         0\nIS_50              0\nQ                  0\nPEN_RATE           0\nROCK_TYPE          0\nBLAST_TYPE         0\nDH_DELAY           0\nHS_DELAY           0\nRS_DELAY           0\nEXPLOSIVE          0\nBLAST_PATTERN      0\nTOTAL_EXPLOSIVE    0\nHOLE_DEPTH         0\nPOWDER_FACTOR      0\nINITIATION_TYPE    0\nCONFINEMENT        0\nSB_ratio           0\nHB_ratio           0\nBD_ratio           0\nTB_ratio           0\nUB_ratio           0\ndtype: int64\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">KeyError</span>: &apos;SB_Ratio&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-78-bd5c0385b548&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>features<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;SB_Ratio&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">__getitem__</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   1995</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_multilevel<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1996</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1997</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_column<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1998</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1999</span>     <span class=\"ansigreen\">def</span> _getitem_column<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_getitem_column</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   2002</span>         <span class=\"ansired\"># get column</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2003</span>         <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">.</span>is_unique<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2004</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_get_item_cache<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2005</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2006</span>         <span class=\"ansired\"># duplicate columns &amp; possible reduce dimensionality</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">_get_item_cache</span><span class=\"ansiblue\">(self, item)</span>\n<span class=\"ansigreen\">   1348</span>         res <span class=\"ansiyellow\">=</span> cache<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1349</span>         <span class=\"ansigreen\">if</span> res <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1350</span><span class=\"ansiyellow\">             </span>values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_data<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1351</span>             res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_box_item_values<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span> values<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1352</span>             cache<span class=\"ansiyellow\">[</span>item<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/internals.pyc</span> in <span class=\"ansicyan\">get</span><span class=\"ansiblue\">(self, item, fastpath)</span>\n<span class=\"ansigreen\">   3288</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3289</span>             <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> isnull<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 3290</span><span class=\"ansiyellow\">                 </span>loc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3291</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3292</span>                 indexer <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span>isnull<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/indexes/base.pyc</span> in <span class=\"ansicyan\">get_loc</span><span class=\"ansiblue\">(self, key, method, tolerance)</span>\n<span class=\"ansigreen\">   1945</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1946</span>             <span class=\"ansigreen\">except</span> KeyError<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1947</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_maybe_cast_indexer<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1948</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1949</span>         indexer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>get_indexer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>key<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> method<span class=\"ansiyellow\">=</span>method<span class=\"ansiyellow\">,</span> tolerance<span class=\"ansiyellow\">=</span>tolerance<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansired\">KeyError</span>: &apos;SB_Ratio&apos;</div>","workflows":[],"startTime":1493758797592,"submitTime":1493758760433,"finishTime":1493758797615,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38cb64d4-58fd-426e-957f-48cbed41ca8f"},{"version":"CommandV1","origId":2109564766429532,"guid":"5ff1a2a3-0b15-454a-b8b5-37827fc499f1","subtype":"command","commandType":"auto","position":7.565185546875,"command":"#Remove the NaN rows from the dataframe\nfeatures.dropna(inplace='True')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797618,"submitTime":1493758760477,"finishTime":1493758797641,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4191e54-e7c3-43c1-8363-d45b88a3174e"},{"version":"CommandV1","origId":2109564766429533,"guid":"180cf61c-c3ad-4bf6-bf49-77eb030bc268","subtype":"command","commandType":"auto","position":7.56573486328125,"command":"#Check the shape of the features dataframe now that the NaN's have been dropped\nfeatures.shape","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">30</span><span class=\"ansired\">]: </span>(217, 22)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797644,"submitTime":1493758760520,"finishTime":1493758797667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83d0137e-7e5e-4f9f-9370-1ae7a70d5fbe"},{"version":"CommandV1","origId":2109564766429534,"guid":"c5d8bc55-10ad-4a1c-8802-3f75401d2bd7","subtype":"command","commandType":"auto","position":7.57232666015625,"command":"#Create a list of the features \nfeaturesList = list(features)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758797670,"submitTime":1493758760563,"finishTime":1493758797708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"faad0ecd-2803-402b-b2f8-61a7fd79fc3b"},{"version":"CommandV1","origId":2109564766429535,"guid":"68b141fd-806e-4238-8ec7-04b9b70e0e45","subtype":"command","commandType":"auto","position":7.57562255859375,"command":"#Let's see the features list to ensure it has all the features we want\nfeaturesList","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">32</span><span class=\"ansired\">]: </span>\n[&apos;RQD&apos;,\n &apos;FRACS_FREQ&apos;,\n &apos;IS_50&apos;,\n &apos;Q&apos;,\n &apos;PEN_RATE&apos;,\n &apos;ROCK_TYPE&apos;,\n &apos;BLAST_TYPE&apos;,\n &apos;DH_DELAY&apos;,\n &apos;HS_DELAY&apos;,\n &apos;RS_DELAY&apos;,\n &apos;EXPLOSIVE&apos;,\n &apos;BLAST_PATTERN&apos;,\n &apos;TOTAL_EXPLOSIVE&apos;,\n &apos;HOLE_DEPTH&apos;,\n &apos;POWDER_FACTOR&apos;,\n &apos;INITIATION_TYPE&apos;,\n &apos;CONFINEMENT&apos;,\n &apos;SB_ratio&apos;,\n &apos;HB_ratio&apos;,\n &apos;BD_ratio&apos;,\n &apos;TB_ratio&apos;,\n &apos;UB_ratio&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;shape&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-66-a4f9a5926aba&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>featuresList<span class=\"ansiyellow\">.</span>shape<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;shape&apos;</div>","workflows":[],"startTime":1493758797711,"submitTime":1493758760604,"finishTime":1493758797749,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98b9d77a-1625-451e-9647-5f05cc649ea3"},{"version":"CommandV1","origId":2109564766429536,"guid":"421321be-4915-4e6d-a731-d08f214f5167","subtype":"command","commandType":"auto","position":7.57891845703125,"command":"%md\n### 5.2) Train the Model - Base Case  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758760646,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07b9a30b-5eb5-40f1-b976-72258b9f9536"},{"version":"CommandV1","origId":2109564766429537,"guid":"6aafa38c-0224-4450-8edf-d2d852c8cdf4","subtype":"command","commandType":"auto","position":7.586334228515625,"command":"%md\nThe first iteration of the model involves trialling with all the initial set of data and with a randomly selected k. The results from this assessment are not representative of the true clustering.\n\nThe parameters to be used are those as default in the spark.mllib implementation guide. Max iterations have been increased to 100, and the initialization mode is kept as random.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758760718,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c686faa-3408-46ad-8805-4701273c4cb4"},{"version":"CommandV1","origId":2109564766429538,"guid":"5a3b972d-ce7a-4763-8248-333f3ccf5aa4","subtype":"command","commandType":"auto","position":7.59375,"command":"#Import necessary libraries \nfrom pyspark.mllib.clustering import KMeans, KMeansModel\nfrom numpy import array\nfrom math import sqrt\nfrom pyspark.mllib.stat import Statistics\nfrom matplotlib import pyplot as plt\nfrom scipy.cluster.hierarchy import dendrogram, linkage\nimport numpy as np\nfrom sklearn import cluster\nfrom pyspark.mllib.util import MLUtils\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.mllib.feature import StandardScaler","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1493758797753,"submitTime":1493758760767,"finishTime":1493758798132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0550a20f-5962-45b6-981e-09097b53f9da"},{"version":"CommandV1","origId":2109564766429539,"guid":"111e8459-a9af-4114-be70-bc9d5d753060","subtype":"command","commandType":"auto","position":7.60546875,"command":"#Parse the features pandas dataframe into an RDD of features which will be input into the model\nfeaturesRDD = sqlContext.createDataFrame(features).rdd.map(lambda row: np.array([float(item) for item in row]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758798136,"submitTime":1493758760809,"finishTime":1493758798307,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40670772-f60f-41dd-8d2d-b1c2089458b6"},{"version":"CommandV1","origId":2109564766429540,"guid":"d4600ca2-8661-4a08-8145-a8d4c2f08016","subtype":"command","commandType":"auto","position":7.6875,"command":"#Let's see some summary statistics of the Features RDD\nsummary = Statistics.colStats(featuresRDD)\nprint(summary.mean())  # a dense vector containing the mean value for each column\nprint(summary.variance())  # column-wise variance\nprint(summary.numNonzeros())  # number of nonzeros in each column","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[  9.70115207e+01   3.40138249e+00   9.46451613e+00   1.90506912e+01\n   7.24714405e-01   1.76497696e+00   1.01382488e-01   0.00000000e+00\n   4.20000000e+01   1.00000000e+02   0.00000000e+00   0.00000000e+00\n   1.57868341e+04   1.22811060e+01   2.24543779e-01   3.17972350e-01\n   6.45161290e-01   1.16728111e+00   2.00737327e+00   2.76924390e-02\n   7.52764977e-01   2.30414747e-03]\n[  1.19858389e+01   2.43272956e+00   2.47572581e+00   3.72483444e+01\n   4.67151816e-01   2.10654549e+00   9.15258577e-02   0.00000000e+00\n   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00\n   2.75100622e+09   8.86968766e+00   3.35314047e-04   2.54906981e-01\n   2.29988053e-01   2.01968482e-05   2.90834613e-03   3.89599694e-07\n   4.08986175e-04   3.80468794e-04]\n[ 217.  217.  217.  217.  217.  174.   22.    0.  217.  217.    0.    0.\n   20.  205.  217.   65.  140.  217.  217.  217.  217.    3.]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":null,"workflows":[],"startTime":1493758798311,"submitTime":1493758761016,"finishTime":1493758798986,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d33e8eaa-35fb-4b1c-9f73-0d708dc66b64"},{"version":"CommandV1","origId":2109564766429541,"guid":"b71d11f6-9daf-4583-81e1-399bd7f69c95","subtype":"command","commandType":"auto","position":7.703125,"command":"%md\nAs it can be seen - several columns have a variance of 0, indicating that these columns will likely not add substantially to the clustering. The columns are columns 8 - 12. In later iterations, these columns will be removed. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761057,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66f33634-50c8-4de8-8314-b63a45155e4b"},{"version":"CommandV1","origId":2109564766429542,"guid":"e29128a7-f929-4796-a578-974c873fe59e","subtype":"command","commandType":"auto","position":7.71875,"command":"#Train the clustering algorithm using the Features RDD. Try with 4 clusters in the first iteration.\nclusters = KMeans.train(featuresRDD, 4, maxIterations=100, initializationMode=\"random\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758798992,"submitTime":1493758761106,"finishTime":1493758799777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2f7e5985-e446-4aa1-b46c-2326f6e443a8"},{"version":"CommandV1","origId":2109564766429543,"guid":"53543782-cf00-4e51-9a97-05d480993383","subtype":"command","commandType":"auto","position":7.75,"command":"# Evaluate clustering by computing Within Set Sum of Squared Errors\ndef error(point):\n    center = clusters.centers[clusters.predict(point)]\n    return sqrt(sum([x**2 for x in (point - center)]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;parsedData&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-40-f6c06adaf556&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      4</span>     <span class=\"ansigreen\">return</span> sqrt<span class=\"ansiyellow\">(</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>x<span class=\"ansiyellow\">**</span><span class=\"ansicyan\">2</span> <span class=\"ansigreen\">for</span> x <span class=\"ansigreen\">in</span> <span class=\"ansiyellow\">(</span>point <span class=\"ansiyellow\">-</span> center<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 6</span><span class=\"ansiyellow\"> </span>WSSSE <span class=\"ansiyellow\">=</span> parsedData<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> point<span class=\"ansiyellow\">:</span> error<span class=\"ansiyellow\">(</span>point<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduce<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">,</span> y<span class=\"ansiyellow\">:</span> x <span class=\"ansiyellow\">+</span> y<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Within Set Sum of Squared Error = &quot;</span> <span class=\"ansiyellow\">+</span> str<span class=\"ansiyellow\">(</span>WSSSE<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;parsedData&apos; is not defined</div>","workflows":[],"startTime":1493758799782,"submitTime":1493758761147,"finishTime":1493758799822,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"86df2d6c-6d74-4cb9-90a6-10193859e4ab"},{"version":"CommandV1","origId":2109564766429544,"guid":"15e33a7a-ed95-4e64-b374-cee7f768c2d1","subtype":"command","commandType":"auto","position":7.8125,"command":"#Computer the error \nWSSSE = featuresRDD.map(lambda point: error(point)).reduce(lambda x, y: x + y)\nprint(\"Within Set Sum of Squared Error = \" + str(WSSSE))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Within Set Sum of Squared Error = 696626.830705\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758799826,"submitTime":1493758761190,"finishTime":1493758799999,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8b57b81-dbf4-45f6-8771-c88944dfe093"},{"version":"CommandV1","origId":2109564766429545,"guid":"63cd71b3-3e3a-4f6e-8f45-24f48e783e9e","subtype":"command","commandType":"auto","position":7.88818359375,"command":"#Let's look at the coordinates of the centre points of the clusters, to help understand which features are the most discriminatory. \nd = clusters.clusterCenters\nclusterDf = pd.DataFrame(d)\n#Pass the feautures list as column labels \nclusterDf.columns = featuresList","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AssertionError</span>: 12 columns passed, passed data had 22 columns","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AssertionError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-73-079bc1be10c0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>pd<span class=\"ansiyellow\">.</span>DataFrame<span class=\"ansiyellow\">(</span>d<span class=\"ansiyellow\">,</span>columns<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;featuresList&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">__init__</span><span class=\"ansiblue\">(self, data, index, columns, dtype, copy)</span>\n<span class=\"ansigreen\">    261</span>                     <span class=\"ansigreen\">if</span> com<span class=\"ansiyellow\">.</span>is_named_tuple<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">and</span> columns <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    262</span>                         columns <span class=\"ansiyellow\">=</span> data<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>_fields<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 263</span><span class=\"ansiyellow\">                     </span>arrays<span class=\"ansiyellow\">,</span> columns <span class=\"ansiyellow\">=</span> _to_arrays<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> columns<span class=\"ansiyellow\">,</span> dtype<span class=\"ansiyellow\">=</span>dtype<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    264</span>                     columns <span class=\"ansiyellow\">=</span> _ensure_index<span class=\"ansiyellow\">(</span>columns<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    265</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_to_arrays</span><span class=\"ansiblue\">(data, columns, coerce_float, dtype)</span>\n<span class=\"ansigreen\">   5372</span>         data <span class=\"ansiyellow\">=</span> lmap<span class=\"ansiyellow\">(</span>tuple<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5373</span>         return _list_to_arrays(data, columns, coerce_float=coerce_float,\n<span class=\"ansigreen\">-&gt; 5374</span><span class=\"ansiyellow\">                                dtype=dtype)\n</span><span class=\"ansigreen\">   5375</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5376</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_list_to_arrays</span><span class=\"ansiblue\">(data, columns, coerce_float, dtype)</span>\n<span class=\"ansigreen\">   5429</span>         content <span class=\"ansiyellow\">=</span> list<span class=\"ansiyellow\">(</span>lib<span class=\"ansiyellow\">.</span>to_object_array<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>T<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5430</span>     return _convert_object_array(content, columns, dtype=dtype,\n<span class=\"ansigreen\">-&gt; 5431</span><span class=\"ansiyellow\">                                  coerce_float=coerce_float)\n</span><span class=\"ansigreen\">   5432</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5433</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_convert_object_array</span><span class=\"ansiblue\">(content, columns, coerce_float, dtype)</span>\n<span class=\"ansigreen\">   5487</span>             <span class=\"ansired\"># caller&apos;s responsibility to check for this...</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5488</span>             raise AssertionError(&apos;%d columns passed, passed data had %s &apos;\n<span class=\"ansigreen\">-&gt; 5489</span><span class=\"ansiyellow\">                                  &apos;columns&apos; % (len(columns), len(content)))\n</span><span class=\"ansigreen\">   5490</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   5491</span>     <span class=\"ansired\"># provide soft conversion of object dtypes</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AssertionError</span>: 12 columns passed, passed data had 22 columns</div>","workflows":[],"startTime":1493758800003,"submitTime":1493758761231,"finishTime":1493758800030,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1bb8c6e0-6866-4ba3-8e34-5da503ae0cc8"},{"version":"CommandV1","origId":2109564766429546,"guid":"ba4255b3-0f31-4fa3-9206-2b41af165495","subtype":"command","commandType":"auto","position":7.895751953125,"command":"#View the cluster centre coordinates for all four clusters\nclusterDf","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">40</span><span class=\"ansired\">]: </span>\n         RQD  FRACS_FREQ     IS_50          Q  PEN_RATE  ROCK_TYPE  \\\n0  96.874112    3.447716  9.525381  18.469036  0.647621   1.817259   \n1  98.200000    3.111765  9.070588  25.447059  1.664899   1.235294   \n2  99.300000    2.000000  7.700000  21.000000  0.459479   1.333333   \n\n   BLAST_TYPE  DH_DELAY  HS_DELAY  RS_DELAY  EXPLOSIVE  BLAST_PATTERN  \\\n0    0.096447       0.0      42.0     100.0        0.0            0.0   \n1    0.000000       0.0      42.0     100.0        0.0            0.0   \n2    1.000000       0.0      42.0     100.0        0.0            0.0   \n\n   TOTAL_EXPLOSIVE  HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  \\\n0         0.000000   12.208122       0.225005         0.294416     0.670051   \n1    187665.588235   13.000000       0.220000         0.470588     0.294118   \n2     78476.000000   13.000000       0.220000         1.000000     1.000000   \n\n   SB_ratio  HB_ratio  BD_ratio  TB_ratio  UB_ratio  \n0  1.167343  2.008122  0.027684  0.753046  0.000000  \n1  1.166667  2.000000  0.027778  0.750000  0.029412  \n2  1.166667  2.000000  0.027778  0.750000  0.000000  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758800034,"submitTime":1493758761274,"finishTime":1493758800109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1db1618b-740e-4ab7-96b8-ffd2d00acd41"},{"version":"CommandV1","origId":2109564766429547,"guid":"69222230-957a-4c9c-b085-fd5d1cb6ef9c","subtype":"command","commandType":"auto","position":7.9033203125,"command":"#View a stastical summary of the cluster centre coordinates\nclusterDf.describe()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">41</span><span class=\"ansired\">]: </span>\n             RQD  FRACS_FREQ     IS_50          Q  PEN_RATE  ROCK_TYPE  \\\ncount   3.000000    3.000000  3.000000   3.000000  3.000000   3.000000   \nmean   98.124704    2.853160  8.765323  21.638698  0.924000   1.461962   \nstd     1.214696    0.757712  0.950207   3.532585  0.648497   0.311576   \nmin    96.874112    2.000000  7.700000  18.469036  0.459479   1.235294   \n25%    97.537056    2.555882  8.385294  19.734518  0.553550   1.284314   \n50%    98.200000    3.111765  9.070588  21.000000  0.647621   1.333333   \n75%    98.750000    3.279740  9.297984  23.223529  1.156260   1.575296   \nmax    99.300000    3.447716  9.525381  25.447059  1.664899   1.817259   \n\n       BLAST_TYPE  DH_DELAY  HS_DELAY      RS_DELAY  EXPLOSIVE  BLAST_PATTERN  \\\ncount    3.000000       3.0       3.0  3.000000e+00        3.0            3.0   \nmean     0.365482       0.0      42.0  1.000000e+02        0.0            0.0   \nstd      0.551620       0.0       0.0  1.004859e-14        0.0            0.0   \nmin      0.000000       0.0      42.0  1.000000e+02        0.0            0.0   \n25%      0.048223       0.0      42.0  1.000000e+02        0.0            0.0   \n50%      0.096447       0.0      42.0  1.000000e+02        0.0            0.0   \n75%      0.548223       0.0      42.0  1.000000e+02        0.0            0.0   \nmax      1.000000       0.0      42.0  1.000000e+02        0.0            0.0   \n\n       TOTAL_EXPLOSIVE  HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  \\\ncount         3.000000    3.000000       3.000000         3.000000   \nmean      88713.862745   12.736041       0.221668         0.588335   \nstd       94250.748682    0.457191       0.002890         0.367233   \nmin           0.000000   12.208122       0.220000         0.294416   \n25%       39238.000000   12.604061       0.220000         0.382502   \n50%       78476.000000   13.000000       0.220000         0.470588   \n75%      133070.794118   13.000000       0.222503         0.735294   \nmax      187665.588235   13.000000       0.225005         1.000000   \n\n       CONFINEMENT  SB_ratio  HB_ratio  BD_ratio  TB_ratio  UB_ratio  \ncount     3.000000  3.000000  3.000000  3.000000  3.000000  3.000000  \nmean      0.654723  1.166892  2.002707  0.027746  0.751015  0.009804  \nstd       0.353191  0.000391  0.004689  0.000054  0.001758  0.016981  \nmin       0.294118  1.166667  2.000000  0.027684  0.750000  0.000000  \n25%       0.482084  1.166667  2.000000  0.027731  0.750000  0.000000  \n50%       0.670051  1.166667  2.000000  0.027778  0.750000  0.000000  \n75%       0.835025  1.167005  2.004061  0.027778  0.751523  0.014706  \nmax       1.000000  1.167343  2.008122  0.027778  0.753046  0.029412  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">ValueError</span>: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-60-ff6f221b980f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> rff <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>parallelize<span class=\"ansiyellow\">(</span>d<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>spark<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>rff<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">createDataFrame</span><span class=\"ansiblue\">(self, data, schema, samplingRatio, verifySchema)</span>\n<span class=\"ansigreen\">    522</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    523</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> RDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 524</span><span class=\"ansiyellow\">             </span>rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromRDD<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    525</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    526</span>             rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromLocal<span class=\"ansiyellow\">(</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_createFromRDD</span><span class=\"ansiblue\">(self, rdd, schema, samplingRatio)</span>\n<span class=\"ansigreen\">    362</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    363</span>         <span class=\"ansigreen\">if</span> schema <span class=\"ansigreen\">is</span> None <span class=\"ansigreen\">or</span> isinstance<span class=\"ansiyellow\">(</span>schema<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span>list<span class=\"ansiyellow\">,</span> tuple<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 364</span><span class=\"ansiyellow\">             </span>struct <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_inferSchema<span class=\"ansiyellow\">(</span>rdd<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    365</span>             converter <span class=\"ansiyellow\">=</span> _create_converter<span class=\"ansiyellow\">(</span>struct<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    366</span>             rdd <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>converter<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_inferSchema</span><span class=\"ansiblue\">(self, rdd, samplingRatio)</span>\n<span class=\"ansigreen\">    334</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    335</span>         first <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>first<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 336</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> first<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    337</span>             raise ValueError(&quot;The first row in RDD is empty, &quot;\n<span class=\"ansigreen\">    338</span>                              &quot;can not infer schema&quot;)\n\n<span class=\"ansired\">ValueError</span>: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</div>","workflows":[],"startTime":1493758800114,"submitTime":1493758761316,"finishTime":1493758800237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b5c51dc7-04f7-4a92-bf4f-043ec8927acd"},{"version":"CommandV1","origId":2109564766429548,"guid":"dfb9a39a-4e54-4f3c-bc21-53ed29471517","subtype":"command","commandType":"auto","position":7.91845703125,"command":"%md\nWithout normalization of the data, it's not very useful to describe mean and distribution of the data. However, based on an visual inspection of the features, the following features appear to be the most important in determining clusters, based on the differences between their cluster coordinates:\n* FRACS_FREQ\n* IS_50\n* Q\n* PEN_RATE\n\nMost of the blast parameters have very similar cluster centre coordinates. This indicates that the blast parameters are not very useful in helping to determine cluster assignments. \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761358,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cda7c508-8f24-4fdf-8356-13dbcaba10a0"},{"version":"CommandV1","origId":2109564766429549,"guid":"d248405c-d843-485d-bcde-c82e2a7c7a5f","subtype":"command","commandType":"auto","position":7.926025390625,"command":"%md <a id=\"evaluation\"></a>\n## 6.0) Alternative Iterations of Clustering","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761420,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5becb400-e0ab-46a8-9005-04538f9d0da0"},{"version":"CommandV1","origId":2109564766429550,"guid":"a4f2e038-c1ee-44aa-ad47-76a8740f8ab8","subtype":"command","commandType":"auto","position":7.93359375,"command":"%md\n### 6.1) Increasing K Sequentially ","commandVersion":0,"state":"finished","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":0,"submitTime":1493758761480,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bac9fd77-c636-489d-b874-1f6f715940a5"},{"version":"CommandV1","origId":2109564766429551,"guid":"fc69bdff-62eb-4471-adda-3bbfba609298","subtype":"command","commandType":"auto","position":7.94189453125,"command":"%md\nIn order to evaluate the best number of clusters, the Elbow Method approach is carried out. Starting from k=1, the K-means algorithm is run on the same dataset with increasing k and observing the value of the cost function WSSE. The number of clusters selected should be 1 greater than the 'elbow' on the graph, indicating the biggest drop of WSSE.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761541,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15f01eaa-d56a-4397-9f0b-5fec651d304c"},{"version":"CommandV1","origId":2109564766429552,"guid":"d9e2da83-5597-41cb-8eb6-8204f8d5b579","subtype":"command","commandType":"auto","position":7.9501953125,"command":"#Initialize the empty array\ncluster_elbow = []\nerrorGraph = []","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758800240,"submitTime":1493758761592,"finishTime":1493758800278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"736c1798-3340-4724-b079-ec5552820f87"},{"version":"CommandV1","origId":2109564766429553,"guid":"3f8bbdf3-3af9-45d7-a5ca-95f79a3a9719","subtype":"command","commandType":"auto","position":7.95849609375,"command":"#Define the function which will be used to compute the cost for each iteration\ndef error_iter(clusters_iter, point):\n    center = clusters_iter.centers[clusters_iter.predict(point)]\n    return sqrt(sum([x**2 for x in (point - center)]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758800282,"submitTime":1493758761634,"finishTime":1493758800319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b67170b-8707-4201-8d04-bb3b579855e4"},{"version":"CommandV1","origId":2109564766429554,"guid":"f07324d2-9eb6-4f85-ae4d-5a03e1cd6e67","subtype":"command","commandType":"auto","position":7.966796875,"command":"#define function to compute WSSE as K increases sequentially \ndef num_k_iter(num_k, fRDD):\n    for k in range(1,num_k):\n      #Train the model, with k increasing from 1 to entered value\n      clusters_iter = KMeans.train(fRDD, k, maxIterations=100, initializationMode=\"random\")\n      #Calculate the WSSE errors for each k\n      WSSE_iter = fRDD.map(lambda point: error_iter(clusters_iter, point)).reduce(lambda x, y: x + y) \n      #Append it to an initialized list   \n      errorGraph.append([k,WSSE_iter])   ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">IndentationError</span><span class=\"ansired\">:</span> expected an indented block","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-124-7cd9baee4102&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">6</span>\n<span class=\"ansiyellow\">    clusters_iter = KMeans.train(fRDD, k, maxIterations=100, initializationMode=&quot;random&quot;)</span>\n<span class=\"ansigrey\">                ^</span>\n<span class=\"ansired\">IndentationError</span><span class=\"ansired\">:</span> expected an indented block\n</div>","workflows":[],"startTime":1493758800322,"submitTime":1493758761675,"finishTime":1493758800361,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d8daec2-a437-4e07-8756-2b9d1c6ea87f"},{"version":"CommandV1","origId":2109564766429555,"guid":"39ea3161-a7b0-4090-93d5-db39ddc03084","subtype":"command","commandType":"auto","position":7.9833984375,"command":"#Let's try out the funcion with k from 1 to 10\nnum_k_iter(10,featuresRDD)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: append() takes exactly one argument (2 given)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-76-425da42dcfae&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>num_k_iter<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">6</span><span class=\"ansiyellow\">,</span>featuresRDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-75-fd342c7b6c5c&gt;</span> in <span class=\"ansicyan\">num_k_iter</span><span class=\"ansiblue\">(num_k, fRDD)</span>\n<span class=\"ansigreen\">      7</span>     WSSE <span class=\"ansiyellow\">=</span> featuresRDD<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> point<span class=\"ansiyellow\">:</span> error<span class=\"ansiyellow\">(</span>point<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduce<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">,</span> y<span class=\"ansiyellow\">:</span> x <span class=\"ansiyellow\">+</span> y<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 9</span><span class=\"ansiyellow\">     </span>cluster_elbow<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>k<span class=\"ansiyellow\">,</span>WSSE<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: append() takes exactly one argument (2 given)</div>","workflows":[],"startTime":1493758800364,"submitTime":1493758761716,"finishTime":1493758805598,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c85a204a-dfe9-4da4-a313-90cf6bd8a4b2"},{"version":"CommandV1","origId":2109564766429556,"guid":"2813f8f0-37ee-465d-8fec-c6a8af5ffe87","subtype":"command","commandType":"auto","position":7.99169921875,"command":"#Let's see what's in the Cluster Elbow array\ncluster_elbow = errorGraph","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;errorGraph&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-121-545e99459095&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Let&apos;s see what&apos;s in the Cluster Elbow array</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>cluster_elbow <span class=\"ansiyellow\">=</span> errorGraph<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;errorGraph&apos; is not defined</div>","workflows":[],"startTime":1493758805605,"submitTime":1493758761759,"finishTime":1493758805645,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3aa478df-96b8-46cc-912e-fb385c1b65da"},{"version":"CommandV1","origId":2109564766429557,"guid":"332f42a0-8c61-4ddf-9aa8-4dbcf35f2860","subtype":"command","commandType":"auto","position":7.995849609375,"command":"#Create a dataframe so we can viusalize the Cluster Elbow graph\ncluster_df = sqlContext.createDataFrame(cluster_elbow)\ncluster_df.createOrReplaceTempView('elbows')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Table or view not found: cluster_df; line 1 pos 14&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-99-24028b3f1b63&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> cluster_df <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>cluster_elbow<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>df_test <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;SELECT * FROM cluster_df&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.py</span> in <span class=\"ansicyan\">sql</span><span class=\"ansiblue\">(self, sqlQuery)</span>\n<span class=\"ansigreen\">    543</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row1&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row2&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>f1<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">,</span> f2<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;row3&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    544</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 545</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsparkSession<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span>sqlQuery<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_wrapped<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    546</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    547</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Table or view not found: cluster_df; line 1 pos 14&apos;</div>","workflows":[],"startTime":1493758805649,"submitTime":1493758761800,"finishTime":1493758805719,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5de5cc1-87ab-4dc7-9bef-431ca5947444"},{"version":"CommandV1","origId":2109564766429558,"guid":"d4b08971-3c3a-4954-94ec-0e353637faf0","subtype":"command","commandType":"auto","position":7.99688720703125,"command":"%sql -- Plot the number of K vs. the WSSE\nSELECT _1 as NumK, _2 as WSSSE\nFROM elbows","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,6220013.043219018],[2,1159149.1128610726],[3,696626.8307051482],[4,696626.8307051482],[5,696465.7881098283],[6,696465.7881098283],[7,696185.792347747],[8,696231.0668227946],[9,696091.5844209917]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"NumK","type":"\"long\"","metadata":"{}"},{"name":"WSSSE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758805723,"submitTime":1493758761841,"finishTime":1493758805914,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"678.181818","height":"294.181818","xColumns":["NumK"],"yColumns":["WSSSE"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7a026c18-5cad-434e-bebe-d45019e4e4d2"},{"version":"CommandV1","origId":2109564766429559,"guid":"7382b552-8ddf-4f7b-942b-0f3882dce856","subtype":"command","commandType":"auto","position":7.998443603515625,"command":"%md\nThe biggest drop occurs after the 2'nd cluster so this analysis suggests that 3 clusters would be the optimal solution for this dataset. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761881,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49a376ff-af06-484d-bc57-f8f1e9339718"},{"version":"CommandV1","origId":2109564766429560,"guid":"8e277362-60f4-4d74-8ed7-2d7096b7dd77","subtype":"command","commandType":"auto","position":7.998832702636719,"command":"%md\n### 6.2) With Normalized Columns in Features Dataframe","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761931,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"813e24a1-5a31-4479-aa15-dfd066763883"},{"version":"CommandV1","origId":2109564766429561,"guid":"ab9d9ab1-c0d4-4d33-a0e6-0ff2f7cf8489","subtype":"command","commandType":"auto","position":7.999027252197266,"command":"%md\nPreviously it was noted that features have large differences in actual values. For example RQD values are mostly in the range from 80 - 100, while FRACS_FREQ are largely between 2 - 6.These differences may cause discrepancies in the clustering process and should therefore be normalized. \n\nThe method used by Hudaverdi [1] to normalize data is the Z-score normalization technique. In this method, each value in the feature table is adjusted by subtracting the column mean and dividing by the column standard deviation.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758761986,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b109d52d-a7a1-4a34-a04f-563e8d004768"},{"version":"CommandV1","origId":2109564766429562,"guid":"e8bc38a0-92dc-4c5e-b285-b3566c404b80","subtype":"command","commandType":"auto","position":7.9992218017578125,"command":"#Create a function that will normalize each value in the dataframe. Normalization involves subtracting each value by the column mean and dividing by the column standard deviation. \ndef normalize(df):\n    features_normalized = df.copy()\n    for feature_name in df.columns:\n        col_mean = df[feature_name].mean()\n        col_std = df[feature_name].std()\n        features_normalized[feature_name] = (df[feature_name] - col_mean) / col_std\n    return features_normalized","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-88-8aa4e35c1df6&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    -- Normalize the features</span>\n<span class=\"ansigrey\">                   ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1493758805917,"submitTime":1493758762043,"finishTime":1493758805988,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08570eb8-179d-425a-b873-c0a7e40a1437"},{"version":"CommandV1","origId":2109564766429563,"guid":"0d7f0f12-e727-4d90-8726-a257d76e3a4a","subtype":"command","commandType":"auto","position":8.124610900878906,"command":"#Let's see the original features table prior to normalization\nfeatures.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">49</span><span class=\"ansired\">]: </span>\n    RQD  FRACS_FREQ  IS_50     Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  DH_DELAY  \\\n0  97.3         4.3    8.7  15.7  0.428324          0           0         0   \n1  97.3         4.3    8.7  15.7  0.428324          0           0         0   \n2  97.3         4.3    8.7  15.7  0.428324          0           0         0   \n3  99.0         2.7   12.5  17.7  0.433426          0           0         0   \n4  99.0         2.7   12.5  17.7  0.433426          1           0         0   \n\n   HS_DELAY  RS_DELAY  EXPLOSIVE  BLAST_PATTERN  TOTAL_EXPLOSIVE  HOLE_DEPTH  \\\n0        42       100          0              0              0.0        13.0   \n1        42       100          0              0              0.0        13.0   \n2        42       100          0              0              0.0        13.0   \n3        42       100          0              0              0.0        13.0   \n4        42       100          0              0              0.0        13.0   \n\n   POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  SB_ratio  HB_ratio  BD_ratio  \\\n0           0.22                0            0  1.166667       2.0  0.027778   \n1           0.22                0            0  1.166667       2.0  0.027778   \n2           0.22                0            0  1.166667       2.0  0.027778   \n3           0.22                1            1  1.166667       2.0  0.027778   \n4           0.22                1            1  1.166667       2.0  0.027778   \n\n   TB_ratio  UB_ratio  \n0      0.75       0.0  \n1      0.75       0.0  \n2      0.75       0.0  \n3      0.75       0.0  \n4      0.75       0.0  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758805991,"submitTime":1493758762089,"finishTime":1493758806031,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d68b04da-10be-4fd2-84b9-a91ddfbc74e6"},{"version":"CommandV1","origId":2109564766429564,"guid":"1a1dac36-e88f-48af-a641-7e289c18ff66","subtype":"command","commandType":"auto","position":8.25,"command":"#Pass the features to be normalized to the function\nnormalized_features = normalize(features)\n#See the new normalized values \nnormalized_features.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">50</span><span class=\"ansired\">]: </span>\n        RQD  FRACS_FREQ     IS_50         Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  \\\n0  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n1  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n2  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n3  0.574364   -0.449685  1.929197 -0.221311 -0.426181  -1.216056   -0.335113   \n4  0.574364   -0.449685  1.929197 -0.221311 -0.426181  -0.527063   -0.335113   \n\n   DH_DELAY  HS_DELAY  RS_DELAY  EXPLOSIVE  BLAST_PATTERN  TOTAL_EXPLOSIVE  \\\n0       NaN       NaN       NaN        NaN            NaN        -0.300988   \n1       NaN       NaN       NaN        NaN            NaN        -0.300988   \n2       NaN       NaN       NaN        NaN            NaN        -0.300988   \n3       NaN       NaN       NaN        NaN            NaN        -0.300988   \n4       NaN       NaN       NaN        NaN            NaN        -0.300988   \n\n   HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  SB_ratio  \\\n0    0.241385      -0.248137        -0.629794    -1.345289 -0.136722   \n1    0.241385      -0.248137        -0.629794    -1.345289 -0.136722   \n2    0.241385      -0.248137        -0.629794    -1.345289 -0.136722   \n3    0.241385      -0.248137         1.350862     0.739909 -0.136722   \n4    0.241385      -0.248137         1.350862     0.739909 -0.136722   \n\n   HB_ratio  BD_ratio  TB_ratio  UB_ratio  \n0 -0.136722  0.136722 -0.136722 -0.118127  \n1 -0.136722  0.136722 -0.136722 -0.118127  \n2 -0.136722  0.136722 -0.136722 -0.118127  \n3 -0.136722  0.136722 -0.136722 -0.118127  \n4 -0.136722  0.136722 -0.136722 -0.118127  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">KeyError</span>: &apos;q&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-91-c6c2e74a6b6e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>features<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;q&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">.</span>mean<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">__getitem__</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   1995</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_multilevel<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1996</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1997</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_column<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1998</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1999</span>     <span class=\"ansigreen\">def</span> _getitem_column<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_getitem_column</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   2002</span>         <span class=\"ansired\"># get column</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2003</span>         <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">.</span>is_unique<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2004</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_get_item_cache<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2005</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2006</span>         <span class=\"ansired\"># duplicate columns &amp; possible reduce dimensionality</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">_get_item_cache</span><span class=\"ansiblue\">(self, item)</span>\n<span class=\"ansigreen\">   1348</span>         res <span class=\"ansiyellow\">=</span> cache<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1349</span>         <span class=\"ansigreen\">if</span> res <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1350</span><span class=\"ansiyellow\">             </span>values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_data<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1351</span>             res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_box_item_values<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span> values<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1352</span>             cache<span class=\"ansiyellow\">[</span>item<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/internals.pyc</span> in <span class=\"ansicyan\">get</span><span class=\"ansiblue\">(self, item, fastpath)</span>\n<span class=\"ansigreen\">   3288</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3289</span>             <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> isnull<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 3290</span><span class=\"ansiyellow\">                 </span>loc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3291</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3292</span>                 indexer <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span>isnull<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/indexes/base.pyc</span> in <span class=\"ansicyan\">get_loc</span><span class=\"ansiblue\">(self, key, method, tolerance)</span>\n<span class=\"ansigreen\">   1945</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1946</span>             <span class=\"ansigreen\">except</span> KeyError<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1947</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_maybe_cast_indexer<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1948</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1949</span>         indexer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>get_indexer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>key<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> method<span class=\"ansiyellow\">=</span>method<span class=\"ansiyellow\">,</span> tolerance<span class=\"ansiyellow\">=</span>tolerance<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansired\">KeyError</span>: &apos;q&apos;</div>","workflows":[],"startTime":1493758806035,"submitTime":1493758762131,"finishTime":1493758806109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4ac0f472-03f4-4ff8-b746-ad64a313dc36"},{"version":"CommandV1","origId":2109564766429565,"guid":"a96ac5d0-6aef-430b-b316-2cea0dbcb5f8","subtype":"command","commandType":"auto","position":8.3125,"command":"%md\nAfter normalization, a few columns appear to produce a lot of NaN values. This occus because all the values in these colums are the same, therefore subtracting the mean results in 0. Let's see how many are NaNs.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758762172,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f61d63b4-e8e1-431d-bc27-35a418650127"},{"version":"CommandV1","origId":2109564766429566,"guid":"250ab019-f128-4451-a54d-dee11bed3788","subtype":"command","commandType":"auto","position":8.375,"command":"#View the null values in the normalized_features dataframe\nnormalized_features.isnull().sum()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">51</span><span class=\"ansired\">]: </span>\nRQD                  0\nFRACS_FREQ           0\nIS_50                0\nQ                    0\nPEN_RATE             0\nROCK_TYPE            0\nBLAST_TYPE           0\nDH_DELAY           217\nHS_DELAY           217\nRS_DELAY           217\nEXPLOSIVE          217\nBLAST_PATTERN      217\nTOTAL_EXPLOSIVE      0\nHOLE_DEPTH           0\nPOWDER_FACTOR        0\nINITIATION_TYPE      0\nCONFINEMENT          0\nSB_ratio             0\nHB_ratio             0\nBD_ratio             0\nTB_ratio             0\nUB_ratio             0\ndtype: int64\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;features_normalized&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-107-49dfdbd99417&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>features_normalized<span class=\"ansiyellow\">.</span>isnull<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;features_normalized&apos; is not defined</div>","workflows":[],"startTime":1493758806113,"submitTime":1493758762219,"finishTime":1493758806136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e091dc41-d81e-41f1-a982-f2f0c88be0c6"},{"version":"CommandV1","origId":2109564766429567,"guid":"7d4747d9-5b03-4d06-a4a1-8872fa3f9e3d","subtype":"command","commandType":"auto","position":8.4375,"command":"#Remove NaN columns from normalized_feautres\nnormalized_features.drop(['DH_DELAY','HS_DELAY','RS_DELAY','EXPLOSIVE','BLAST_PATTERN'],1,inplace='true')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">ValueError</span>: labels [&apos;DS_DELAY&apos;] not contained in axis","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-115-b69b412a3db1&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Remove NaN columns from normalized_feautres</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>normalized_features<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;DS_DELAY&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;HS_DELAY&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;RS_DELAY&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;EXPLOSIVE&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;BLAST_PATTERN&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span>inplace<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;true&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">drop</span><span class=\"ansiblue\">(self, labels, axis, level, inplace, errors)</span>\n<span class=\"ansigreen\">   1875</span>                 new_axis <span class=\"ansiyellow\">=</span> axis<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span>labels<span class=\"ansiyellow\">,</span> level<span class=\"ansiyellow\">=</span>level<span class=\"ansiyellow\">,</span> errors<span class=\"ansiyellow\">=</span>errors<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1876</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1877</span><span class=\"ansiyellow\">                 </span>new_axis <span class=\"ansiyellow\">=</span> axis<span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span>labels<span class=\"ansiyellow\">,</span> errors<span class=\"ansiyellow\">=</span>errors<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1878</span>             dropped <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>reindex<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span><span class=\"ansiyellow\">{</span>axis_name<span class=\"ansiyellow\">:</span> new_axis<span class=\"ansiyellow\">}</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1879</span>             <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/indexes/base.pyc</span> in <span class=\"ansicyan\">drop</span><span class=\"ansiblue\">(self, labels, errors)</span>\n<span class=\"ansigreen\">   3049</span>             <span class=\"ansigreen\">if</span> errors <span class=\"ansiyellow\">!=</span> <span class=\"ansiblue\">&apos;ignore&apos;</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3050</span>                 raise ValueError(&apos;labels %s not contained in axis&apos; %\n<span class=\"ansigreen\">-&gt; 3051</span><span class=\"ansiyellow\">                                  labels[mask])\n</span><span class=\"ansigreen\">   3052</span>             indexer <span class=\"ansiyellow\">=</span> indexer<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">~</span>mask<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3053</span>         <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>delete<span class=\"ansiyellow\">(</span>indexer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ValueError</span>: labels [&apos;DS_DELAY&apos;] not contained in axis</div>","workflows":[],"startTime":1493758806139,"submitTime":1493758762259,"finishTime":1493758806177,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f951f83-13d2-4dd4-aa67-2030bd44e423"},{"version":"CommandV1","origId":2109564766429568,"guid":"5e228323-fc36-4199-8b85-e145b38b2f6b","subtype":"command","commandType":"auto","position":8.46875,"command":"#Create a list of the column headers \nnormalized_feautresList = list(normalized_features)\n#Let's view the dataframe\nnormalized_features.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">53</span><span class=\"ansired\">]: </span>\n        RQD  FRACS_FREQ     IS_50         Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  \\\n0  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n1  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n2  0.083326    0.576140 -0.485887 -0.549011 -0.433645  -1.216056   -0.335113   \n3  0.574364   -0.449685  1.929197 -0.221311 -0.426181  -1.216056   -0.335113   \n4  0.574364   -0.449685  1.929197 -0.221311 -0.426181  -0.527063   -0.335113   \n\n   TOTAL_EXPLOSIVE  HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  \\\n0        -0.300988    0.241385      -0.248137        -0.629794    -1.345289   \n1        -0.300988    0.241385      -0.248137        -0.629794    -1.345289   \n2        -0.300988    0.241385      -0.248137        -0.629794    -1.345289   \n3        -0.300988    0.241385      -0.248137         1.350862     0.739909   \n4        -0.300988    0.241385      -0.248137         1.350862     0.739909   \n\n   SB_ratio  HB_ratio  BD_ratio  TB_ratio  UB_ratio  \n0 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n1 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n2 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n3 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n4 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758806180,"submitTime":1493758762300,"finishTime":1493758806251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb2915c2-4f3a-49ac-844f-ee4896a287ee"},{"version":"CommandV1","origId":2109564766429569,"guid":"9b2d5de3-2786-4e26-8df5-ac1d2bf05f34","subtype":"command","commandType":"auto","position":8.484375,"command":"#Parse the features pandas dataframe into an RDD of features which will be input into the model\nnormalized_featuresRDD = sqlContext.createDataFrame(normalized_features).rdd.map(lambda row: np.array([float(item) for item in row]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758806255,"submitTime":1493758762344,"finishTime":1493758806375,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5423b369-ba31-40b3-be9a-e6c2d79d5e20"},{"version":"CommandV1","origId":2109564766429570,"guid":"c2d0db76-afcd-41ab-ad10-f473591c7c08","subtype":"command","commandType":"auto","position":8.4921875,"command":"#Run the clustering function \nnum_k_iter(10,normalized_featuresRDD)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758806379,"submitTime":1493758762385,"finishTime":1493758811527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fdaf6eb7-df5e-4e76-a2c1-aa9582845eb5"},{"version":"CommandV1","origId":2109564766429571,"guid":"f5dc26d6-bb2b-46c1-b1b3-33c7b1520818","subtype":"command","commandType":"auto","position":8.49609375,"command":"#Pass the error graph to a new variable\nnormalizedElbow = errorGraph","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758811532,"submitTime":1493758762425,"finishTime":1493758811554,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8bf5374-c262-4131-abf9-b2de2b6346b0"},{"version":"CommandV1","origId":2109564766429572,"guid":"ede37672-f8ef-4ab8-b317-d4d532b76f0b","subtype":"command","commandType":"auto","position":8.498046875,"command":"#Create a spark dataframe so we can viusalize the Cluster Elbow graph\nNormCluster_df = sqlContext.createDataFrame(normalizedElbow)\nNormCluster_df.createOrReplaceTempView('norm_elbows')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758811558,"submitTime":1493758762467,"finishTime":1493758811599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6bceae00-61de-4abc-908f-3caeaccf298c"},{"version":"CommandV1","origId":2109564766429573,"guid":"c0b46384-74eb-4471-8af3-14493ad70919","subtype":"command","commandType":"auto","position":8.4990234375,"command":"%sql -- Plot normalized WSSE Error vs. Num K\nSELECT _1 as NumK, _2 as WSSSE\nFROM norm_elbows","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,6220013.043219018],[2,1159149.1128610726],[3,696626.8307051482],[4,696626.8307051482],[5,696465.7881098283],[6,696465.7881098283],[7,696185.792347747],[8,696231.0668227946],[9,696091.5844209917],[1,713.0445142714015],[2,670.7509833972213],[3,625.6884507915995],[4,559.8386207618861],[5,511.8836214726993],[6,506.6921838716602],[7,449.4234693762042],[8,480.14426142537695],[9,426.1881057745159]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"NumK","type":"\"long\"","metadata":"{}"},{"name":"WSSSE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758811602,"submitTime":1493758762506,"finishTime":1493758811782,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["NumK"],"yColumns":["WSSSE"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"68213d7b-5979-4567-ab3f-ab34ea277b9a"},{"version":"CommandV1","origId":2109564766429574,"guid":"6654eb9a-5047-41e8-8c05-cb007660b0d8","subtype":"command","commandType":"auto","position":8.49951171875,"command":"%md\nBased on this graph, the node after largest drop is 3, therefore it's recommended that 3 clusters be used for this dataset. Let's conduct some more exploration with 3 clusters and see how the data look. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758762547,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b5c5721f-0b1a-45b0-9838-5e9021d931c2"},{"version":"CommandV1","origId":2109564766429575,"guid":"db36347a-19cc-49cc-a52c-c19aa387484c","subtype":"command","commandType":"auto","position":8.499755859375,"command":"#Re run the model training with 3 clusters specified\nnormClusters = KMeans.train(normalized_featuresRDD, 3, maxIterations=100, initializationMode=\"random\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758811786,"submitTime":1493758762594,"finishTime":1493758812460,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2519e54-24d1-477d-9690-f26a8d45913e"},{"version":"CommandV1","origId":2109564766429576,"guid":"7231bd2b-214e-4a30-a844-e8e81c1560da","subtype":"command","commandType":"auto","position":8.4998779296875,"command":"#Create an array of cluster centers\nnormCentres = normClusters.clusterCenters\n#Pass the array to a pandas dataframe\nnormCentresDf = pd.DataFrame(normCentres)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758812464,"submitTime":1493758762632,"finishTime":1493758812486,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bfd5c1bb-8e01-4328-ad6f-df6bc19f92be"},{"version":"CommandV1","origId":2109564766429577,"guid":"fbf2ac2c-94f9-419e-8be2-dba78e1ea88c","subtype":"command","commandType":"auto","position":8.499908447265625,"command":"#Add column headers to allow for visual assessment of features\nnormCentresDf.columns = normalized_feautresList\n#Let's view the centre coordinates of each normalized table\nnormCentresDf","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">60</span><span class=\"ansired\">]: </span>\n        RQD  FRACS_FREQ     IS_50         Q  PEN_RATE  ROCK_TYPE  BLAST_TYPE  \\\n0  0.465275   -0.390550  0.047850  0.378094 -0.080442  -0.292940   -0.335113   \n1 -0.463905    0.405363 -0.034070 -0.377564  0.078648   0.268410    0.325973   \n2  0.776555   -1.090825 -0.295223  0.647094 -0.091419   0.161929   -0.335113   \n\n   TOTAL_EXPLOSIVE  HOLE_DEPTH  POWDER_FACTOR  INITIATION_TYPE  CONFINEMENT  \\\n0        -0.052705    0.241385      -0.248137        -0.610564    -0.677216   \n1         0.060296   -0.234802       0.102362         0.450564     0.683040   \n2        -0.300988    0.241385       3.574580         3.331519    -1.345289   \n\n   SB_ratio  HB_ratio  BD_ratio  TB_ratio  UB_ratio  \n0 -0.136722 -0.136722  0.136722 -0.136722 -0.118127  \n1 -0.136722 -0.136722  0.136722 -0.136722  0.114906  \n2  7.280426  7.280426 -7.280426  7.280426 -0.118127  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758812489,"submitTime":1493758762671,"finishTime":1493758812537,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d87dc6b1-122c-43ac-be2d-9e47596ffe8a"},{"version":"CommandV1","origId":2109564766429578,"guid":"8581f481-fff4-43f1-b246-eab748cec0fe","subtype":"command","commandType":"auto","position":8.499923706054688,"command":"%md\nThe centre coordinates indicate the location of each cluster. Although we don't know the tightness of the cluster, we can use the centre coordinates to visualize the splits among the features.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758762709,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6e07c82-96ee-4400-9622-31a763cbd105"},{"version":"CommandV1","origId":2109564766429579,"guid":"18c2b2f6-7895-40be-98b1-b15d978481b3","subtype":"command","commandType":"auto","position":8.49993896484375,"command":"#Create a spark dataframe so we can viusalize the Cluster Elbow graph\nNormClusterCentre_df = sqlContext.createDataFrame(normCentresDf)\nNormClusterCentre_df.createOrReplaceTempView('norm_cluster_cent')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: Can not infer schema for type: &lt;type &apos;numpy.ndarray&apos;&gt;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-142-eae00c54e331&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Create a dataframe so we can viusalize the Cluster Elbow graph</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>NormClusterCentre_df <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>normCentres<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> NormClusterCentre_df<span class=\"ansiyellow\">.</span>createOrReplaceTempView<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;norm_cluster_cent&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/context.pyc</span> in <span class=\"ansicyan\">createDataFrame</span><span class=\"ansiblue\">(self, data, schema, samplingRatio, verifySchema)</span>\n<span class=\"ansigreen\">    331</span>         Py4JJavaError<span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">.</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    332</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 333</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>sparkSession<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">,</span> verifySchema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    334</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    335</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">createDataFrame</span><span class=\"ansiblue\">(self, data, schema, samplingRatio, verifySchema)</span>\n<span class=\"ansigreen\">    524</span>             rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromRDD<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    525</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 526</span><span class=\"ansiyellow\">             </span>rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromLocal<span class=\"ansiyellow\">(</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    527</span>         jrdd <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>SerDeUtil<span class=\"ansiyellow\">.</span>toJavaArray<span class=\"ansiyellow\">(</span>rdd<span class=\"ansiyellow\">.</span>_to_java_object_rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    528</span>         jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jsparkSession<span class=\"ansiyellow\">.</span>applySchemaToPythonRDD<span class=\"ansiyellow\">(</span>jrdd<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">.</span>json<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_createFromLocal</span><span class=\"ansiblue\">(self, data, schema)</span>\n<span class=\"ansigreen\">    388</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    389</span>         <span class=\"ansigreen\">if</span> schema <span class=\"ansigreen\">is</span> None <span class=\"ansigreen\">or</span> isinstance<span class=\"ansiyellow\">(</span>schema<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span>list<span class=\"ansiyellow\">,</span> tuple<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 390</span><span class=\"ansiyellow\">             </span>struct <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_inferSchemaFromList<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    391</span>             converter <span class=\"ansiyellow\">=</span> _create_converter<span class=\"ansiyellow\">(</span>struct<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    392</span>             data <span class=\"ansiyellow\">=</span> map<span class=\"ansiyellow\">(</span>converter<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_inferSchemaFromList</span><span class=\"ansiblue\">(self, data)</span>\n<span class=\"ansigreen\">    320</span>             warnings.warn(&quot;inferring schema from dict is deprecated,&quot;\n<span class=\"ansigreen\">    321</span>                           &quot;please use pyspark.sql.Row instead&quot;)\n<span class=\"ansigreen\">--&gt; 322</span><span class=\"ansiyellow\">         </span>schema <span class=\"ansiyellow\">=</span> reduce<span class=\"ansiyellow\">(</span>_merge_type<span class=\"ansiyellow\">,</span> map<span class=\"ansiyellow\">(</span>_infer_schema<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    323</span>         <span class=\"ansigreen\">if</span> _has_nulltype<span class=\"ansiyellow\">(</span>schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    324</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Some of types cannot be determined after inferring&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/types.pyc</span> in <span class=\"ansicyan\">_infer_schema</span><span class=\"ansiblue\">(row)</span>\n<span class=\"ansigreen\">    990</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    991</span>     <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 992</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">raise</span> TypeError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Can not infer schema for type: %s&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>row<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    993</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    994</span>     fields <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>StructField<span class=\"ansiyellow\">(</span>k<span class=\"ansiyellow\">,</span> _infer_type<span class=\"ansiyellow\">(</span>v<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> k<span class=\"ansiyellow\">,</span> v <span class=\"ansigreen\">in</span> items<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: Can not infer schema for type: &lt;type &apos;numpy.ndarray&apos;&gt;</div>","workflows":[],"startTime":1493758812540,"submitTime":1493758762758,"finishTime":1493758812614,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06d744de-8598-4f62-aa7c-76dffaab7cee"},{"version":"CommandV1","origId":2109564766429580,"guid":"e0b1c9f1-d497-440a-9a52-ec7d79b7e3ee","subtype":"command","commandType":"auto","position":8.499954223632812,"command":"%sql -- Let's see all the columns in our centre cluster dataframe\nSELECT *\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.4652752238651841,-0.3905502864538449,0.04785025680917839,0.378093958191758,-0.08044234791313111,-0.29293977940147264,-0.3351128207383048,-0.05270460442801928,0.2413852346690691,-0.24813687449005334,-0.610564288188088,-0.6772159838820273,-0.13672162218579936,-0.1367216221858483,0.13672162218582726,-0.13672162218584277,-0.11812742832805152],[-0.46390518060877006,0.405363446345786,-0.03406987503047719,-0.37756413683493983,0.07864761045610034,0.2684098245447776,0.3259733801727148,0.06029569518983575,-0.2348020009962761,0.10236160832042733,0.45056405956025286,0.6830400294697216,-0.1367216221857994,-0.1367216221858483,0.13672162218582726,-0.1367216221858428,0.11490577119183187],[0.7765554522126846,-1.0908248983226143,-0.29522254949822624,0.6470943395230885,-0.09141882877961821,0.16192914460653848,-0.33511282073830495,-0.30098805369898457,0.2413852346690691,3.5745802893069722,3.3315187829363087,-1.3452892254551363,7.280426381396323,7.280426381396274,-7.280426381396294,7.280426381396278,-0.1181274283280515]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"RQD","type":"\"double\"","metadata":"{}"},{"name":"FRACS_FREQ","type":"\"double\"","metadata":"{}"},{"name":"IS_50","type":"\"double\"","metadata":"{}"},{"name":"Q","type":"\"double\"","metadata":"{}"},{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"},{"name":"ROCK_TYPE","type":"\"double\"","metadata":"{}"},{"name":"BLAST_TYPE","type":"\"double\"","metadata":"{}"},{"name":"TOTAL_EXPLOSIVE","type":"\"double\"","metadata":"{}"},{"name":"HOLE_DEPTH","type":"\"double\"","metadata":"{}"},{"name":"POWDER_FACTOR","type":"\"double\"","metadata":"{}"},{"name":"INITIATION_TYPE","type":"\"double\"","metadata":"{}"},{"name":"CONFINEMENT","type":"\"double\"","metadata":"{}"},{"name":"SB_ratio","type":"\"double\"","metadata":"{}"},{"name":"HB_ratio","type":"\"double\"","metadata":"{}"},{"name":"BD_ratio","type":"\"double\"","metadata":"{}"},{"name":"TB_ratio","type":"\"double\"","metadata":"{}"},{"name":"UB_ratio","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758812618,"submitTime":1493758762800,"finishTime":1493758812824,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3333f268-0ada-4bef-8b46-7172c33ea945"},{"version":"CommandV1","origId":2109564766429581,"guid":"268f213f-1982-4ad5-90c8-e8b360d7f421","subtype":"command","commandType":"auto","position":8.499969482421875,"command":"%sql -- Differences in RQD values among the normalized clusters shows three relatively distinct groupings of clusters \nSELECT RQD\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.4652752238651841],[-0.46390518060877006],[0.7765554522126846]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"RQD","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: grouping expressions sequence is empty, and 'norm_cluster_cent.`RQD`' is not an aggregate function. Wrap '(count(norm_cluster_cent.`RQD`) AS `count(RQD)`)' in windowing function(s) or wrap 'norm_cluster_cent.`RQD`' in first() (or first_value) if you don't care which value you get.;;\nAggregate [RQD#15668, count(RQD#15668) AS count(RQD)#15884L]\n+- SubqueryAlias norm_cluster_cent\n   +- LogicalRDD [RQD#15668, FRACS_FREQ#15669, IS_50#15670, Q#15671, PEN_RATE#15672, ROCK_TYPE#15673, BLAST_TYPE#15674, TOTAL_EXPLOSIVE#15675, HOLE_DEPTH#15676, POWDER_FACTOR#15677, INITIATION_TYPE#15678, CONFINEMENT#15679, SB_ratio#15680, HB_ratio#15681, BD_ratio#15682, TB_ratio#15683, UB_ratio#15684]\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: grouping expressions sequence is empty, and 'norm_cluster_cent.`RQD`' is not an aggregate function. Wrap '(count(norm_cluster_cent.`RQD`) AS `count(RQD)`)' in windowing function(s) or wrap 'norm_cluster_cent.`RQD`' in first() (or first_value) if you don't care which value you get.;;\nAggregate [RQD#15668, count(RQD#15668) AS count(RQD)#15884L]\n+- SubqueryAlias norm_cluster_cent\n   +- LogicalRDD [RQD#15668, FRACS_FREQ#15669, IS_50#15670, Q#15671, PEN_RATE#15672, ROCK_TYPE#15673, BLAST_TYPE#15674, TOTAL_EXPLOSIVE#15675, HOLE_DEPTH#15676, POWDER_FACTOR#15677, INITIATION_TYPE#15678, CONFINEMENT#15679, SB_ratio#15680, HB_ratio#15681, BD_ratio#15682, TB_ratio#15683, UB_ratio#15684]\n\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:39)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.org$apache$spark$sql$catalyst$analysis$CheckAnalysis$class$$anonfun$$checkValidAggregateExpression$1(CheckAnalysis.scala:251)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$12.apply(CheckAnalysis.scala:292)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$12.apply(CheckAnalysis.scala:292)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:292)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:76)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:128)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:76)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:699)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:381)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:285)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:212)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:201)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:35)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:35)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:201)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1493758812828,"submitTime":1493758762852,"finishTime":1493758813011,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"263.181818","xColumns":["<id>"],"yColumns":["RQD"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.25"}],"histogram":[{"key":"bins","value":"20"}],"boxPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08c03cbf-29cb-48f0-b328-8201b5a22410"},{"version":"CommandV1","origId":2109564766429582,"guid":"b1215424-4a63-4107-a396-d5dd8de27971","subtype":"command","commandType":"auto","position":8.499984741210938,"command":"%sql -- Differences in FRACS_FREQ values among the normalized clusters shows three distinct clusters.\nSELECT FRACS_FREQ\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.3905502864538449],[0.405363446345786],[-1.0908248983226143]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"FRACS_FREQ","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759059156,"submitTime":1493759059148,"finishTime":1493759059358,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"311dd216-b6df-499a-910a-89665bfe1c66"},{"version":"CommandV1","origId":2109564766429583,"guid":"a81b272d-44b2-4da2-b3b3-95f0de72688b","subtype":"command","commandType":"auto","position":8.499992370605469,"command":"%sql -- Differences in IS_50 values among the normalized clusters shows that clusters 0 and 1 are more similar to each other than to 2\nSELECT IS_50\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.04785025680917839],[-0.03406987503047719],[-0.29522254949822624]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"IS_50","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758813208,"submitTime":1493758762932,"finishTime":1493758813394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aff1a2df-6a7b-4e2e-bfbf-65a0260a2b27"},{"version":"CommandV1","origId":2109564766429584,"guid":"a23afa9e-1a33-47c3-be22-80fea9b265d1","subtype":"command","commandType":"auto","position":8.499996185302734,"command":"%sql -- Differences in Q values among the normalized clusters shows that 0,2 are more similar to each other than to 1. \nSELECT Q\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.378093958191758],[-0.37756413683493983],[0.6470943395230885]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Q","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759088585,"submitTime":1493759088578,"finishTime":1493759088758,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d7b18e62-490a-4eab-b457-78dac998abff"},{"version":"CommandV1","origId":2109564766429585,"guid":"633ae634-f0bd-4bac-b1ad-736c2ab8e192","subtype":"command","commandType":"auto","position":8.499998092651367,"command":"%sql -- Differences in PEN_RATE values among the normalized clusters shows that clusters 0 and 2 are more similar to each other than to 0\nSELECT PEN_RATE\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.08044234791313111],[0.07864761045610034],[-0.09141882877961821]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"PEN_RATE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759098688,"submitTime":1493759098680,"finishTime":1493759098857,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b74a9c41-7344-4864-9277-36c4da9dd44c"},{"version":"CommandV1","origId":2109564766429586,"guid":"9ffa1111-be2a-4a72-9470-f85f720101ba","subtype":"command","commandType":"auto","position":8.499999046325684,"command":"%sql -- Differences in RQD values among the normalized clusters shows that clusters 1 and 2 are more similar to each other than to 0\nSELECT ROCK_TYPE\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.29293977940147264],[0.2684098245447776],[0.16192914460653848]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"ROCK_TYPE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758813752,"submitTime":1493758763041,"finishTime":1493758813938,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9f6cda59-2820-452f-bd77-8551792e9a9a"},{"version":"CommandV1","origId":2109564766429587,"guid":"e261c981-ff64-43e5-acd4-b6bbec1862f4","subtype":"command","commandType":"auto","position":8.499999523162842,"command":"%sql -- Differences in confinement values among the normalized clusters shows that clusters 0 and 2 are more similar to each other than to 2\nSELECT CONFINEMENT\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.6772159838820273],[0.6830400294697216],[-1.3452892254551363]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"CONFINEMENT","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759119781,"submitTime":1493759119774,"finishTime":1493759119959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e58aae6b-b668-43c4-b3b2-dbc1f441907c"},{"version":"CommandV1","origId":2109564766429588,"guid":"06266b66-a523-4d70-9f30-e484d838e2ec","subtype":"command","commandType":"auto","position":8.499999761581421,"command":"%sql -- Differences in ROCK_TYPE values among the normalized clusters shows that clusters 1 and 2 are more similar to each other than to 0\nSELECT ROCK_TYPE\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.29293977940147264],[0.2684098245447776],[0.16192914460653848]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"ROCK_TYPE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758814123,"submitTime":1493758763112,"finishTime":1493758814295,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"21af5446-9859-4699-bed1-96692bb19c5f"},{"version":"CommandV1","origId":2109564766429589,"guid":"fd7cde1c-c492-4ee3-be11-693df37d6032","subtype":"command","commandType":"auto","position":8.49999988079071,"command":"%sql -- Differences in SB_Ratio values among the normalized clusters shows that only 1 cluster was formed.\nSELECT SB_RATIO\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.13672162218579936],[-0.1367216221857994],[7.280426381396323]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"SB_RATIO","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759171385,"submitTime":1493759171378,"finishTime":1493759171559,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8b26637-8247-418b-be3f-df34881aec9b"},{"version":"CommandV1","origId":2109564766429590,"guid":"299c9d62-4bf3-4d97-928e-828fead077e5","subtype":"command","commandType":"auto","position":8.499999940395355,"command":"%sql -- Differences in HB_RATIO values among the normalized clusters shows that only 1 cluster was formed.\nSELECT HB_RATIO\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.1367216221858483],[-0.1367216221858483],[7.280426381396274]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"HB_RATIO","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759166318,"submitTime":1493759166311,"finishTime":1493759166489,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44eb403d-0c77-450c-8d42-8c78390e3324"},{"version":"CommandV1","origId":2109564766429591,"guid":"3a5782b7-6c90-45dc-8a41-bc81b978a71b","subtype":"command","commandType":"auto","position":8.499999970197678,"command":"%sql -- Differences in TB_RATIO values among the normalized clusters shows that only 1 cluster was formed. \nSELECT TB_RATIO\nFROM norm_cluster_cent","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.13672162218584277],[-0.1367216221858428],[7.280426381396278]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"TB_RATIO","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493759182299,"submitTime":1493759182291,"finishTime":1493759182471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebd92384-2eca-48ba-8383-38b29da690a8"},{"version":"CommandV1","origId":2109564766429592,"guid":"4f30a2bf-9323-409a-bcc6-a810258ca38c","subtype":"command","commandType":"auto","position":8.499999985098839,"command":"%md\n### 6.3) With Just the Geotechnical Parameters","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758763267,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa07e219-b069-4678-ab88-639292532dd0"},{"version":"CommandV1","origId":2109564766429593,"guid":"933f8f87-b26b-454f-8006-ed1d3a66a107","subtype":"command","commandType":"auto","position":8.49999999254942,"command":"%md\nBased on the results of the previous clustering, it appears that many of the blast parameters are not as useful for assigning discriminant clusters. As such, we should try assign clusters with just the geotechnical parameters to see if there are interesting groupings within the data.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758763308,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a2e0a4a-ccca-421f-8798-a86bb7b4fa95"},{"version":"CommandV1","origId":2109564766429594,"guid":"66187a55-211a-4798-a2ee-c2f0932ea187","subtype":"command","commandType":"auto","position":8.49999999627471,"command":"#Create a geotech data features list\nnormalizedGeotech = normalized_features[['RQD','FRACS_FREQ','Q','PEN_RATE','ROCK_TYPE']]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">KeyError</span>: (&apos;RQD&apos;, &apos;FRACS_FREQ&apos;)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-60-a3dcf4e3defb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>normalizedGeotech <span class=\"ansiyellow\">=</span> normalized_features<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;RQD&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;FRACS_FREQ&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">__getitem__</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   1995</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_multilevel<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1996</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1997</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_getitem_column<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1998</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1999</span>     <span class=\"ansigreen\">def</span> _getitem_column<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/frame.pyc</span> in <span class=\"ansicyan\">_getitem_column</span><span class=\"ansiblue\">(self, key)</span>\n<span class=\"ansigreen\">   2002</span>         <span class=\"ansired\"># get column</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2003</span>         <span class=\"ansigreen\">if</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">.</span>is_unique<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2004</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_get_item_cache<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2005</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2006</span>         <span class=\"ansired\"># duplicate columns &amp; possible reduce dimensionality</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/generic.pyc</span> in <span class=\"ansicyan\">_get_item_cache</span><span class=\"ansiblue\">(self, item)</span>\n<span class=\"ansigreen\">   1348</span>         res <span class=\"ansiyellow\">=</span> cache<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1349</span>         <span class=\"ansigreen\">if</span> res <span class=\"ansigreen\">is</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1350</span><span class=\"ansiyellow\">             </span>values <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_data<span class=\"ansiyellow\">.</span>get<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1351</span>             res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_box_item_values<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">,</span> values<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1352</span>             cache<span class=\"ansiyellow\">[</span>item<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/core/internals.pyc</span> in <span class=\"ansicyan\">get</span><span class=\"ansiblue\">(self, item, fastpath)</span>\n<span class=\"ansigreen\">   3288</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3289</span>             <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> isnull<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 3290</span><span class=\"ansiyellow\">                 </span>loc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>item<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3291</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   3292</span>                 indexer <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>arange<span class=\"ansiyellow\">(</span>len<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span>isnull<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>items<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/indexes/base.pyc</span> in <span class=\"ansicyan\">get_loc</span><span class=\"ansiblue\">(self, key, method, tolerance)</span>\n<span class=\"ansigreen\">   1945</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1946</span>             <span class=\"ansigreen\">except</span> KeyError<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1947</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_engine<span class=\"ansiyellow\">.</span>get_loc<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_maybe_cast_indexer<span class=\"ansiyellow\">(</span>key<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1948</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1949</span>         indexer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>get_indexer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>key<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> method<span class=\"ansiyellow\">=</span>method<span class=\"ansiyellow\">,</span> tolerance<span class=\"ansiyellow\">=</span>tolerance<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4154)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/index.so</span> in <span class=\"ansicyan\">pandas.index.IndexEngine.get_loc (pandas/index.c:4018)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12368)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/pandas/hashtable.so</span> in <span class=\"ansicyan\">pandas.hashtable.PyObjectHashTable.get_item (pandas/hashtable.c:12322)</span><span class=\"ansiblue\">()</span>\n\n<span class=\"ansired\">KeyError</span>: (&apos;RQD&apos;, &apos;FRACS_FREQ&apos;)</div>","workflows":[],"startTime":1493758814853,"submitTime":1493758763349,"finishTime":1493758814924,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a81719d5-fcbb-4d0c-a5bb-178ac1eed7e8"},{"version":"CommandV1","origId":2109564766429595,"guid":"7290e10c-a281-461e-afbc-45f007152d6a","subtype":"command","commandType":"auto","position":8.499999998137355,"command":"#Let's view the new table\nnormalizedGeotech.head()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">63</span><span class=\"ansired\">]: </span>\n        RQD  FRACS_FREQ         Q  PEN_RATE  ROCK_TYPE\n0  0.083326    0.576140 -0.549011 -0.433645  -1.216056\n1  0.083326    0.576140 -0.549011 -0.433645  -1.216056\n2  0.083326    0.576140 -0.549011 -0.433645  -1.216056\n3  0.574364   -0.449685 -0.221311 -0.426181  -1.216056\n4  0.574364   -0.449685 -0.221311 -0.426181  -0.527063\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758814927,"submitTime":1493758763385,"finishTime":1493758814966,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5017e88-be23-4db9-9f5a-20352af9e119"},{"version":"CommandV1","origId":2109564766429596,"guid":"6d65a445-6347-4e88-a5d7-f4c6891b31da","subtype":"command","commandType":"auto","position":8.499999998603016,"command":"#Ensure it has the correct shape\nnormalizedGeotech.shape","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">64</span><span class=\"ansired\">]: </span>(217, 5)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;tuple&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-66-e87e57f6db8f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#Ensure it has the correct shape</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>normalizedGeotech<span class=\"ansiyellow\">.</span>shape<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;tuple&apos; object is not callable</div>","workflows":[],"startTime":1493758814970,"submitTime":1493758763420,"finishTime":1493758815008,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"065ad031-d77e-4286-8f25-87d7a0d1d215"},{"version":"CommandV1","origId":2109564766429597,"guid":"6d028b91-708e-42da-9cdf-926ff8e3cb4c","subtype":"command","commandType":"auto","position":8.499999999068677,"command":"#Create the RDD\nnormalized_geofeaturesRDD = sqlContext.createDataFrame(normalizedGeotech).rdd.map(lambda row: np.array([float(item) for item in row]))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758815011,"submitTime":1493758763456,"finishTime":1493758815081,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10193638-15c8-4178-bbef-37c63c9bb636"},{"version":"CommandV1","origId":2109564766429598,"guid":"0b967e3c-f5c2-453e-9fd3-2e48703d4c6b","subtype":"command","commandType":"auto","position":8.499999999534339,"command":"#Pass it to the clustering function\nnum_k_iter(10,normalized_geofeaturesRDD)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758815085,"submitTime":1493758763491,"finishTime":1493758820931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"17ed06af-9125-4ca3-b33c-a3a31156b71d"},{"version":"CommandV1","origId":2109564766429599,"guid":"da9ee393-0970-4897-93e2-83d32b498069","subtype":"command","commandType":"auto","position":8.49999999976717,"command":"#Create an elbow graph with the WSSSE error points\nnormalized_geoElbow = errorGraph","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758820935,"submitTime":1493758763531,"finishTime":1493758820973,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"debee5cf-18dc-429d-b80e-4174611ba0cd"},{"version":"CommandV1","origId":2109564766429600,"guid":"5f7f7499-a182-4044-a541-999a1f5e1a83","subtype":"command","commandType":"auto","position":8.499999999883585,"command":"#Create a spark dataframe so error points can be visualized\nNormgeoCluster_df = sqlContext.createDataFrame(normalized_geoElbow)\nNormgeoCluster_df.createOrReplaceTempView('norm_geo_elbows')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758820977,"submitTime":1493758763566,"finishTime":1493758821014,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1eb0f7f-c498-4327-a52f-309608973aae"},{"version":"CommandV1","origId":2109564766429601,"guid":"2f4d2a40-713a-4cad-a47d-6616444be2f8","subtype":"command","commandType":"auto","position":8.499999999941792,"command":"%sql -- Let's view the WSSE vs. Num K\nSELECT _1 as NumK, _2 as WSSSE\nFROM norm_geo_elbows","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,6220013.043219018],[2,1159149.1128610726],[3,696626.8307051482],[4,696626.8307051482],[5,696465.7881098283],[6,696465.7881098283],[7,696185.792347747],[8,696231.0668227946],[9,696091.5844209917],[1,713.0445142714015],[2,670.7509833972213],[3,625.6884507915995],[4,559.8386207618861],[5,511.8836214726993],[6,506.6921838716602],[7,449.4234693762042],[8,480.14426142537695],[9,426.1881057745159],[1,381.7590126754303],[2,332.3206861188832],[3,305.03347769116243],[4,269.9472168267888],[5,246.33392917261912],[6,235.3992187058555],[7,210.117480637636],[8,219.58591617885693],[9,187.02017112023447]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"NumK","type":"\"long\"","metadata":"{}"},{"name":"WSSSE","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1493758821018,"submitTime":1493758763603,"finishTime":1493758821186,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"660","height":"auto","xColumns":["NumK"],"yColumns":["WSSSE"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dbcae98-39ac-48f4-ad0e-a05da79133a9"},{"version":"CommandV1","origId":2109564766429602,"guid":"252d6ba8-5203-416e-88ad-bddc06a1142f","subtype":"command","commandType":"auto","position":8.499999999970896,"command":"%md\nSimilar to previous iterations, it appears the best K is 3 indicating that the data can be grouped into three distinct clusters based on the geotechnical features. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758763637,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc308870-dd6d-4b41-8ef5-dbce91990fc4"},{"version":"CommandV1","origId":2109564766429603,"guid":"a6a813fc-8461-428f-8dd3-954c68c60abd","subtype":"command","commandType":"auto","position":8.499999999985448,"command":"%md\n## 7.0) Conclusions & Recommendations\n\nBased on analysis conducted, the following observations are made :<br/>\n* The K-means algorithm is useful for grouping data based on underlying similarity \n* Based on running the K-means algorithm with sequentially increasing K, the optimal number of clusters was found to be 3. This was also found with just the geotechnical dataset - which indicates validation of the initial test. This suggests that there are 3 underlying groupings of the data.\n* Upon reviewing the centroids of the coordinates, it was typically noted that two of the clusters were closer to each other than the third, however this alternated depending on which parameter was assessed. \n* The blast parameters did not provide useful discriminant data to perform the clustering. This was shown by utilizing just the geotechnical data and obtaining 3 clusters - the same result as conducted with blast parameters. This suggests that most blasts have very similar data points, and is supported by the graphical plots depicted in Section 3.\n\n\nThe following recommendations are made regarding data management and future work:\n* The dataset used for the final clustering was relatively small - only 217 points. This was as a result of data processing and cleaning which resulted in the removal of many datapoints. In order to build better models, a larger more accurate dataset should be collected. \n* The dataset used for the analysi (smry_bmm) contained many data that had been averaged from one location across many different points. This is understandable considering the limitations of data collections at a mine, however additional efforts should be made to collect discrete geospatial data which are representative - for example the RQD, Q, IS_50 attached to individual blast hole data points. \n* This analysis provided distinct clusters into which the data can be grouped based on similarity. Further work can develop regression models to predict movement or fragmentation based on the clusters. These will likely result in better predictive models. \n* Documentation for ML Lib is still being developed (or difficult to find) as such, detailed analysis on clusters was not possible. For example it would have been useful to see cluster assignments and relate it back to individual data points. \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758763687,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c81c0e55-6e9e-4128-984f-14cc4bb90fab"},{"version":"CommandV1","origId":2109564766429604,"guid":"85d4b796-cf43-4206-a700-f8d91bbedbd8","subtype":"command","commandType":"auto","position":9.0,"command":"%md <a id=\"bibliography\"></a>\n## 7.0) Bibliography\n<strong>Selected Paper:</strong><br/>\n<a id=\"ref1\"></a>\n[1] T. Hudaverdi. Application of Multivariate Analysis for Prediction of Blast Induced Ground Vibrations. In Soil Dynamics and Earthquake Engineering. Pages 300  308, 2012.<br/><br/>\n<a id=\"ref2\"></a>\n\n<strong>Also cited in literature review:</strong><br/>\n[2] M. Rezaei, M. Monjezi, A. Varjani. Development of a fuzzy model to predict flyrock in surface mining. In Safety Science, pages 298-305, SS49, 2011<br/><br/>\n<a id=\"ref3\"></a>\n[3] R. Trivedi, T. Singh, N. Gupta. Prediction of Blast-Induced Flyrock in Opencast Mines Using ANN and ANFIS. <br/><br/>\n<a id=\"ref4\"></a>\n[4] CVB Cunningham. The Kuz-Ram fragmentation model  20 years on. In Brighton Conference Proceedings, pages 201  210, 2005 <br/><br/>\n<a id=\"ref5\"></a>\n[5] E. Hamdi, J. du Mouza. A methodology for rock mass characterization and classification to improve blast results. International Journal of Rock Mechanics and Mining Sciences. 42 Pages 177  194, 2005. <br/><br/>\n<a id=\"ref6\"></a>\n[6] W. Zhou and N. Maerz. Implementation of multivariate clustering methods for characterizing discontinuities data from scanlines and oriented boreholes. Computers and Geosciences. Vol 28 Pages 827  839, 2002.<br/><br/>\n<a id=\"ref7\"></a>\n[7] A Jain, M Murty, and P Flynn. Data Clustering : A Review. In ACM Digital Library. Vol 31, Iss 3. Pages 264  323, 1999.<br/><br/>\n<a id=\"ref8\"></a>\n[8] A Jain. Data Clustering : 50 Years Beyond K-Means. Published in 19th International conference in Pattern Recognition (ICPR) . Vol 31, Iss. 8, Pages 651  666, 2010.<br/><br/>","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1493758763930,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"55d368c8-8ed6-459c-8071-2218c5f4a4d4"}],"dashboards":[],"guid":"919712f6-b0f6-4448-bc61-c7fb170f22f8","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.5.1","nbconvert_exporter":"python","file_extension":".py"},"widgets":{"state":{},"version":"1.1.2"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
